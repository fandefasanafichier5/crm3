(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();function fk(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Yy={exports:{}},au={},Xy={exports:{}},se={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var To=Symbol.for("react.element"),mk=Symbol.for("react.portal"),pk=Symbol.for("react.fragment"),gk=Symbol.for("react.strict_mode"),yk=Symbol.for("react.profiler"),vk=Symbol.for("react.provider"),xk=Symbol.for("react.context"),_k=Symbol.for("react.forward_ref"),wk=Symbol.for("react.suspense"),kk=Symbol.for("react.memo"),Ek=Symbol.for("react.lazy"),ng=Symbol.iterator;function bk(t){return t===null||typeof t!="object"?null:(t=ng&&t[ng]||t["@@iterator"],typeof t=="function"?t:null)}var Jy={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Zy=Object.assign,ev={};function Li(t,e,r){this.props=t,this.context=e,this.refs=ev,this.updater=r||Jy}Li.prototype.isReactComponent={};Li.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Li.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function tv(){}tv.prototype=Li.prototype;function bf(t,e,r){this.props=t,this.context=e,this.refs=ev,this.updater=r||Jy}var Tf=bf.prototype=new tv;Tf.constructor=bf;Zy(Tf,Li.prototype);Tf.isPureReactComponent=!0;var sg=Array.isArray,rv=Object.prototype.hasOwnProperty,If={current:null},nv={key:!0,ref:!0,__self:!0,__source:!0};function sv(t,e,r){var n,s={},i=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)rv.call(e,n)&&!nv.hasOwnProperty(n)&&(s[n]=e[n]);var c=arguments.length-2;if(c===1)s.children=r;else if(1<c){for(var u=Array(c),d=0;d<c;d++)u[d]=arguments[d+2];s.children=u}if(t&&t.defaultProps)for(n in c=t.defaultProps,c)s[n]===void 0&&(s[n]=c[n]);return{$$typeof:To,type:t,key:i,ref:a,props:s,_owner:If.current}}function Tk(t,e){return{$$typeof:To,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Sf(t){return typeof t=="object"&&t!==null&&t.$$typeof===To}function Ik(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var ig=/\/+/g;function fd(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Ik(""+t.key):e.toString(36)}function ql(t,e,r,n,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case To:case mk:a=!0}}if(a)return a=t,s=s(a),t=n===""?"."+fd(a,0):n,sg(s)?(r="",t!=null&&(r=t.replace(ig,"$&/")+"/"),ql(s,e,r,"",function(d){return d})):s!=null&&(Sf(s)&&(s=Tk(s,r+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(ig,"$&/")+"/")+t)),e.push(s)),1;if(a=0,n=n===""?".":n+":",sg(t))for(var c=0;c<t.length;c++){i=t[c];var u=n+fd(i,c);a+=ql(i,e,r,u,s)}else if(u=bk(t),typeof u=="function")for(t=u.call(t),c=0;!(i=t.next()).done;)i=i.value,u=n+fd(i,c++),a+=ql(i,e,r,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function xl(t,e,r){if(t==null)return t;var n=[],s=0;return ql(t,n,"","",function(i){return e.call(r,i,s++)}),n}function Sk(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var xt={current:null},Hl={transition:null},Nk={ReactCurrentDispatcher:xt,ReactCurrentBatchConfig:Hl,ReactCurrentOwner:If};function iv(){throw Error("act(...) is not supported in production builds of React.")}se.Children={map:xl,forEach:function(t,e,r){xl(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return xl(t,function(){e++}),e},toArray:function(t){return xl(t,function(e){return e})||[]},only:function(t){if(!Sf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};se.Component=Li;se.Fragment=pk;se.Profiler=yk;se.PureComponent=bf;se.StrictMode=gk;se.Suspense=wk;se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Nk;se.act=iv;se.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=Zy({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=If.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(u in e)rv.call(e,u)&&!nv.hasOwnProperty(u)&&(n[u]=e[u]===void 0&&c!==void 0?c[u]:e[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){c=Array(u);for(var d=0;d<u;d++)c[d]=arguments[d+2];n.children=c}return{$$typeof:To,type:t.type,key:s,ref:i,props:n,_owner:a}};se.createContext=function(t){return t={$$typeof:xk,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:vk,_context:t},t.Consumer=t};se.createElement=sv;se.createFactory=function(t){var e=sv.bind(null,t);return e.type=t,e};se.createRef=function(){return{current:null}};se.forwardRef=function(t){return{$$typeof:_k,render:t}};se.isValidElement=Sf;se.lazy=function(t){return{$$typeof:Ek,_payload:{_status:-1,_result:t},_init:Sk}};se.memo=function(t,e){return{$$typeof:kk,type:t,compare:e===void 0?null:e}};se.startTransition=function(t){var e=Hl.transition;Hl.transition={};try{t()}finally{Hl.transition=e}};se.unstable_act=iv;se.useCallback=function(t,e){return xt.current.useCallback(t,e)};se.useContext=function(t){return xt.current.useContext(t)};se.useDebugValue=function(){};se.useDeferredValue=function(t){return xt.current.useDeferredValue(t)};se.useEffect=function(t,e){return xt.current.useEffect(t,e)};se.useId=function(){return xt.current.useId()};se.useImperativeHandle=function(t,e,r){return xt.current.useImperativeHandle(t,e,r)};se.useInsertionEffect=function(t,e){return xt.current.useInsertionEffect(t,e)};se.useLayoutEffect=function(t,e){return xt.current.useLayoutEffect(t,e)};se.useMemo=function(t,e){return xt.current.useMemo(t,e)};se.useReducer=function(t,e,r){return xt.current.useReducer(t,e,r)};se.useRef=function(t){return xt.current.useRef(t)};se.useState=function(t){return xt.current.useState(t)};se.useSyncExternalStore=function(t,e,r){return xt.current.useSyncExternalStore(t,e,r)};se.useTransition=function(){return xt.current.useTransition()};se.version="18.3.1";Xy.exports=se;var L=Xy.exports;const av=fk(L);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ak=L,Ck=Symbol.for("react.element"),Rk=Symbol.for("react.fragment"),Pk=Object.prototype.hasOwnProperty,jk=Ak.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Dk={key:!0,ref:!0,__self:!0,__source:!0};function ov(t,e,r){var n,s={},i=null,a=null;r!==void 0&&(i=""+r),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)Pk.call(e,n)&&!Dk.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:Ck,type:t,key:i,ref:a,props:s,_owner:jk.current}}au.Fragment=Rk;au.jsx=ov;au.jsxs=ov;Yy.exports=au;var l=Yy.exports,lv={exports:{}},zt={},cv={exports:{}},uv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(W,z){var q=W.length;W.push(z);e:for(;0<q;){var re=q-1>>>1,ue=W[re];if(0<s(ue,z))W[re]=z,W[q]=ue,q=re;else break e}}function r(W){return W.length===0?null:W[0]}function n(W){if(W.length===0)return null;var z=W[0],q=W.pop();if(q!==z){W[0]=q;e:for(var re=0,ue=W.length,pe=ue>>>1;re<pe;){var pt=2*(re+1)-1,Ge=W[pt],sr=pt+1,$t=W[sr];if(0>s(Ge,q))sr<ue&&0>s($t,Ge)?(W[re]=$t,W[sr]=q,re=sr):(W[re]=Ge,W[pt]=q,re=pt);else if(sr<ue&&0>s($t,q))W[re]=$t,W[sr]=q,re=sr;else break e}}return z}function s(W,z){var q=W.sortIndex-z.sortIndex;return q!==0?q:W.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,c=a.now();t.unstable_now=function(){return a.now()-c}}var u=[],d=[],f=1,p=null,g=3,w=!1,N=!1,S=!1,C=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(W){for(var z=r(d);z!==null;){if(z.callback===null)n(d);else if(z.startTime<=W)n(d),z.sortIndex=z.expirationTime,e(u,z);else break;z=r(d)}}function j(W){if(S=!1,k(W),!N)if(r(u)!==null)N=!0,sn(F);else{var z=r(d);z!==null&&Rt(j,z.startTime-W)}}function F(W,z){N=!1,S&&(S=!1,T(y),y=-1),w=!0;var q=g;try{for(k(z),p=r(u);p!==null&&(!(p.expirationTime>z)||W&&!A());){var re=p.callback;if(typeof re=="function"){p.callback=null,g=p.priorityLevel;var ue=re(p.expirationTime<=z);z=t.unstable_now(),typeof ue=="function"?p.callback=ue:p===r(u)&&n(u),k(z)}else n(u);p=r(u)}if(p!==null)var pe=!0;else{var pt=r(d);pt!==null&&Rt(j,pt.startTime-z),pe=!1}return pe}finally{p=null,g=q,w=!1}}var D=!1,v=null,y=-1,E=5,b=-1;function A(){return!(t.unstable_now()-b<E)}function R(){if(v!==null){var W=t.unstable_now();b=W;var z=!0;try{z=v(!0,W)}finally{z?I():(D=!1,v=null)}}else D=!1}var I;if(typeof _=="function")I=function(){_(R)};else if(typeof MessageChannel<"u"){var mt=new MessageChannel,nr=mt.port2;mt.port1.onmessage=R,I=function(){nr.postMessage(null)}}else I=function(){C(R,0)};function sn(W){v=W,D||(D=!0,I())}function Rt(W,z){y=C(function(){W(t.unstable_now())},z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(W){W.callback=null},t.unstable_continueExecution=function(){N||w||(N=!0,sn(F))},t.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<W?Math.floor(1e3/W):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function(W){switch(g){case 1:case 2:case 3:var z=3;break;default:z=g}var q=g;g=z;try{return W()}finally{g=q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(W,z){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var q=g;g=W;try{return z()}finally{g=q}},t.unstable_scheduleCallback=function(W,z,q){var re=t.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?re+q:re):q=re,W){case 1:var ue=-1;break;case 2:ue=250;break;case 5:ue=1073741823;break;case 4:ue=1e4;break;default:ue=5e3}return ue=q+ue,W={id:f++,callback:z,priorityLevel:W,startTime:q,expirationTime:ue,sortIndex:-1},q>re?(W.sortIndex=q,e(d,W),r(u)===null&&W===r(d)&&(S?(T(y),y=-1):S=!0,Rt(j,q-re))):(W.sortIndex=ue,e(u,W),N||w||(N=!0,sn(F))),W},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(W){var z=g;return function(){var q=g;g=z;try{return W.apply(this,arguments)}finally{g=q}}}})(uv);cv.exports=uv;var Ok=cv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vk=L,Ut=Ok;function U(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var dv=new Set,Qa={};function Ms(t,e){bi(t,e),bi(t+"Capture",e)}function bi(t,e){for(Qa[t]=e,t=0;t<e.length;t++)dv.add(e[t])}var Kr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),rh=Object.prototype.hasOwnProperty,Mk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ag={},og={};function Lk(t){return rh.call(og,t)?!0:rh.call(ag,t)?!1:Mk.test(t)?og[t]=!0:(ag[t]=!0,!1)}function Fk(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Uk(t,e,r,n){if(e===null||typeof e>"u"||Fk(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function _t(t,e,r,n,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var rt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){rt[t]=new _t(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];rt[e]=new _t(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){rt[t]=new _t(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){rt[t]=new _t(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){rt[t]=new _t(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){rt[t]=new _t(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){rt[t]=new _t(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){rt[t]=new _t(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){rt[t]=new _t(t,5,!1,t.toLowerCase(),null,!1,!1)});var Nf=/[\-:]([a-z])/g;function Af(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Nf,Af);rt[e]=new _t(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Nf,Af);rt[e]=new _t(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Nf,Af);rt[e]=new _t(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){rt[t]=new _t(t,1,!1,t.toLowerCase(),null,!1,!1)});rt.xlinkHref=new _t("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){rt[t]=new _t(t,1,!1,t.toLowerCase(),null,!0,!0)});function Cf(t,e,r,n){var s=rt.hasOwnProperty(e)?rt[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Uk(e,r,s,n)&&(r=null),n||s===null?Lk(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var rn=Vk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_l=Symbol.for("react.element"),ti=Symbol.for("react.portal"),ri=Symbol.for("react.fragment"),Rf=Symbol.for("react.strict_mode"),nh=Symbol.for("react.profiler"),hv=Symbol.for("react.provider"),fv=Symbol.for("react.context"),Pf=Symbol.for("react.forward_ref"),sh=Symbol.for("react.suspense"),ih=Symbol.for("react.suspense_list"),jf=Symbol.for("react.memo"),pn=Symbol.for("react.lazy"),mv=Symbol.for("react.offscreen"),lg=Symbol.iterator;function fa(t){return t===null||typeof t!="object"?null:(t=lg&&t[lg]||t["@@iterator"],typeof t=="function"?t:null)}var Ne=Object.assign,md;function ba(t){if(md===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);md=e&&e[1]||""}return`
`+md+t}var pd=!1;function gd(t,e){if(!t||pd)return"";pd=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var n=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){n=d}t.call(e.prototype)}else{try{throw Error()}catch(d){n=d}t()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=n.stack.split(`
`),a=s.length-1,c=i.length-1;1<=a&&0<=c&&s[a]!==i[c];)c--;for(;1<=a&&0<=c;a--,c--)if(s[a]!==i[c]){if(a!==1||c!==1)do if(a--,c--,0>c||s[a]!==i[c]){var u=`
`+s[a].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=a&&0<=c);break}}}finally{pd=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?ba(t):""}function zk(t){switch(t.tag){case 5:return ba(t.type);case 16:return ba("Lazy");case 13:return ba("Suspense");case 19:return ba("SuspenseList");case 0:case 2:case 15:return t=gd(t.type,!1),t;case 11:return t=gd(t.type.render,!1),t;case 1:return t=gd(t.type,!0),t;default:return""}}function ah(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ri:return"Fragment";case ti:return"Portal";case nh:return"Profiler";case Rf:return"StrictMode";case sh:return"Suspense";case ih:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case fv:return(t.displayName||"Context")+".Consumer";case hv:return(t._context.displayName||"Context")+".Provider";case Pf:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case jf:return e=t.displayName||null,e!==null?e:ah(t.type)||"Memo";case pn:e=t._payload,t=t._init;try{return ah(t(e))}catch{}}return null}function Bk(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ah(e);case 8:return e===Rf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ln(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function pv(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function $k(t){var e=pv(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){n=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function wl(t){t._valueTracker||(t._valueTracker=$k(t))}function gv(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=pv(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function hc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function oh(t,e){var r=e.checked;return Ne({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function cg(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Ln(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function yv(t,e){e=e.checked,e!=null&&Cf(t,"checked",e,!1)}function lh(t,e){yv(t,e);var r=Ln(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?ch(t,e.type,r):e.hasOwnProperty("defaultValue")&&ch(t,e.type,Ln(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function ug(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function ch(t,e,r){(e!=="number"||hc(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Ta=Array.isArray;function mi(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Ln(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function uh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(U(91));return Ne({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function dg(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(U(92));if(Ta(r)){if(1<r.length)throw Error(U(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Ln(r)}}function vv(t,e){var r=Ln(e.value),n=Ln(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function hg(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function xv(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function dh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?xv(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var kl,_v=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(kl=kl||document.createElement("div"),kl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=kl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ya(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Da={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qk=["Webkit","ms","Moz","O"];Object.keys(Da).forEach(function(t){qk.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Da[e]=Da[t]})});function wv(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Da.hasOwnProperty(t)&&Da[t]?(""+e).trim():e+"px"}function kv(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=wv(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var Hk=Ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function hh(t,e){if(e){if(Hk[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(U(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(U(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(U(61))}if(e.style!=null&&typeof e.style!="object")throw Error(U(62))}}function fh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var mh=null;function Df(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ph=null,pi=null,gi=null;function fg(t){if(t=No(t)){if(typeof ph!="function")throw Error(U(280));var e=t.stateNode;e&&(e=du(e),ph(t.stateNode,t.type,e))}}function Ev(t){pi?gi?gi.push(t):gi=[t]:pi=t}function bv(){if(pi){var t=pi,e=gi;if(gi=pi=null,fg(t),e)for(t=0;t<e.length;t++)fg(e[t])}}function Tv(t,e){return t(e)}function Iv(){}var yd=!1;function Sv(t,e,r){if(yd)return t(e,r);yd=!0;try{return Tv(t,e,r)}finally{yd=!1,(pi!==null||gi!==null)&&(Iv(),bv())}}function Xa(t,e){var r=t.stateNode;if(r===null)return null;var n=du(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(U(231,e,typeof r));return r}var gh=!1;if(Kr)try{var ma={};Object.defineProperty(ma,"passive",{get:function(){gh=!0}}),window.addEventListener("test",ma,ma),window.removeEventListener("test",ma,ma)}catch{gh=!1}function Wk(t,e,r,n,s,i,a,c,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(r,d)}catch(f){this.onError(f)}}var Oa=!1,fc=null,mc=!1,yh=null,Kk={onError:function(t){Oa=!0,fc=t}};function Gk(t,e,r,n,s,i,a,c,u){Oa=!1,fc=null,Wk.apply(Kk,arguments)}function Qk(t,e,r,n,s,i,a,c,u){if(Gk.apply(this,arguments),Oa){if(Oa){var d=fc;Oa=!1,fc=null}else throw Error(U(198));mc||(mc=!0,yh=d)}}function Ls(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function Nv(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function mg(t){if(Ls(t)!==t)throw Error(U(188))}function Yk(t){var e=t.alternate;if(!e){if(e=Ls(t),e===null)throw Error(U(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return mg(s),t;if(i===n)return mg(s),e;i=i.sibling}throw Error(U(188))}if(r.return!==n.return)r=s,n=i;else{for(var a=!1,c=s.child;c;){if(c===r){a=!0,r=s,n=i;break}if(c===n){a=!0,n=s,r=i;break}c=c.sibling}if(!a){for(c=i.child;c;){if(c===r){a=!0,r=i,n=s;break}if(c===n){a=!0,n=i,r=s;break}c=c.sibling}if(!a)throw Error(U(189))}}if(r.alternate!==n)throw Error(U(190))}if(r.tag!==3)throw Error(U(188));return r.stateNode.current===r?t:e}function Av(t){return t=Yk(t),t!==null?Cv(t):null}function Cv(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Cv(t);if(e!==null)return e;t=t.sibling}return null}var Rv=Ut.unstable_scheduleCallback,pg=Ut.unstable_cancelCallback,Xk=Ut.unstable_shouldYield,Jk=Ut.unstable_requestPaint,Oe=Ut.unstable_now,Zk=Ut.unstable_getCurrentPriorityLevel,Of=Ut.unstable_ImmediatePriority,Pv=Ut.unstable_UserBlockingPriority,pc=Ut.unstable_NormalPriority,eE=Ut.unstable_LowPriority,jv=Ut.unstable_IdlePriority,ou=null,kr=null;function tE(t){if(kr&&typeof kr.onCommitFiberRoot=="function")try{kr.onCommitFiberRoot(ou,t,void 0,(t.current.flags&128)===128)}catch{}}var hr=Math.clz32?Math.clz32:sE,rE=Math.log,nE=Math.LN2;function sE(t){return t>>>=0,t===0?32:31-(rE(t)/nE|0)|0}var El=64,bl=4194304;function Ia(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function gc(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,i=t.pingedLanes,a=r&268435455;if(a!==0){var c=a&~s;c!==0?n=Ia(c):(i&=a,i!==0&&(n=Ia(i)))}else a=r&~s,a!==0?n=Ia(a):i!==0&&(n=Ia(i));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-hr(e),s=1<<r,n|=t[r],e&=~s;return n}function iE(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function aE(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-hr(i),c=1<<a,u=s[a];u===-1?(!(c&r)||c&n)&&(s[a]=iE(c,e)):u<=e&&(t.expiredLanes|=c),i&=~c}}function vh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Dv(){var t=El;return El<<=1,!(El&4194240)&&(El=64),t}function vd(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Io(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-hr(e),t[e]=r}function oE(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-hr(r),i=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~i}}function Vf(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-hr(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var me=0;function Ov(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Vv,Mf,Mv,Lv,Fv,xh=!1,Tl=[],In=null,Sn=null,Nn=null,Ja=new Map,Za=new Map,yn=[],lE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function gg(t,e){switch(t){case"focusin":case"focusout":In=null;break;case"dragenter":case"dragleave":Sn=null;break;case"mouseover":case"mouseout":Nn=null;break;case"pointerover":case"pointerout":Ja.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Za.delete(e.pointerId)}}function pa(t,e,r,n,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},e!==null&&(e=No(e),e!==null&&Mf(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function cE(t,e,r,n,s){switch(e){case"focusin":return In=pa(In,t,e,r,n,s),!0;case"dragenter":return Sn=pa(Sn,t,e,r,n,s),!0;case"mouseover":return Nn=pa(Nn,t,e,r,n,s),!0;case"pointerover":var i=s.pointerId;return Ja.set(i,pa(Ja.get(i)||null,t,e,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,Za.set(i,pa(Za.get(i)||null,t,e,r,n,s)),!0}return!1}function Uv(t){var e=ps(t.target);if(e!==null){var r=Ls(e);if(r!==null){if(e=r.tag,e===13){if(e=Nv(r),e!==null){t.blockedOn=e,Fv(t.priority,function(){Mv(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Wl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=_h(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);mh=n,r.target.dispatchEvent(n),mh=null}else return e=No(r),e!==null&&Mf(e),t.blockedOn=r,!1;e.shift()}return!0}function yg(t,e,r){Wl(t)&&r.delete(e)}function uE(){xh=!1,In!==null&&Wl(In)&&(In=null),Sn!==null&&Wl(Sn)&&(Sn=null),Nn!==null&&Wl(Nn)&&(Nn=null),Ja.forEach(yg),Za.forEach(yg)}function ga(t,e){t.blockedOn===e&&(t.blockedOn=null,xh||(xh=!0,Ut.unstable_scheduleCallback(Ut.unstable_NormalPriority,uE)))}function eo(t){function e(s){return ga(s,t)}if(0<Tl.length){ga(Tl[0],t);for(var r=1;r<Tl.length;r++){var n=Tl[r];n.blockedOn===t&&(n.blockedOn=null)}}for(In!==null&&ga(In,t),Sn!==null&&ga(Sn,t),Nn!==null&&ga(Nn,t),Ja.forEach(e),Za.forEach(e),r=0;r<yn.length;r++)n=yn[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<yn.length&&(r=yn[0],r.blockedOn===null);)Uv(r),r.blockedOn===null&&yn.shift()}var yi=rn.ReactCurrentBatchConfig,yc=!0;function dE(t,e,r,n){var s=me,i=yi.transition;yi.transition=null;try{me=1,Lf(t,e,r,n)}finally{me=s,yi.transition=i}}function hE(t,e,r,n){var s=me,i=yi.transition;yi.transition=null;try{me=4,Lf(t,e,r,n)}finally{me=s,yi.transition=i}}function Lf(t,e,r,n){if(yc){var s=_h(t,e,r,n);if(s===null)Nd(t,e,n,vc,r),gg(t,n);else if(cE(s,t,e,r,n))n.stopPropagation();else if(gg(t,n),e&4&&-1<lE.indexOf(t)){for(;s!==null;){var i=No(s);if(i!==null&&Vv(i),i=_h(t,e,r,n),i===null&&Nd(t,e,n,vc,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else Nd(t,e,n,null,r)}}var vc=null;function _h(t,e,r,n){if(vc=null,t=Df(n),t=ps(t),t!==null)if(e=Ls(t),e===null)t=null;else if(r=e.tag,r===13){if(t=Nv(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return vc=t,null}function zv(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Zk()){case Of:return 1;case Pv:return 4;case pc:case eE:return 16;case jv:return 536870912;default:return 16}default:return 16}}var En=null,Ff=null,Kl=null;function Bv(){if(Kl)return Kl;var t,e=Ff,r=e.length,n,s="value"in En?En.value:En.textContent,i=s.length;for(t=0;t<r&&e[t]===s[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===s[i-n];n++);return Kl=s.slice(t,1<n?1-n:void 0)}function Gl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Il(){return!0}function vg(){return!1}function Bt(t){function e(r,n,s,i,a){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(r=t[c],this[c]=r?r(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Il:vg,this.isPropagationStopped=vg,this}return Ne(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Il)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Il)},persist:function(){},isPersistent:Il}),e}var Fi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Uf=Bt(Fi),So=Ne({},Fi,{view:0,detail:0}),fE=Bt(So),xd,_d,ya,lu=Ne({},So,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ya&&(ya&&t.type==="mousemove"?(xd=t.screenX-ya.screenX,_d=t.screenY-ya.screenY):_d=xd=0,ya=t),xd)},movementY:function(t){return"movementY"in t?t.movementY:_d}}),xg=Bt(lu),mE=Ne({},lu,{dataTransfer:0}),pE=Bt(mE),gE=Ne({},So,{relatedTarget:0}),wd=Bt(gE),yE=Ne({},Fi,{animationName:0,elapsedTime:0,pseudoElement:0}),vE=Bt(yE),xE=Ne({},Fi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),_E=Bt(xE),wE=Ne({},Fi,{data:0}),_g=Bt(wE),kE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},EE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function TE(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=bE[t])?!!e[t]:!1}function zf(){return TE}var IE=Ne({},So,{key:function(t){if(t.key){var e=kE[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Gl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?EE[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zf,charCode:function(t){return t.type==="keypress"?Gl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Gl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),SE=Bt(IE),NE=Ne({},lu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wg=Bt(NE),AE=Ne({},So,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zf}),CE=Bt(AE),RE=Ne({},Fi,{propertyName:0,elapsedTime:0,pseudoElement:0}),PE=Bt(RE),jE=Ne({},lu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),DE=Bt(jE),OE=[9,13,27,32],Bf=Kr&&"CompositionEvent"in window,Va=null;Kr&&"documentMode"in document&&(Va=document.documentMode);var VE=Kr&&"TextEvent"in window&&!Va,$v=Kr&&(!Bf||Va&&8<Va&&11>=Va),kg=" ",Eg=!1;function qv(t,e){switch(t){case"keyup":return OE.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hv(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ni=!1;function ME(t,e){switch(t){case"compositionend":return Hv(e);case"keypress":return e.which!==32?null:(Eg=!0,kg);case"textInput":return t=e.data,t===kg&&Eg?null:t;default:return null}}function LE(t,e){if(ni)return t==="compositionend"||!Bf&&qv(t,e)?(t=Bv(),Kl=Ff=En=null,ni=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return $v&&e.locale!=="ko"?null:e.data;default:return null}}var FE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!FE[t.type]:e==="textarea"}function Wv(t,e,r,n){Ev(n),e=xc(e,"onChange"),0<e.length&&(r=new Uf("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Ma=null,to=null;function UE(t){nx(t,0)}function cu(t){var e=ai(t);if(gv(e))return t}function zE(t,e){if(t==="change")return e}var Kv=!1;if(Kr){var kd;if(Kr){var Ed="oninput"in document;if(!Ed){var Tg=document.createElement("div");Tg.setAttribute("oninput","return;"),Ed=typeof Tg.oninput=="function"}kd=Ed}else kd=!1;Kv=kd&&(!document.documentMode||9<document.documentMode)}function Ig(){Ma&&(Ma.detachEvent("onpropertychange",Gv),to=Ma=null)}function Gv(t){if(t.propertyName==="value"&&cu(to)){var e=[];Wv(e,to,t,Df(t)),Sv(UE,e)}}function BE(t,e,r){t==="focusin"?(Ig(),Ma=e,to=r,Ma.attachEvent("onpropertychange",Gv)):t==="focusout"&&Ig()}function $E(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return cu(to)}function qE(t,e){if(t==="click")return cu(e)}function HE(t,e){if(t==="input"||t==="change")return cu(e)}function WE(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var mr=typeof Object.is=="function"?Object.is:WE;function ro(t,e){if(mr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!rh.call(e,s)||!mr(t[s],e[s]))return!1}return!0}function Sg(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Ng(t,e){var r=Sg(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Sg(r)}}function Qv(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Qv(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Yv(){for(var t=window,e=hc();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=hc(t.document)}return e}function $f(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function KE(t){var e=Yv(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&Qv(r.ownerDocument.documentElement,r)){if(n!==null&&$f(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!t.extend&&i>n&&(s=n,n=i,i=s),s=Ng(r,i);var a=Ng(r,n);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var GE=Kr&&"documentMode"in document&&11>=document.documentMode,si=null,wh=null,La=null,kh=!1;function Ag(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;kh||si==null||si!==hc(n)||(n=si,"selectionStart"in n&&$f(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),La&&ro(La,n)||(La=n,n=xc(wh,"onSelect"),0<n.length&&(e=new Uf("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=si)))}function Sl(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var ii={animationend:Sl("Animation","AnimationEnd"),animationiteration:Sl("Animation","AnimationIteration"),animationstart:Sl("Animation","AnimationStart"),transitionend:Sl("Transition","TransitionEnd")},bd={},Xv={};Kr&&(Xv=document.createElement("div").style,"AnimationEvent"in window||(delete ii.animationend.animation,delete ii.animationiteration.animation,delete ii.animationstart.animation),"TransitionEvent"in window||delete ii.transitionend.transition);function uu(t){if(bd[t])return bd[t];if(!ii[t])return t;var e=ii[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in Xv)return bd[t]=e[r];return t}var Jv=uu("animationend"),Zv=uu("animationiteration"),ex=uu("animationstart"),tx=uu("transitionend"),rx=new Map,Cg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Kn(t,e){rx.set(t,e),Ms(e,[t])}for(var Td=0;Td<Cg.length;Td++){var Id=Cg[Td],QE=Id.toLowerCase(),YE=Id[0].toUpperCase()+Id.slice(1);Kn(QE,"on"+YE)}Kn(Jv,"onAnimationEnd");Kn(Zv,"onAnimationIteration");Kn(ex,"onAnimationStart");Kn("dblclick","onDoubleClick");Kn("focusin","onFocus");Kn("focusout","onBlur");Kn(tx,"onTransitionEnd");bi("onMouseEnter",["mouseout","mouseover"]);bi("onMouseLeave",["mouseout","mouseover"]);bi("onPointerEnter",["pointerout","pointerover"]);bi("onPointerLeave",["pointerout","pointerover"]);Ms("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ms("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ms("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ms("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ms("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ms("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Sa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),XE=new Set("cancel close invalid load scroll toggle".split(" ").concat(Sa));function Rg(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,Qk(n,e,void 0,t),t.currentTarget=null}function nx(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var i=void 0;if(e)for(var a=n.length-1;0<=a;a--){var c=n[a],u=c.instance,d=c.currentTarget;if(c=c.listener,u!==i&&s.isPropagationStopped())break e;Rg(s,c,d),i=u}else for(a=0;a<n.length;a++){if(c=n[a],u=c.instance,d=c.currentTarget,c=c.listener,u!==i&&s.isPropagationStopped())break e;Rg(s,c,d),i=u}}}if(mc)throw t=yh,mc=!1,yh=null,t}function we(t,e){var r=e[Sh];r===void 0&&(r=e[Sh]=new Set);var n=t+"__bubble";r.has(n)||(sx(e,t,2,!1),r.add(n))}function Sd(t,e,r){var n=0;e&&(n|=4),sx(r,t,n,e)}var Nl="_reactListening"+Math.random().toString(36).slice(2);function no(t){if(!t[Nl]){t[Nl]=!0,dv.forEach(function(r){r!=="selectionchange"&&(XE.has(r)||Sd(r,!1,t),Sd(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Nl]||(e[Nl]=!0,Sd("selectionchange",!1,e))}}function sx(t,e,r,n){switch(zv(e)){case 1:var s=dE;break;case 4:s=hE;break;default:s=Lf}r=s.bind(null,e,r,t),s=void 0,!gh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function Nd(t,e,r,n,s){var i=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var c=n.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(a===4)for(a=n.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;a=a.return}for(;c!==null;){if(a=ps(c),a===null)return;if(u=a.tag,u===5||u===6){n=i=a;continue e}c=c.parentNode}}n=n.return}Sv(function(){var d=i,f=Df(r),p=[];e:{var g=rx.get(t);if(g!==void 0){var w=Uf,N=t;switch(t){case"keypress":if(Gl(r)===0)break e;case"keydown":case"keyup":w=SE;break;case"focusin":N="focus",w=wd;break;case"focusout":N="blur",w=wd;break;case"beforeblur":case"afterblur":w=wd;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=xg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=pE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=CE;break;case Jv:case Zv:case ex:w=vE;break;case tx:w=PE;break;case"scroll":w=fE;break;case"wheel":w=DE;break;case"copy":case"cut":case"paste":w=_E;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=wg}var S=(e&4)!==0,C=!S&&t==="scroll",T=S?g!==null?g+"Capture":null:g;S=[];for(var _=d,k;_!==null;){k=_;var j=k.stateNode;if(k.tag===5&&j!==null&&(k=j,T!==null&&(j=Xa(_,T),j!=null&&S.push(so(_,j,k)))),C)break;_=_.return}0<S.length&&(g=new w(g,N,null,r,f),p.push({event:g,listeners:S}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",w=t==="mouseout"||t==="pointerout",g&&r!==mh&&(N=r.relatedTarget||r.fromElement)&&(ps(N)||N[Gr]))break e;if((w||g)&&(g=f.window===f?f:(g=f.ownerDocument)?g.defaultView||g.parentWindow:window,w?(N=r.relatedTarget||r.toElement,w=d,N=N?ps(N):null,N!==null&&(C=Ls(N),N!==C||N.tag!==5&&N.tag!==6)&&(N=null)):(w=null,N=d),w!==N)){if(S=xg,j="onMouseLeave",T="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(S=wg,j="onPointerLeave",T="onPointerEnter",_="pointer"),C=w==null?g:ai(w),k=N==null?g:ai(N),g=new S(j,_+"leave",w,r,f),g.target=C,g.relatedTarget=k,j=null,ps(f)===d&&(S=new S(T,_+"enter",N,r,f),S.target=k,S.relatedTarget=C,j=S),C=j,w&&N)t:{for(S=w,T=N,_=0,k=S;k;k=Ys(k))_++;for(k=0,j=T;j;j=Ys(j))k++;for(;0<_-k;)S=Ys(S),_--;for(;0<k-_;)T=Ys(T),k--;for(;_--;){if(S===T||T!==null&&S===T.alternate)break t;S=Ys(S),T=Ys(T)}S=null}else S=null;w!==null&&Pg(p,g,w,S,!1),N!==null&&C!==null&&Pg(p,C,N,S,!0)}}e:{if(g=d?ai(d):window,w=g.nodeName&&g.nodeName.toLowerCase(),w==="select"||w==="input"&&g.type==="file")var F=zE;else if(bg(g))if(Kv)F=HE;else{F=$E;var D=BE}else(w=g.nodeName)&&w.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(F=qE);if(F&&(F=F(t,d))){Wv(p,F,r,f);break e}D&&D(t,g,d),t==="focusout"&&(D=g._wrapperState)&&D.controlled&&g.type==="number"&&ch(g,"number",g.value)}switch(D=d?ai(d):window,t){case"focusin":(bg(D)||D.contentEditable==="true")&&(si=D,wh=d,La=null);break;case"focusout":La=wh=si=null;break;case"mousedown":kh=!0;break;case"contextmenu":case"mouseup":case"dragend":kh=!1,Ag(p,r,f);break;case"selectionchange":if(GE)break;case"keydown":case"keyup":Ag(p,r,f)}var v;if(Bf)e:{switch(t){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else ni?qv(t,r)&&(y="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(y="onCompositionStart");y&&($v&&r.locale!=="ko"&&(ni||y!=="onCompositionStart"?y==="onCompositionEnd"&&ni&&(v=Bv()):(En=f,Ff="value"in En?En.value:En.textContent,ni=!0)),D=xc(d,y),0<D.length&&(y=new _g(y,t,null,r,f),p.push({event:y,listeners:D}),v?y.data=v:(v=Hv(r),v!==null&&(y.data=v)))),(v=VE?ME(t,r):LE(t,r))&&(d=xc(d,"onBeforeInput"),0<d.length&&(f=new _g("onBeforeInput","beforeinput",null,r,f),p.push({event:f,listeners:d}),f.data=v))}nx(p,e)})}function so(t,e,r){return{instance:t,listener:e,currentTarget:r}}function xc(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Xa(t,r),i!=null&&n.unshift(so(t,i,s)),i=Xa(t,e),i!=null&&n.push(so(t,i,s))),t=t.return}return n}function Ys(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Pg(t,e,r,n,s){for(var i=e._reactName,a=[];r!==null&&r!==n;){var c=r,u=c.alternate,d=c.stateNode;if(u!==null&&u===n)break;c.tag===5&&d!==null&&(c=d,s?(u=Xa(r,i),u!=null&&a.unshift(so(r,u,c))):s||(u=Xa(r,i),u!=null&&a.push(so(r,u,c)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var JE=/\r\n?/g,ZE=/\u0000|\uFFFD/g;function jg(t){return(typeof t=="string"?t:""+t).replace(JE,`
`).replace(ZE,"")}function Al(t,e,r){if(e=jg(e),jg(t)!==e&&r)throw Error(U(425))}function _c(){}var Eh=null,bh=null;function Th(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ih=typeof setTimeout=="function"?setTimeout:void 0,eb=typeof clearTimeout=="function"?clearTimeout:void 0,Dg=typeof Promise=="function"?Promise:void 0,tb=typeof queueMicrotask=="function"?queueMicrotask:typeof Dg<"u"?function(t){return Dg.resolve(null).then(t).catch(rb)}:Ih;function rb(t){setTimeout(function(){throw t})}function Ad(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),eo(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);eo(e)}function An(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Og(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Ui=Math.random().toString(36).slice(2),wr="__reactFiber$"+Ui,io="__reactProps$"+Ui,Gr="__reactContainer$"+Ui,Sh="__reactEvents$"+Ui,nb="__reactListeners$"+Ui,sb="__reactHandles$"+Ui;function ps(t){var e=t[wr];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Gr]||r[wr]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Og(t);t!==null;){if(r=t[wr])return r;t=Og(t)}return e}t=r,r=t.parentNode}return null}function No(t){return t=t[wr]||t[Gr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ai(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(U(33))}function du(t){return t[io]||null}var Nh=[],oi=-1;function Gn(t){return{current:t}}function ke(t){0>oi||(t.current=Nh[oi],Nh[oi]=null,oi--)}function xe(t,e){oi++,Nh[oi]=t.current,t.current=e}var Fn={},ht=Gn(Fn),Tt=Gn(!1),Es=Fn;function Ti(t,e){var r=t.type.contextTypes;if(!r)return Fn;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=e[i];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function It(t){return t=t.childContextTypes,t!=null}function wc(){ke(Tt),ke(ht)}function Vg(t,e,r){if(ht.current!==Fn)throw Error(U(168));xe(ht,e),xe(Tt,r)}function ix(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(U(108,Bk(t)||"Unknown",s));return Ne({},r,n)}function kc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Fn,Es=ht.current,xe(ht,t),xe(Tt,Tt.current),!0}function Mg(t,e,r){var n=t.stateNode;if(!n)throw Error(U(169));r?(t=ix(t,e,Es),n.__reactInternalMemoizedMergedChildContext=t,ke(Tt),ke(ht),xe(ht,t)):ke(Tt),xe(Tt,r)}var Fr=null,hu=!1,Cd=!1;function ax(t){Fr===null?Fr=[t]:Fr.push(t)}function ib(t){hu=!0,ax(t)}function Qn(){if(!Cd&&Fr!==null){Cd=!0;var t=0,e=me;try{var r=Fr;for(me=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Fr=null,hu=!1}catch(s){throw Fr!==null&&(Fr=Fr.slice(t+1)),Rv(Of,Qn),s}finally{me=e,Cd=!1}}return null}var li=[],ci=0,Ec=null,bc=0,Wt=[],Kt=0,bs=null,Ur=1,zr="";function hs(t,e){li[ci++]=bc,li[ci++]=Ec,Ec=t,bc=e}function ox(t,e,r){Wt[Kt++]=Ur,Wt[Kt++]=zr,Wt[Kt++]=bs,bs=t;var n=Ur;t=zr;var s=32-hr(n)-1;n&=~(1<<s),r+=1;var i=32-hr(e)+s;if(30<i){var a=s-s%5;i=(n&(1<<a)-1).toString(32),n>>=a,s-=a,Ur=1<<32-hr(e)+s|r<<s|n,zr=i+t}else Ur=1<<i|r<<s|n,zr=t}function qf(t){t.return!==null&&(hs(t,1),ox(t,1,0))}function Hf(t){for(;t===Ec;)Ec=li[--ci],li[ci]=null,bc=li[--ci],li[ci]=null;for(;t===bs;)bs=Wt[--Kt],Wt[Kt]=null,zr=Wt[--Kt],Wt[Kt]=null,Ur=Wt[--Kt],Wt[Kt]=null}var Lt=null,Ot=null,be=!1,cr=null;function lx(t,e){var r=Qt(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Lg(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Lt=t,Ot=An(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Lt=t,Ot=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=bs!==null?{id:Ur,overflow:zr}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Qt(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Lt=t,Ot=null,!0):!1;default:return!1}}function Ah(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ch(t){if(be){var e=Ot;if(e){var r=e;if(!Lg(t,e)){if(Ah(t))throw Error(U(418));e=An(r.nextSibling);var n=Lt;e&&Lg(t,e)?lx(n,r):(t.flags=t.flags&-4097|2,be=!1,Lt=t)}}else{if(Ah(t))throw Error(U(418));t.flags=t.flags&-4097|2,be=!1,Lt=t}}}function Fg(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Lt=t}function Cl(t){if(t!==Lt)return!1;if(!be)return Fg(t),be=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Th(t.type,t.memoizedProps)),e&&(e=Ot)){if(Ah(t))throw cx(),Error(U(418));for(;e;)lx(t,e),e=An(e.nextSibling)}if(Fg(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(U(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Ot=An(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Ot=null}}else Ot=Lt?An(t.stateNode.nextSibling):null;return!0}function cx(){for(var t=Ot;t;)t=An(t.nextSibling)}function Ii(){Ot=Lt=null,be=!1}function Wf(t){cr===null?cr=[t]:cr.push(t)}var ab=rn.ReactCurrentBatchConfig;function va(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(U(309));var n=r.stateNode}if(!n)throw Error(U(147,t));var s=n,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var c=s.refs;a===null?delete c[i]:c[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(U(284));if(!r._owner)throw Error(U(290,t))}return t}function Rl(t,e){throw t=Object.prototype.toString.call(e),Error(U(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Ug(t){var e=t._init;return e(t._payload)}function ux(t){function e(T,_){if(t){var k=T.deletions;k===null?(T.deletions=[_],T.flags|=16):k.push(_)}}function r(T,_){if(!t)return null;for(;_!==null;)e(T,_),_=_.sibling;return null}function n(T,_){for(T=new Map;_!==null;)_.key!==null?T.set(_.key,_):T.set(_.index,_),_=_.sibling;return T}function s(T,_){return T=jn(T,_),T.index=0,T.sibling=null,T}function i(T,_,k){return T.index=k,t?(k=T.alternate,k!==null?(k=k.index,k<_?(T.flags|=2,_):k):(T.flags|=2,_)):(T.flags|=1048576,_)}function a(T){return t&&T.alternate===null&&(T.flags|=2),T}function c(T,_,k,j){return _===null||_.tag!==6?(_=Md(k,T.mode,j),_.return=T,_):(_=s(_,k),_.return=T,_)}function u(T,_,k,j){var F=k.type;return F===ri?f(T,_,k.props.children,j,k.key):_!==null&&(_.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===pn&&Ug(F)===_.type)?(j=s(_,k.props),j.ref=va(T,_,k),j.return=T,j):(j=tc(k.type,k.key,k.props,null,T.mode,j),j.ref=va(T,_,k),j.return=T,j)}function d(T,_,k,j){return _===null||_.tag!==4||_.stateNode.containerInfo!==k.containerInfo||_.stateNode.implementation!==k.implementation?(_=Ld(k,T.mode,j),_.return=T,_):(_=s(_,k.children||[]),_.return=T,_)}function f(T,_,k,j,F){return _===null||_.tag!==7?(_=_s(k,T.mode,j,F),_.return=T,_):(_=s(_,k),_.return=T,_)}function p(T,_,k){if(typeof _=="string"&&_!==""||typeof _=="number")return _=Md(""+_,T.mode,k),_.return=T,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case _l:return k=tc(_.type,_.key,_.props,null,T.mode,k),k.ref=va(T,null,_),k.return=T,k;case ti:return _=Ld(_,T.mode,k),_.return=T,_;case pn:var j=_._init;return p(T,j(_._payload),k)}if(Ta(_)||fa(_))return _=_s(_,T.mode,k,null),_.return=T,_;Rl(T,_)}return null}function g(T,_,k,j){var F=_!==null?_.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return F!==null?null:c(T,_,""+k,j);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case _l:return k.key===F?u(T,_,k,j):null;case ti:return k.key===F?d(T,_,k,j):null;case pn:return F=k._init,g(T,_,F(k._payload),j)}if(Ta(k)||fa(k))return F!==null?null:f(T,_,k,j,null);Rl(T,k)}return null}function w(T,_,k,j,F){if(typeof j=="string"&&j!==""||typeof j=="number")return T=T.get(k)||null,c(_,T,""+j,F);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case _l:return T=T.get(j.key===null?k:j.key)||null,u(_,T,j,F);case ti:return T=T.get(j.key===null?k:j.key)||null,d(_,T,j,F);case pn:var D=j._init;return w(T,_,k,D(j._payload),F)}if(Ta(j)||fa(j))return T=T.get(k)||null,f(_,T,j,F,null);Rl(_,j)}return null}function N(T,_,k,j){for(var F=null,D=null,v=_,y=_=0,E=null;v!==null&&y<k.length;y++){v.index>y?(E=v,v=null):E=v.sibling;var b=g(T,v,k[y],j);if(b===null){v===null&&(v=E);break}t&&v&&b.alternate===null&&e(T,v),_=i(b,_,y),D===null?F=b:D.sibling=b,D=b,v=E}if(y===k.length)return r(T,v),be&&hs(T,y),F;if(v===null){for(;y<k.length;y++)v=p(T,k[y],j),v!==null&&(_=i(v,_,y),D===null?F=v:D.sibling=v,D=v);return be&&hs(T,y),F}for(v=n(T,v);y<k.length;y++)E=w(v,T,y,k[y],j),E!==null&&(t&&E.alternate!==null&&v.delete(E.key===null?y:E.key),_=i(E,_,y),D===null?F=E:D.sibling=E,D=E);return t&&v.forEach(function(A){return e(T,A)}),be&&hs(T,y),F}function S(T,_,k,j){var F=fa(k);if(typeof F!="function")throw Error(U(150));if(k=F.call(k),k==null)throw Error(U(151));for(var D=F=null,v=_,y=_=0,E=null,b=k.next();v!==null&&!b.done;y++,b=k.next()){v.index>y?(E=v,v=null):E=v.sibling;var A=g(T,v,b.value,j);if(A===null){v===null&&(v=E);break}t&&v&&A.alternate===null&&e(T,v),_=i(A,_,y),D===null?F=A:D.sibling=A,D=A,v=E}if(b.done)return r(T,v),be&&hs(T,y),F;if(v===null){for(;!b.done;y++,b=k.next())b=p(T,b.value,j),b!==null&&(_=i(b,_,y),D===null?F=b:D.sibling=b,D=b);return be&&hs(T,y),F}for(v=n(T,v);!b.done;y++,b=k.next())b=w(v,T,y,b.value,j),b!==null&&(t&&b.alternate!==null&&v.delete(b.key===null?y:b.key),_=i(b,_,y),D===null?F=b:D.sibling=b,D=b);return t&&v.forEach(function(R){return e(T,R)}),be&&hs(T,y),F}function C(T,_,k,j){if(typeof k=="object"&&k!==null&&k.type===ri&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case _l:e:{for(var F=k.key,D=_;D!==null;){if(D.key===F){if(F=k.type,F===ri){if(D.tag===7){r(T,D.sibling),_=s(D,k.props.children),_.return=T,T=_;break e}}else if(D.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===pn&&Ug(F)===D.type){r(T,D.sibling),_=s(D,k.props),_.ref=va(T,D,k),_.return=T,T=_;break e}r(T,D);break}else e(T,D);D=D.sibling}k.type===ri?(_=_s(k.props.children,T.mode,j,k.key),_.return=T,T=_):(j=tc(k.type,k.key,k.props,null,T.mode,j),j.ref=va(T,_,k),j.return=T,T=j)}return a(T);case ti:e:{for(D=k.key;_!==null;){if(_.key===D)if(_.tag===4&&_.stateNode.containerInfo===k.containerInfo&&_.stateNode.implementation===k.implementation){r(T,_.sibling),_=s(_,k.children||[]),_.return=T,T=_;break e}else{r(T,_);break}else e(T,_);_=_.sibling}_=Ld(k,T.mode,j),_.return=T,T=_}return a(T);case pn:return D=k._init,C(T,_,D(k._payload),j)}if(Ta(k))return N(T,_,k,j);if(fa(k))return S(T,_,k,j);Rl(T,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,_!==null&&_.tag===6?(r(T,_.sibling),_=s(_,k),_.return=T,T=_):(r(T,_),_=Md(k,T.mode,j),_.return=T,T=_),a(T)):r(T,_)}return C}var Si=ux(!0),dx=ux(!1),Tc=Gn(null),Ic=null,ui=null,Kf=null;function Gf(){Kf=ui=Ic=null}function Qf(t){var e=Tc.current;ke(Tc),t._currentValue=e}function Rh(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function vi(t,e){Ic=t,Kf=ui=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(bt=!0),t.firstContext=null)}function Jt(t){var e=t._currentValue;if(Kf!==t)if(t={context:t,memoizedValue:e,next:null},ui===null){if(Ic===null)throw Error(U(308));ui=t,Ic.dependencies={lanes:0,firstContext:t}}else ui=ui.next=t;return e}var gs=null;function Yf(t){gs===null?gs=[t]:gs.push(t)}function hx(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,Yf(e)):(r.next=s.next,s.next=r),e.interleaved=r,Qr(t,n)}function Qr(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var gn=!1;function Xf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function fx(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function qr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Cn(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,de&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,Qr(t,r)}return s=n.interleaved,s===null?(e.next=e,Yf(n)):(e.next=s.next,s.next=e),n.interleaved=e,Qr(t,r)}function Ql(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Vf(t,r)}}function zg(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=a:i=i.next=a,r=r.next}while(r!==null);i===null?s=i=e:i=i.next=e}else s=i=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Sc(t,e,r,n){var s=t.updateQueue;gn=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var u=c,d=u.next;u.next=null,a===null?i=d:a.next=d,a=u;var f=t.alternate;f!==null&&(f=f.updateQueue,c=f.lastBaseUpdate,c!==a&&(c===null?f.firstBaseUpdate=d:c.next=d,f.lastBaseUpdate=u))}if(i!==null){var p=s.baseState;a=0,f=d=u=null,c=i;do{var g=c.lane,w=c.eventTime;if((n&g)===g){f!==null&&(f=f.next={eventTime:w,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var N=t,S=c;switch(g=e,w=r,S.tag){case 1:if(N=S.payload,typeof N=="function"){p=N.call(w,p,g);break e}p=N;break e;case 3:N.flags=N.flags&-65537|128;case 0:if(N=S.payload,g=typeof N=="function"?N.call(w,p,g):N,g==null)break e;p=Ne({},p,g);break e;case 2:gn=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,g=s.effects,g===null?s.effects=[c]:g.push(c))}else w={eventTime:w,lane:g,tag:c.tag,payload:c.payload,callback:c.callback,next:null},f===null?(d=f=w,u=p):f=f.next=w,a|=g;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;g=c,c=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(!0);if(f===null&&(u=p),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Is|=a,t.lanes=a,t.memoizedState=p}}function Bg(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(U(191,s));s.call(n)}}}var Ao={},Er=Gn(Ao),ao=Gn(Ao),oo=Gn(Ao);function ys(t){if(t===Ao)throw Error(U(174));return t}function Jf(t,e){switch(xe(oo,e),xe(ao,t),xe(Er,Ao),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:dh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=dh(e,t)}ke(Er),xe(Er,e)}function Ni(){ke(Er),ke(ao),ke(oo)}function mx(t){ys(oo.current);var e=ys(Er.current),r=dh(e,t.type);e!==r&&(xe(ao,t),xe(Er,r))}function Zf(t){ao.current===t&&(ke(Er),ke(ao))}var Ie=Gn(0);function Nc(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Rd=[];function em(){for(var t=0;t<Rd.length;t++)Rd[t]._workInProgressVersionPrimary=null;Rd.length=0}var Yl=rn.ReactCurrentDispatcher,Pd=rn.ReactCurrentBatchConfig,Ts=0,Se=null,ze=null,We=null,Ac=!1,Fa=!1,lo=0,ob=0;function at(){throw Error(U(321))}function tm(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!mr(t[r],e[r]))return!1;return!0}function rm(t,e,r,n,s,i){if(Ts=i,Se=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Yl.current=t===null||t.memoizedState===null?db:hb,t=r(n,s),Fa){i=0;do{if(Fa=!1,lo=0,25<=i)throw Error(U(301));i+=1,We=ze=null,e.updateQueue=null,Yl.current=fb,t=r(n,s)}while(Fa)}if(Yl.current=Cc,e=ze!==null&&ze.next!==null,Ts=0,We=ze=Se=null,Ac=!1,e)throw Error(U(300));return t}function nm(){var t=lo!==0;return lo=0,t}function xr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return We===null?Se.memoizedState=We=t:We=We.next=t,We}function Zt(){if(ze===null){var t=Se.alternate;t=t!==null?t.memoizedState:null}else t=ze.next;var e=We===null?Se.memoizedState:We.next;if(e!==null)We=e,ze=t;else{if(t===null)throw Error(U(310));ze=t,t={memoizedState:ze.memoizedState,baseState:ze.baseState,baseQueue:ze.baseQueue,queue:ze.queue,next:null},We===null?Se.memoizedState=We=t:We=We.next=t}return We}function co(t,e){return typeof e=="function"?e(t):e}function jd(t){var e=Zt(),r=e.queue;if(r===null)throw Error(U(311));r.lastRenderedReducer=t;var n=ze,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var c=a=null,u=null,d=i;do{var f=d.lane;if((Ts&f)===f)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:t(n,d.action);else{var p={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(c=u=p,a=n):u=u.next=p,Se.lanes|=f,Is|=f}d=d.next}while(d!==null&&d!==i);u===null?a=n:u.next=c,mr(n,e.memoizedState)||(bt=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=u,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do i=s.lane,Se.lanes|=i,Is|=i,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Dd(t){var e=Zt(),r=e.queue;if(r===null)throw Error(U(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,i=e.memoizedState;if(s!==null){r.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);mr(i,e.memoizedState)||(bt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),r.lastRenderedState=i}return[i,n]}function px(){}function gx(t,e){var r=Se,n=Zt(),s=e(),i=!mr(n.memoizedState,s);if(i&&(n.memoizedState=s,bt=!0),n=n.queue,sm(xx.bind(null,r,n,t),[t]),n.getSnapshot!==e||i||We!==null&&We.memoizedState.tag&1){if(r.flags|=2048,uo(9,vx.bind(null,r,n,s,e),void 0,null),Ke===null)throw Error(U(349));Ts&30||yx(r,e,s)}return s}function yx(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Se.updateQueue,e===null?(e={lastEffect:null,stores:null},Se.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function vx(t,e,r,n){e.value=r,e.getSnapshot=n,_x(e)&&wx(t)}function xx(t,e,r){return r(function(){_x(e)&&wx(t)})}function _x(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!mr(t,r)}catch{return!0}}function wx(t){var e=Qr(t,1);e!==null&&fr(e,t,1,-1)}function $g(t){var e=xr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:co,lastRenderedState:t},e.queue=t,t=t.dispatch=ub.bind(null,Se,t),[e.memoizedState,t]}function uo(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Se.updateQueue,e===null?(e={lastEffect:null,stores:null},Se.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function kx(){return Zt().memoizedState}function Xl(t,e,r,n){var s=xr();Se.flags|=t,s.memoizedState=uo(1|e,r,void 0,n===void 0?null:n)}function fu(t,e,r,n){var s=Zt();n=n===void 0?null:n;var i=void 0;if(ze!==null){var a=ze.memoizedState;if(i=a.destroy,n!==null&&tm(n,a.deps)){s.memoizedState=uo(e,r,i,n);return}}Se.flags|=t,s.memoizedState=uo(1|e,r,i,n)}function qg(t,e){return Xl(8390656,8,t,e)}function sm(t,e){return fu(2048,8,t,e)}function Ex(t,e){return fu(4,2,t,e)}function bx(t,e){return fu(4,4,t,e)}function Tx(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Ix(t,e,r){return r=r!=null?r.concat([t]):null,fu(4,4,Tx.bind(null,e,t),r)}function im(){}function Sx(t,e){var r=Zt();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&tm(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function Nx(t,e){var r=Zt();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&tm(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function Ax(t,e,r){return Ts&21?(mr(r,e)||(r=Dv(),Se.lanes|=r,Is|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,bt=!0),t.memoizedState=r)}function lb(t,e){var r=me;me=r!==0&&4>r?r:4,t(!0);var n=Pd.transition;Pd.transition={};try{t(!1),e()}finally{me=r,Pd.transition=n}}function Cx(){return Zt().memoizedState}function cb(t,e,r){var n=Pn(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Rx(t))Px(e,r);else if(r=hx(t,e,r,n),r!==null){var s=vt();fr(r,t,n,s),jx(r,e,n)}}function ub(t,e,r){var n=Pn(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Rx(t))Px(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,c=i(a,r);if(s.hasEagerState=!0,s.eagerState=c,mr(c,a)){var u=e.interleaved;u===null?(s.next=s,Yf(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}r=hx(t,e,s,n),r!==null&&(s=vt(),fr(r,t,n,s),jx(r,e,n))}}function Rx(t){var e=t.alternate;return t===Se||e!==null&&e===Se}function Px(t,e){Fa=Ac=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function jx(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Vf(t,r)}}var Cc={readContext:Jt,useCallback:at,useContext:at,useEffect:at,useImperativeHandle:at,useInsertionEffect:at,useLayoutEffect:at,useMemo:at,useReducer:at,useRef:at,useState:at,useDebugValue:at,useDeferredValue:at,useTransition:at,useMutableSource:at,useSyncExternalStore:at,useId:at,unstable_isNewReconciler:!1},db={readContext:Jt,useCallback:function(t,e){return xr().memoizedState=[t,e===void 0?null:e],t},useContext:Jt,useEffect:qg,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Xl(4194308,4,Tx.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Xl(4194308,4,t,e)},useInsertionEffect:function(t,e){return Xl(4,2,t,e)},useMemo:function(t,e){var r=xr();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=xr();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=cb.bind(null,Se,t),[n.memoizedState,t]},useRef:function(t){var e=xr();return t={current:t},e.memoizedState=t},useState:$g,useDebugValue:im,useDeferredValue:function(t){return xr().memoizedState=t},useTransition:function(){var t=$g(!1),e=t[0];return t=lb.bind(null,t[1]),xr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Se,s=xr();if(be){if(r===void 0)throw Error(U(407));r=r()}else{if(r=e(),Ke===null)throw Error(U(349));Ts&30||yx(n,e,r)}s.memoizedState=r;var i={value:r,getSnapshot:e};return s.queue=i,qg(xx.bind(null,n,i,t),[t]),n.flags|=2048,uo(9,vx.bind(null,n,i,r,e),void 0,null),r},useId:function(){var t=xr(),e=Ke.identifierPrefix;if(be){var r=zr,n=Ur;r=(n&~(1<<32-hr(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=lo++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=ob++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},hb={readContext:Jt,useCallback:Sx,useContext:Jt,useEffect:sm,useImperativeHandle:Ix,useInsertionEffect:Ex,useLayoutEffect:bx,useMemo:Nx,useReducer:jd,useRef:kx,useState:function(){return jd(co)},useDebugValue:im,useDeferredValue:function(t){var e=Zt();return Ax(e,ze.memoizedState,t)},useTransition:function(){var t=jd(co)[0],e=Zt().memoizedState;return[t,e]},useMutableSource:px,useSyncExternalStore:gx,useId:Cx,unstable_isNewReconciler:!1},fb={readContext:Jt,useCallback:Sx,useContext:Jt,useEffect:sm,useImperativeHandle:Ix,useInsertionEffect:Ex,useLayoutEffect:bx,useMemo:Nx,useReducer:Dd,useRef:kx,useState:function(){return Dd(co)},useDebugValue:im,useDeferredValue:function(t){var e=Zt();return ze===null?e.memoizedState=t:Ax(e,ze.memoizedState,t)},useTransition:function(){var t=Dd(co)[0],e=Zt().memoizedState;return[t,e]},useMutableSource:px,useSyncExternalStore:gx,useId:Cx,unstable_isNewReconciler:!1};function or(t,e){if(t&&t.defaultProps){e=Ne({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Ph(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Ne({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var mu={isMounted:function(t){return(t=t._reactInternals)?Ls(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=vt(),s=Pn(t),i=qr(n,s);i.payload=e,r!=null&&(i.callback=r),e=Cn(t,i,s),e!==null&&(fr(e,t,s,n),Ql(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=vt(),s=Pn(t),i=qr(n,s);i.tag=1,i.payload=e,r!=null&&(i.callback=r),e=Cn(t,i,s),e!==null&&(fr(e,t,s,n),Ql(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=vt(),n=Pn(t),s=qr(r,n);s.tag=2,e!=null&&(s.callback=e),e=Cn(t,s,n),e!==null&&(fr(e,t,n,r),Ql(e,t,n))}};function Hg(t,e,r,n,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,i,a):e.prototype&&e.prototype.isPureReactComponent?!ro(r,n)||!ro(s,i):!0}function Dx(t,e,r){var n=!1,s=Fn,i=e.contextType;return typeof i=="object"&&i!==null?i=Jt(i):(s=It(e)?Es:ht.current,n=e.contextTypes,i=(n=n!=null)?Ti(t,s):Fn),e=new e(r,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=mu,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Wg(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&mu.enqueueReplaceState(e,e.state,null)}function jh(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},Xf(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Jt(i):(i=It(e)?Es:ht.current,s.context=Ti(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Ph(t,e,i,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&mu.enqueueReplaceState(s,s.state,null),Sc(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Ai(t,e){try{var r="",n=e;do r+=zk(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Od(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Dh(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var mb=typeof WeakMap=="function"?WeakMap:Map;function Ox(t,e,r){r=qr(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Pc||(Pc=!0,qh=n),Dh(t,e)},r}function Vx(t,e,r){r=qr(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){Dh(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Dh(t,e),typeof n!="function"&&(Rn===null?Rn=new Set([this]):Rn.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function Kg(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new mb;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=Nb.bind(null,t,e,r),e.then(t,t))}function Gg(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Qg(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=qr(-1,1),e.tag=2,Cn(r,e,1))),r.lanes|=1),t)}var pb=rn.ReactCurrentOwner,bt=!1;function yt(t,e,r,n){e.child=t===null?dx(e,null,r,n):Si(e,t.child,r,n)}function Yg(t,e,r,n,s){r=r.render;var i=e.ref;return vi(e,s),n=rm(t,e,r,n,i,s),r=nm(),t!==null&&!bt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Yr(t,e,s)):(be&&r&&qf(e),e.flags|=1,yt(t,e,n,s),e.child)}function Xg(t,e,r,n,s){if(t===null){var i=r.type;return typeof i=="function"&&!fm(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=i,Mx(t,e,i,n,s)):(t=tc(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(r=r.compare,r=r!==null?r:ro,r(a,n)&&t.ref===e.ref)return Yr(t,e,s)}return e.flags|=1,t=jn(i,n),t.ref=e.ref,t.return=e,e.child=t}function Mx(t,e,r,n,s){if(t!==null){var i=t.memoizedProps;if(ro(i,n)&&t.ref===e.ref)if(bt=!1,e.pendingProps=n=i,(t.lanes&s)!==0)t.flags&131072&&(bt=!0);else return e.lanes=t.lanes,Yr(t,e,s)}return Oh(t,e,r,n,s)}function Lx(t,e,r){var n=e.pendingProps,s=n.children,i=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},xe(hi,jt),jt|=r;else{if(!(r&1073741824))return t=i!==null?i.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,xe(hi,jt),jt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,xe(hi,jt),jt|=n}else i!==null?(n=i.baseLanes|r,e.memoizedState=null):n=r,xe(hi,jt),jt|=n;return yt(t,e,s,r),e.child}function Fx(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Oh(t,e,r,n,s){var i=It(r)?Es:ht.current;return i=Ti(e,i),vi(e,s),r=rm(t,e,r,n,i,s),n=nm(),t!==null&&!bt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Yr(t,e,s)):(be&&n&&qf(e),e.flags|=1,yt(t,e,r,s),e.child)}function Jg(t,e,r,n,s){if(It(r)){var i=!0;kc(e)}else i=!1;if(vi(e,s),e.stateNode===null)Jl(t,e),Dx(e,r,n),jh(e,r,n,s),n=!0;else if(t===null){var a=e.stateNode,c=e.memoizedProps;a.props=c;var u=a.context,d=r.contextType;typeof d=="object"&&d!==null?d=Jt(d):(d=It(r)?Es:ht.current,d=Ti(e,d));var f=r.getDerivedStateFromProps,p=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";p||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(c!==n||u!==d)&&Wg(e,a,n,d),gn=!1;var g=e.memoizedState;a.state=g,Sc(e,n,a,s),u=e.memoizedState,c!==n||g!==u||Tt.current||gn?(typeof f=="function"&&(Ph(e,r,f,n),u=e.memoizedState),(c=gn||Hg(e,r,c,n,g,u,d))?(p||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=u),a.props=n,a.state=u,a.context=d,n=c):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,fx(t,e),c=e.memoizedProps,d=e.type===e.elementType?c:or(e.type,c),a.props=d,p=e.pendingProps,g=a.context,u=r.contextType,typeof u=="object"&&u!==null?u=Jt(u):(u=It(r)?Es:ht.current,u=Ti(e,u));var w=r.getDerivedStateFromProps;(f=typeof w=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(c!==p||g!==u)&&Wg(e,a,n,u),gn=!1,g=e.memoizedState,a.state=g,Sc(e,n,a,s);var N=e.memoizedState;c!==p||g!==N||Tt.current||gn?(typeof w=="function"&&(Ph(e,r,w,n),N=e.memoizedState),(d=gn||Hg(e,r,d,n,g,N,u)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,N,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,N,u)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||c===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=N),a.props=n,a.state=N,a.context=u,n=d):(typeof a.componentDidUpdate!="function"||c===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),n=!1)}return Vh(t,e,r,n,i,s)}function Vh(t,e,r,n,s,i){Fx(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return s&&Mg(e,r,!1),Yr(t,e,i);n=e.stateNode,pb.current=e;var c=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=Si(e,t.child,null,i),e.child=Si(e,null,c,i)):yt(t,e,c,i),e.memoizedState=n.state,s&&Mg(e,r,!0),e.child}function Ux(t){var e=t.stateNode;e.pendingContext?Vg(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Vg(t,e.context,!1),Jf(t,e.containerInfo)}function Zg(t,e,r,n,s){return Ii(),Wf(s),e.flags|=256,yt(t,e,r,n),e.child}var Mh={dehydrated:null,treeContext:null,retryLane:0};function Lh(t){return{baseLanes:t,cachePool:null,transitions:null}}function zx(t,e,r){var n=e.pendingProps,s=Ie.current,i=!1,a=(e.flags&128)!==0,c;if((c=a)||(c=t!==null&&t.memoizedState===null?!1:(s&2)!==0),c?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),xe(Ie,s&1),t===null)return Ch(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,i?(n=e.mode,i=e.child,a={mode:"hidden",children:a},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=yu(a,n,0,null),t=_s(t,n,r,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Lh(r),e.memoizedState=Mh,t):am(e,a));if(s=t.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return gb(t,e,a,n,c,s,r);if(i){i=n.fallback,a=e.mode,s=t.child,c=s.sibling;var u={mode:"hidden",children:n.children};return!(a&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=u,e.deletions=null):(n=jn(s,u),n.subtreeFlags=s.subtreeFlags&14680064),c!==null?i=jn(c,i):(i=_s(i,a,r,null),i.flags|=2),i.return=e,n.return=e,n.sibling=i,e.child=n,n=i,i=e.child,a=t.child.memoizedState,a=a===null?Lh(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~r,e.memoizedState=Mh,n}return i=t.child,t=i.sibling,n=jn(i,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function am(t,e){return e=yu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Pl(t,e,r,n){return n!==null&&Wf(n),Si(e,t.child,null,r),t=am(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function gb(t,e,r,n,s,i,a){if(r)return e.flags&256?(e.flags&=-257,n=Od(Error(U(422))),Pl(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=n.fallback,s=e.mode,n=yu({mode:"visible",children:n.children},s,0,null),i=_s(i,s,a,null),i.flags|=2,n.return=e,i.return=e,n.sibling=i,e.child=n,e.mode&1&&Si(e,t.child,null,a),e.child.memoizedState=Lh(a),e.memoizedState=Mh,i);if(!(e.mode&1))return Pl(t,e,a,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var c=n.dgst;return n=c,i=Error(U(419)),n=Od(i,n,void 0),Pl(t,e,a,n)}if(c=(a&t.childLanes)!==0,bt||c){if(n=Ke,n!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Qr(t,s),fr(n,t,s,-1))}return hm(),n=Od(Error(U(421))),Pl(t,e,a,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=Ab.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Ot=An(s.nextSibling),Lt=e,be=!0,cr=null,t!==null&&(Wt[Kt++]=Ur,Wt[Kt++]=zr,Wt[Kt++]=bs,Ur=t.id,zr=t.overflow,bs=e),e=am(e,n.children),e.flags|=4096,e)}function e0(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Rh(t.return,e,r)}function Vd(t,e,r,n,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function Bx(t,e,r){var n=e.pendingProps,s=n.revealOrder,i=n.tail;if(yt(t,e,n.children,r),n=Ie.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&e0(t,r,e);else if(t.tag===19)e0(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(xe(Ie,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&Nc(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),Vd(e,!1,s,r,i);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Nc(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}Vd(e,!0,r,null,i);break;case"together":Vd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Jl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Yr(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Is|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(U(153));if(e.child!==null){for(t=e.child,r=jn(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=jn(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function yb(t,e,r){switch(e.tag){case 3:Ux(e),Ii();break;case 5:mx(e);break;case 1:It(e.type)&&kc(e);break;case 4:Jf(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;xe(Tc,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(xe(Ie,Ie.current&1),e.flags|=128,null):r&e.child.childLanes?zx(t,e,r):(xe(Ie,Ie.current&1),t=Yr(t,e,r),t!==null?t.sibling:null);xe(Ie,Ie.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return Bx(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),xe(Ie,Ie.current),n)break;return null;case 22:case 23:return e.lanes=0,Lx(t,e,r)}return Yr(t,e,r)}var $x,Fh,qx,Hx;$x=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Fh=function(){};qx=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,ys(Er.current);var i=null;switch(r){case"input":s=oh(t,s),n=oh(t,n),i=[];break;case"select":s=Ne({},s,{value:void 0}),n=Ne({},n,{value:void 0}),i=[];break;case"textarea":s=uh(t,s),n=uh(t,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=_c)}hh(r,n);var a;r=null;for(d in s)if(!n.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var c=s[d];for(a in c)c.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Qa.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in n){var u=n[d];if(c=s!=null?s[d]:void 0,n.hasOwnProperty(d)&&u!==c&&(u!=null||c!=null))if(d==="style")if(c){for(a in c)!c.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in u)u.hasOwnProperty(a)&&c[a]!==u[a]&&(r||(r={}),r[a]=u[a])}else r||(i||(i=[]),i.push(d,r)),r=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Qa.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&we("scroll",t),i||c===u||(i=[])):(i=i||[]).push(d,u))}r&&(i=i||[]).push("style",r);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};Hx=function(t,e,r,n){r!==n&&(e.flags|=4)};function xa(t,e){if(!be)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function ot(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function vb(t,e,r){var n=e.pendingProps;switch(Hf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ot(e),null;case 1:return It(e.type)&&wc(),ot(e),null;case 3:return n=e.stateNode,Ni(),ke(Tt),ke(ht),em(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Cl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,cr!==null&&(Kh(cr),cr=null))),Fh(t,e),ot(e),null;case 5:Zf(e);var s=ys(oo.current);if(r=e.type,t!==null&&e.stateNode!=null)qx(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(U(166));return ot(e),null}if(t=ys(Er.current),Cl(e)){n=e.stateNode,r=e.type;var i=e.memoizedProps;switch(n[wr]=e,n[io]=i,t=(e.mode&1)!==0,r){case"dialog":we("cancel",n),we("close",n);break;case"iframe":case"object":case"embed":we("load",n);break;case"video":case"audio":for(s=0;s<Sa.length;s++)we(Sa[s],n);break;case"source":we("error",n);break;case"img":case"image":case"link":we("error",n),we("load",n);break;case"details":we("toggle",n);break;case"input":cg(n,i),we("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},we("invalid",n);break;case"textarea":dg(n,i),we("invalid",n)}hh(r,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var c=i[a];a==="children"?typeof c=="string"?n.textContent!==c&&(i.suppressHydrationWarning!==!0&&Al(n.textContent,c,t),s=["children",c]):typeof c=="number"&&n.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&Al(n.textContent,c,t),s=["children",""+c]):Qa.hasOwnProperty(a)&&c!=null&&a==="onScroll"&&we("scroll",n)}switch(r){case"input":wl(n),ug(n,i,!0);break;case"textarea":wl(n),hg(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=_c)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=xv(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[wr]=e,t[io]=n,$x(t,e,!1,!1),e.stateNode=t;e:{switch(a=fh(r,n),r){case"dialog":we("cancel",t),we("close",t),s=n;break;case"iframe":case"object":case"embed":we("load",t),s=n;break;case"video":case"audio":for(s=0;s<Sa.length;s++)we(Sa[s],t);s=n;break;case"source":we("error",t),s=n;break;case"img":case"image":case"link":we("error",t),we("load",t),s=n;break;case"details":we("toggle",t),s=n;break;case"input":cg(t,n),s=oh(t,n),we("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=Ne({},n,{value:void 0}),we("invalid",t);break;case"textarea":dg(t,n),s=uh(t,n),we("invalid",t);break;default:s=n}hh(r,s),c=s;for(i in c)if(c.hasOwnProperty(i)){var u=c[i];i==="style"?kv(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&_v(t,u)):i==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&Ya(t,u):typeof u=="number"&&Ya(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Qa.hasOwnProperty(i)?u!=null&&i==="onScroll"&&we("scroll",t):u!=null&&Cf(t,i,u,a))}switch(r){case"input":wl(t),ug(t,n,!1);break;case"textarea":wl(t),hg(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Ln(n.value));break;case"select":t.multiple=!!n.multiple,i=n.value,i!=null?mi(t,!!n.multiple,i,!1):n.defaultValue!=null&&mi(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=_c)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ot(e),null;case 6:if(t&&e.stateNode!=null)Hx(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(U(166));if(r=ys(oo.current),ys(Er.current),Cl(e)){if(n=e.stateNode,r=e.memoizedProps,n[wr]=e,(i=n.nodeValue!==r)&&(t=Lt,t!==null))switch(t.tag){case 3:Al(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Al(n.nodeValue,r,(t.mode&1)!==0)}i&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[wr]=e,e.stateNode=n}return ot(e),null;case 13:if(ke(Ie),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(be&&Ot!==null&&e.mode&1&&!(e.flags&128))cx(),Ii(),e.flags|=98560,i=!1;else if(i=Cl(e),n!==null&&n.dehydrated!==null){if(t===null){if(!i)throw Error(U(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(U(317));i[wr]=e}else Ii(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ot(e),i=!1}else cr!==null&&(Kh(cr),cr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Ie.current&1?$e===0&&($e=3):hm())),e.updateQueue!==null&&(e.flags|=4),ot(e),null);case 4:return Ni(),Fh(t,e),t===null&&no(e.stateNode.containerInfo),ot(e),null;case 10:return Qf(e.type._context),ot(e),null;case 17:return It(e.type)&&wc(),ot(e),null;case 19:if(ke(Ie),i=e.memoizedState,i===null)return ot(e),null;if(n=(e.flags&128)!==0,a=i.rendering,a===null)if(n)xa(i,!1);else{if($e!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Nc(t),a!==null){for(e.flags|=128,xa(i,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)i=r,t=n,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return xe(Ie,Ie.current&1|2),e.child}t=t.sibling}i.tail!==null&&Oe()>Ci&&(e.flags|=128,n=!0,xa(i,!1),e.lanes=4194304)}else{if(!n)if(t=Nc(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),xa(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!be)return ot(e),null}else 2*Oe()-i.renderingStartTime>Ci&&r!==1073741824&&(e.flags|=128,n=!0,xa(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(r=i.last,r!==null?r.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Oe(),e.sibling=null,r=Ie.current,xe(Ie,n?r&1|2:r&1),e):(ot(e),null);case 22:case 23:return dm(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?jt&1073741824&&(ot(e),e.subtreeFlags&6&&(e.flags|=8192)):ot(e),null;case 24:return null;case 25:return null}throw Error(U(156,e.tag))}function xb(t,e){switch(Hf(e),e.tag){case 1:return It(e.type)&&wc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ni(),ke(Tt),ke(ht),em(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Zf(e),null;case 13:if(ke(Ie),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(U(340));Ii()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ke(Ie),null;case 4:return Ni(),null;case 10:return Qf(e.type._context),null;case 22:case 23:return dm(),null;case 24:return null;default:return null}}var jl=!1,ut=!1,_b=typeof WeakSet=="function"?WeakSet:Set,G=null;function di(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Pe(t,e,n)}else r.current=null}function Uh(t,e,r){try{r()}catch(n){Pe(t,e,n)}}var t0=!1;function wb(t,e){if(Eh=yc,t=Yv(),$f(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var a=0,c=-1,u=-1,d=0,f=0,p=t,g=null;t:for(;;){for(var w;p!==r||s!==0&&p.nodeType!==3||(c=a+s),p!==i||n!==0&&p.nodeType!==3||(u=a+n),p.nodeType===3&&(a+=p.nodeValue.length),(w=p.firstChild)!==null;)g=p,p=w;for(;;){if(p===t)break t;if(g===r&&++d===s&&(c=a),g===i&&++f===n&&(u=a),(w=p.nextSibling)!==null)break;p=g,g=p.parentNode}p=w}r=c===-1||u===-1?null:{start:c,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(bh={focusedElem:t,selectionRange:r},yc=!1,G=e;G!==null;)if(e=G,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,G=t;else for(;G!==null;){e=G;try{var N=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(N!==null){var S=N.memoizedProps,C=N.memoizedState,T=e.stateNode,_=T.getSnapshotBeforeUpdate(e.elementType===e.type?S:or(e.type,S),C);T.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var k=e.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(U(163))}}catch(j){Pe(e,e.return,j)}if(t=e.sibling,t!==null){t.return=e.return,G=t;break}G=e.return}return N=t0,t0=!1,N}function Ua(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Uh(e,r,i)}s=s.next}while(s!==n)}}function pu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function zh(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function Wx(t){var e=t.alternate;e!==null&&(t.alternate=null,Wx(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[wr],delete e[io],delete e[Sh],delete e[nb],delete e[sb])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Kx(t){return t.tag===5||t.tag===3||t.tag===4}function r0(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Kx(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Bh(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=_c));else if(n!==4&&(t=t.child,t!==null))for(Bh(t,e,r),t=t.sibling;t!==null;)Bh(t,e,r),t=t.sibling}function $h(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for($h(t,e,r),t=t.sibling;t!==null;)$h(t,e,r),t=t.sibling}var Je=null,lr=!1;function fn(t,e,r){for(r=r.child;r!==null;)Gx(t,e,r),r=r.sibling}function Gx(t,e,r){if(kr&&typeof kr.onCommitFiberUnmount=="function")try{kr.onCommitFiberUnmount(ou,r)}catch{}switch(r.tag){case 5:ut||di(r,e);case 6:var n=Je,s=lr;Je=null,fn(t,e,r),Je=n,lr=s,Je!==null&&(lr?(t=Je,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Je.removeChild(r.stateNode));break;case 18:Je!==null&&(lr?(t=Je,r=r.stateNode,t.nodeType===8?Ad(t.parentNode,r):t.nodeType===1&&Ad(t,r),eo(t)):Ad(Je,r.stateNode));break;case 4:n=Je,s=lr,Je=r.stateNode.containerInfo,lr=!0,fn(t,e,r),Je=n,lr=s;break;case 0:case 11:case 14:case 15:if(!ut&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Uh(r,e,a),s=s.next}while(s!==n)}fn(t,e,r);break;case 1:if(!ut&&(di(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(c){Pe(r,e,c)}fn(t,e,r);break;case 21:fn(t,e,r);break;case 22:r.mode&1?(ut=(n=ut)||r.memoizedState!==null,fn(t,e,r),ut=n):fn(t,e,r);break;default:fn(t,e,r)}}function n0(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new _b),e.forEach(function(n){var s=Cb.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function ar(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=t,a=e,c=a;e:for(;c!==null;){switch(c.tag){case 5:Je=c.stateNode,lr=!1;break e;case 3:Je=c.stateNode.containerInfo,lr=!0;break e;case 4:Je=c.stateNode.containerInfo,lr=!0;break e}c=c.return}if(Je===null)throw Error(U(160));Gx(i,a,s),Je=null,lr=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){Pe(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Qx(e,t),e=e.sibling}function Qx(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ar(e,t),vr(t),n&4){try{Ua(3,t,t.return),pu(3,t)}catch(S){Pe(t,t.return,S)}try{Ua(5,t,t.return)}catch(S){Pe(t,t.return,S)}}break;case 1:ar(e,t),vr(t),n&512&&r!==null&&di(r,r.return);break;case 5:if(ar(e,t),vr(t),n&512&&r!==null&&di(r,r.return),t.flags&32){var s=t.stateNode;try{Ya(s,"")}catch(S){Pe(t,t.return,S)}}if(n&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=r!==null?r.memoizedProps:i,c=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&yv(s,i),fh(c,a);var d=fh(c,i);for(a=0;a<u.length;a+=2){var f=u[a],p=u[a+1];f==="style"?kv(s,p):f==="dangerouslySetInnerHTML"?_v(s,p):f==="children"?Ya(s,p):Cf(s,f,p,d)}switch(c){case"input":lh(s,i);break;case"textarea":vv(s,i);break;case"select":var g=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var w=i.value;w!=null?mi(s,!!i.multiple,w,!1):g!==!!i.multiple&&(i.defaultValue!=null?mi(s,!!i.multiple,i.defaultValue,!0):mi(s,!!i.multiple,i.multiple?[]:"",!1))}s[io]=i}catch(S){Pe(t,t.return,S)}}break;case 6:if(ar(e,t),vr(t),n&4){if(t.stateNode===null)throw Error(U(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(S){Pe(t,t.return,S)}}break;case 3:if(ar(e,t),vr(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{eo(e.containerInfo)}catch(S){Pe(t,t.return,S)}break;case 4:ar(e,t),vr(t);break;case 13:ar(e,t),vr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(cm=Oe())),n&4&&n0(t);break;case 22:if(f=r!==null&&r.memoizedState!==null,t.mode&1?(ut=(d=ut)||f,ar(e,t),ut=d):ar(e,t),vr(t),n&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!f&&t.mode&1)for(G=t,f=t.child;f!==null;){for(p=G=f;G!==null;){switch(g=G,w=g.child,g.tag){case 0:case 11:case 14:case 15:Ua(4,g,g.return);break;case 1:di(g,g.return);var N=g.stateNode;if(typeof N.componentWillUnmount=="function"){n=g,r=g.return;try{e=n,N.props=e.memoizedProps,N.state=e.memoizedState,N.componentWillUnmount()}catch(S){Pe(n,r,S)}}break;case 5:di(g,g.return);break;case 22:if(g.memoizedState!==null){i0(p);continue}}w!==null?(w.return=g,G=w):i0(p)}f=f.sibling}e:for(f=null,p=t;;){if(p.tag===5){if(f===null){f=p;try{s=p.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=p.stateNode,u=p.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=wv("display",a))}catch(S){Pe(t,t.return,S)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(S){Pe(t,t.return,S)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:ar(e,t),vr(t),n&4&&n0(t);break;case 21:break;default:ar(e,t),vr(t)}}function vr(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(Kx(r)){var n=r;break e}r=r.return}throw Error(U(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Ya(s,""),n.flags&=-33);var i=r0(t);$h(t,i,s);break;case 3:case 4:var a=n.stateNode.containerInfo,c=r0(t);Bh(t,c,a);break;default:throw Error(U(161))}}catch(u){Pe(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function kb(t,e,r){G=t,Yx(t)}function Yx(t,e,r){for(var n=(t.mode&1)!==0;G!==null;){var s=G,i=s.child;if(s.tag===22&&n){var a=s.memoizedState!==null||jl;if(!a){var c=s.alternate,u=c!==null&&c.memoizedState!==null||ut;c=jl;var d=ut;if(jl=a,(ut=u)&&!d)for(G=s;G!==null;)a=G,u=a.child,a.tag===22&&a.memoizedState!==null?a0(s):u!==null?(u.return=a,G=u):a0(s);for(;i!==null;)G=i,Yx(i),i=i.sibling;G=s,jl=c,ut=d}s0(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,G=i):s0(t)}}function s0(t){for(;G!==null;){var e=G;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ut||pu(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!ut)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:or(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Bg(e,i,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Bg(e,a,r)}break;case 5:var c=e.stateNode;if(r===null&&e.flags&4){r=c;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&eo(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(U(163))}ut||e.flags&512&&zh(e)}catch(g){Pe(e,e.return,g)}}if(e===t){G=null;break}if(r=e.sibling,r!==null){r.return=e.return,G=r;break}G=e.return}}function i0(t){for(;G!==null;){var e=G;if(e===t){G=null;break}var r=e.sibling;if(r!==null){r.return=e.return,G=r;break}G=e.return}}function a0(t){for(;G!==null;){var e=G;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{pu(4,e)}catch(u){Pe(e,r,u)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(u){Pe(e,s,u)}}var i=e.return;try{zh(e)}catch(u){Pe(e,i,u)}break;case 5:var a=e.return;try{zh(e)}catch(u){Pe(e,a,u)}}}catch(u){Pe(e,e.return,u)}if(e===t){G=null;break}var c=e.sibling;if(c!==null){c.return=e.return,G=c;break}G=e.return}}var Eb=Math.ceil,Rc=rn.ReactCurrentDispatcher,om=rn.ReactCurrentOwner,Yt=rn.ReactCurrentBatchConfig,de=0,Ke=null,Le=null,tt=0,jt=0,hi=Gn(0),$e=0,ho=null,Is=0,gu=0,lm=0,za=null,kt=null,cm=0,Ci=1/0,Lr=null,Pc=!1,qh=null,Rn=null,Dl=!1,bn=null,jc=0,Ba=0,Hh=null,Zl=-1,ec=0;function vt(){return de&6?Oe():Zl!==-1?Zl:Zl=Oe()}function Pn(t){return t.mode&1?de&2&&tt!==0?tt&-tt:ab.transition!==null?(ec===0&&(ec=Dv()),ec):(t=me,t!==0||(t=window.event,t=t===void 0?16:zv(t.type)),t):1}function fr(t,e,r,n){if(50<Ba)throw Ba=0,Hh=null,Error(U(185));Io(t,r,n),(!(de&2)||t!==Ke)&&(t===Ke&&(!(de&2)&&(gu|=r),$e===4&&vn(t,tt)),St(t,n),r===1&&de===0&&!(e.mode&1)&&(Ci=Oe()+500,hu&&Qn()))}function St(t,e){var r=t.callbackNode;aE(t,e);var n=gc(t,t===Ke?tt:0);if(n===0)r!==null&&pg(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&pg(r),e===1)t.tag===0?ib(o0.bind(null,t)):ax(o0.bind(null,t)),tb(function(){!(de&6)&&Qn()}),r=null;else{switch(Ov(n)){case 1:r=Of;break;case 4:r=Pv;break;case 16:r=pc;break;case 536870912:r=jv;break;default:r=pc}r=s_(r,Xx.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function Xx(t,e){if(Zl=-1,ec=0,de&6)throw Error(U(327));var r=t.callbackNode;if(xi()&&t.callbackNode!==r)return null;var n=gc(t,t===Ke?tt:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Dc(t,n);else{e=n;var s=de;de|=2;var i=Zx();(Ke!==t||tt!==e)&&(Lr=null,Ci=Oe()+500,xs(t,e));do try{Ib();break}catch(c){Jx(t,c)}while(!0);Gf(),Rc.current=i,de=s,Le!==null?e=0:(Ke=null,tt=0,e=$e)}if(e!==0){if(e===2&&(s=vh(t),s!==0&&(n=s,e=Wh(t,s))),e===1)throw r=ho,xs(t,0),vn(t,n),St(t,Oe()),r;if(e===6)vn(t,n);else{if(s=t.current.alternate,!(n&30)&&!bb(s)&&(e=Dc(t,n),e===2&&(i=vh(t),i!==0&&(n=i,e=Wh(t,i))),e===1))throw r=ho,xs(t,0),vn(t,n),St(t,Oe()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(U(345));case 2:fs(t,kt,Lr);break;case 3:if(vn(t,n),(n&130023424)===n&&(e=cm+500-Oe(),10<e)){if(gc(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){vt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Ih(fs.bind(null,t,kt,Lr),e);break}fs(t,kt,Lr);break;case 4:if(vn(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var a=31-hr(n);i=1<<a,a=e[a],a>s&&(s=a),n&=~i}if(n=s,n=Oe()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Eb(n/1960))-n,10<n){t.timeoutHandle=Ih(fs.bind(null,t,kt,Lr),n);break}fs(t,kt,Lr);break;case 5:fs(t,kt,Lr);break;default:throw Error(U(329))}}}return St(t,Oe()),t.callbackNode===r?Xx.bind(null,t):null}function Wh(t,e){var r=za;return t.current.memoizedState.isDehydrated&&(xs(t,e).flags|=256),t=Dc(t,e),t!==2&&(e=kt,kt=r,e!==null&&Kh(e)),t}function Kh(t){kt===null?kt=t:kt.push.apply(kt,t)}function bb(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!mr(i(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function vn(t,e){for(e&=~lm,e&=~gu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-hr(e),n=1<<r;t[r]=-1,e&=~n}}function o0(t){if(de&6)throw Error(U(327));xi();var e=gc(t,0);if(!(e&1))return St(t,Oe()),null;var r=Dc(t,e);if(t.tag!==0&&r===2){var n=vh(t);n!==0&&(e=n,r=Wh(t,n))}if(r===1)throw r=ho,xs(t,0),vn(t,e),St(t,Oe()),r;if(r===6)throw Error(U(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,fs(t,kt,Lr),St(t,Oe()),null}function um(t,e){var r=de;de|=1;try{return t(e)}finally{de=r,de===0&&(Ci=Oe()+500,hu&&Qn())}}function Ss(t){bn!==null&&bn.tag===0&&!(de&6)&&xi();var e=de;de|=1;var r=Yt.transition,n=me;try{if(Yt.transition=null,me=1,t)return t()}finally{me=n,Yt.transition=r,de=e,!(de&6)&&Qn()}}function dm(){jt=hi.current,ke(hi)}function xs(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,eb(r)),Le!==null)for(r=Le.return;r!==null;){var n=r;switch(Hf(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&wc();break;case 3:Ni(),ke(Tt),ke(ht),em();break;case 5:Zf(n);break;case 4:Ni();break;case 13:ke(Ie);break;case 19:ke(Ie);break;case 10:Qf(n.type._context);break;case 22:case 23:dm()}r=r.return}if(Ke=t,Le=t=jn(t.current,null),tt=jt=e,$e=0,ho=null,lm=gu=Is=0,kt=za=null,gs!==null){for(e=0;e<gs.length;e++)if(r=gs[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var a=i.next;i.next=s,n.next=a}r.pending=n}gs=null}return t}function Jx(t,e){do{var r=Le;try{if(Gf(),Yl.current=Cc,Ac){for(var n=Se.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Ac=!1}if(Ts=0,We=ze=Se=null,Fa=!1,lo=0,om.current=null,r===null||r.return===null){$e=1,ho=e,Le=null;break}e:{var i=t,a=r.return,c=r,u=e;if(e=tt,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,f=c,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var g=f.alternate;g?(f.updateQueue=g.updateQueue,f.memoizedState=g.memoizedState,f.lanes=g.lanes):(f.updateQueue=null,f.memoizedState=null)}var w=Gg(a);if(w!==null){w.flags&=-257,Qg(w,a,c,i,e),w.mode&1&&Kg(i,d,e),e=w,u=d;var N=e.updateQueue;if(N===null){var S=new Set;S.add(u),e.updateQueue=S}else N.add(u);break e}else{if(!(e&1)){Kg(i,d,e),hm();break e}u=Error(U(426))}}else if(be&&c.mode&1){var C=Gg(a);if(C!==null){!(C.flags&65536)&&(C.flags|=256),Qg(C,a,c,i,e),Wf(Ai(u,c));break e}}i=u=Ai(u,c),$e!==4&&($e=2),za===null?za=[i]:za.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var T=Ox(i,u,e);zg(i,T);break e;case 1:c=u;var _=i.type,k=i.stateNode;if(!(i.flags&128)&&(typeof _.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Rn===null||!Rn.has(k)))){i.flags|=65536,e&=-e,i.lanes|=e;var j=Vx(i,c,e);zg(i,j);break e}}i=i.return}while(i!==null)}t_(r)}catch(F){e=F,Le===r&&r!==null&&(Le=r=r.return);continue}break}while(!0)}function Zx(){var t=Rc.current;return Rc.current=Cc,t===null?Cc:t}function hm(){($e===0||$e===3||$e===2)&&($e=4),Ke===null||!(Is&268435455)&&!(gu&268435455)||vn(Ke,tt)}function Dc(t,e){var r=de;de|=2;var n=Zx();(Ke!==t||tt!==e)&&(Lr=null,xs(t,e));do try{Tb();break}catch(s){Jx(t,s)}while(!0);if(Gf(),de=r,Rc.current=n,Le!==null)throw Error(U(261));return Ke=null,tt=0,$e}function Tb(){for(;Le!==null;)e_(Le)}function Ib(){for(;Le!==null&&!Xk();)e_(Le)}function e_(t){var e=n_(t.alternate,t,jt);t.memoizedProps=t.pendingProps,e===null?t_(t):Le=e,om.current=null}function t_(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=xb(r,e),r!==null){r.flags&=32767,Le=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{$e=6,Le=null;return}}else if(r=vb(r,e,jt),r!==null){Le=r;return}if(e=e.sibling,e!==null){Le=e;return}Le=e=t}while(e!==null);$e===0&&($e=5)}function fs(t,e,r){var n=me,s=Yt.transition;try{Yt.transition=null,me=1,Sb(t,e,r,n)}finally{Yt.transition=s,me=n}return null}function Sb(t,e,r,n){do xi();while(bn!==null);if(de&6)throw Error(U(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(U(177));t.callbackNode=null,t.callbackPriority=0;var i=r.lanes|r.childLanes;if(oE(t,i),t===Ke&&(Le=Ke=null,tt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Dl||(Dl=!0,s_(pc,function(){return xi(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Yt.transition,Yt.transition=null;var a=me;me=1;var c=de;de|=4,om.current=null,wb(t,r),Qx(r,t),KE(bh),yc=!!Eh,bh=Eh=null,t.current=r,kb(r),Jk(),de=c,me=a,Yt.transition=i}else t.current=r;if(Dl&&(Dl=!1,bn=t,jc=s),i=t.pendingLanes,i===0&&(Rn=null),tE(r.stateNode),St(t,Oe()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Pc)throw Pc=!1,t=qh,qh=null,t;return jc&1&&t.tag!==0&&xi(),i=t.pendingLanes,i&1?t===Hh?Ba++:(Ba=0,Hh=t):Ba=0,Qn(),null}function xi(){if(bn!==null){var t=Ov(jc),e=Yt.transition,r=me;try{if(Yt.transition=null,me=16>t?16:t,bn===null)var n=!1;else{if(t=bn,bn=null,jc=0,de&6)throw Error(U(331));var s=de;for(de|=4,G=t.current;G!==null;){var i=G,a=i.child;if(G.flags&16){var c=i.deletions;if(c!==null){for(var u=0;u<c.length;u++){var d=c[u];for(G=d;G!==null;){var f=G;switch(f.tag){case 0:case 11:case 15:Ua(8,f,i)}var p=f.child;if(p!==null)p.return=f,G=p;else for(;G!==null;){f=G;var g=f.sibling,w=f.return;if(Wx(f),f===d){G=null;break}if(g!==null){g.return=w,G=g;break}G=w}}}var N=i.alternate;if(N!==null){var S=N.child;if(S!==null){N.child=null;do{var C=S.sibling;S.sibling=null,S=C}while(S!==null)}}G=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,G=a;else e:for(;G!==null;){if(i=G,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Ua(9,i,i.return)}var T=i.sibling;if(T!==null){T.return=i.return,G=T;break e}G=i.return}}var _=t.current;for(G=_;G!==null;){a=G;var k=a.child;if(a.subtreeFlags&2064&&k!==null)k.return=a,G=k;else e:for(a=_;G!==null;){if(c=G,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:pu(9,c)}}catch(F){Pe(c,c.return,F)}if(c===a){G=null;break e}var j=c.sibling;if(j!==null){j.return=c.return,G=j;break e}G=c.return}}if(de=s,Qn(),kr&&typeof kr.onPostCommitFiberRoot=="function")try{kr.onPostCommitFiberRoot(ou,t)}catch{}n=!0}return n}finally{me=r,Yt.transition=e}}return!1}function l0(t,e,r){e=Ai(r,e),e=Ox(t,e,1),t=Cn(t,e,1),e=vt(),t!==null&&(Io(t,1,e),St(t,e))}function Pe(t,e,r){if(t.tag===3)l0(t,t,r);else for(;e!==null;){if(e.tag===3){l0(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Rn===null||!Rn.has(n))){t=Ai(r,t),t=Vx(e,t,1),e=Cn(e,t,1),t=vt(),e!==null&&(Io(e,1,t),St(e,t));break}}e=e.return}}function Nb(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=vt(),t.pingedLanes|=t.suspendedLanes&r,Ke===t&&(tt&r)===r&&($e===4||$e===3&&(tt&130023424)===tt&&500>Oe()-cm?xs(t,0):lm|=r),St(t,e)}function r_(t,e){e===0&&(t.mode&1?(e=bl,bl<<=1,!(bl&130023424)&&(bl=4194304)):e=1);var r=vt();t=Qr(t,e),t!==null&&(Io(t,e,r),St(t,r))}function Ab(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),r_(t,r)}function Cb(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(U(314))}n!==null&&n.delete(e),r_(t,r)}var n_;n_=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Tt.current)bt=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return bt=!1,yb(t,e,r);bt=!!(t.flags&131072)}else bt=!1,be&&e.flags&1048576&&ox(e,bc,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Jl(t,e),t=e.pendingProps;var s=Ti(e,ht.current);vi(e,r),s=rm(null,e,n,t,s,r);var i=nm();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,It(n)?(i=!0,kc(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Xf(e),s.updater=mu,e.stateNode=s,s._reactInternals=e,jh(e,n,t,r),e=Vh(null,e,n,!0,i,r)):(e.tag=0,be&&i&&qf(e),yt(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Jl(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=Pb(n),t=or(n,t),s){case 0:e=Oh(null,e,n,t,r);break e;case 1:e=Jg(null,e,n,t,r);break e;case 11:e=Yg(null,e,n,t,r);break e;case 14:e=Xg(null,e,n,or(n.type,t),r);break e}throw Error(U(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:or(n,s),Oh(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:or(n,s),Jg(t,e,n,s,r);case 3:e:{if(Ux(e),t===null)throw Error(U(387));n=e.pendingProps,i=e.memoizedState,s=i.element,fx(t,e),Sc(e,n,null,r);var a=e.memoizedState;if(n=a.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Ai(Error(U(423)),e),e=Zg(t,e,n,r,s);break e}else if(n!==s){s=Ai(Error(U(424)),e),e=Zg(t,e,n,r,s);break e}else for(Ot=An(e.stateNode.containerInfo.firstChild),Lt=e,be=!0,cr=null,r=dx(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Ii(),n===s){e=Yr(t,e,r);break e}yt(t,e,n,r)}e=e.child}return e;case 5:return mx(e),t===null&&Ch(e),n=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,Th(n,s)?a=null:i!==null&&Th(n,i)&&(e.flags|=32),Fx(t,e),yt(t,e,a,r),e.child;case 6:return t===null&&Ch(e),null;case 13:return zx(t,e,r);case 4:return Jf(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Si(e,null,n,r):yt(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:or(n,s),Yg(t,e,n,s,r);case 7:return yt(t,e,e.pendingProps,r),e.child;case 8:return yt(t,e,e.pendingProps.children,r),e.child;case 12:return yt(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,xe(Tc,n._currentValue),n._currentValue=a,i!==null)if(mr(i.value,a)){if(i.children===s.children&&!Tt.current){e=Yr(t,e,r);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var c=i.dependencies;if(c!==null){a=i.child;for(var u=c.firstContext;u!==null;){if(u.context===n){if(i.tag===1){u=qr(-1,r&-r),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?u.next=u:(u.next=f.next,f.next=u),d.pending=u}}i.lanes|=r,u=i.alternate,u!==null&&(u.lanes|=r),Rh(i.return,r,e),c.lanes|=r;break}u=u.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(U(341));a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),Rh(a,r,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}yt(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,vi(e,r),s=Jt(s),n=n(s),e.flags|=1,yt(t,e,n,r),e.child;case 14:return n=e.type,s=or(n,e.pendingProps),s=or(n.type,s),Xg(t,e,n,s,r);case 15:return Mx(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:or(n,s),Jl(t,e),e.tag=1,It(n)?(t=!0,kc(e)):t=!1,vi(e,r),Dx(e,n,s),jh(e,n,s,r),Vh(null,e,n,!0,t,r);case 19:return Bx(t,e,r);case 22:return Lx(t,e,r)}throw Error(U(156,e.tag))};function s_(t,e){return Rv(t,e)}function Rb(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qt(t,e,r,n){return new Rb(t,e,r,n)}function fm(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Pb(t){if(typeof t=="function")return fm(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Pf)return 11;if(t===jf)return 14}return 2}function jn(t,e){var r=t.alternate;return r===null?(r=Qt(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function tc(t,e,r,n,s,i){var a=2;if(n=t,typeof t=="function")fm(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case ri:return _s(r.children,s,i,e);case Rf:a=8,s|=8;break;case nh:return t=Qt(12,r,e,s|2),t.elementType=nh,t.lanes=i,t;case sh:return t=Qt(13,r,e,s),t.elementType=sh,t.lanes=i,t;case ih:return t=Qt(19,r,e,s),t.elementType=ih,t.lanes=i,t;case mv:return yu(r,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case hv:a=10;break e;case fv:a=9;break e;case Pf:a=11;break e;case jf:a=14;break e;case pn:a=16,n=null;break e}throw Error(U(130,t==null?t:typeof t,""))}return e=Qt(a,r,e,s),e.elementType=t,e.type=n,e.lanes=i,e}function _s(t,e,r,n){return t=Qt(7,t,n,e),t.lanes=r,t}function yu(t,e,r,n){return t=Qt(22,t,n,e),t.elementType=mv,t.lanes=r,t.stateNode={isHidden:!1},t}function Md(t,e,r){return t=Qt(6,t,null,e),t.lanes=r,t}function Ld(t,e,r){return e=Qt(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function jb(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vd(0),this.expirationTimes=vd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vd(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function mm(t,e,r,n,s,i,a,c,u){return t=new jb(t,e,r,c,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Qt(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Xf(i),t}function Db(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ti,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function i_(t){if(!t)return Fn;t=t._reactInternals;e:{if(Ls(t)!==t||t.tag!==1)throw Error(U(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(It(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(U(171))}if(t.tag===1){var r=t.type;if(It(r))return ix(t,r,e)}return e}function a_(t,e,r,n,s,i,a,c,u){return t=mm(r,n,!0,t,s,i,a,c,u),t.context=i_(null),r=t.current,n=vt(),s=Pn(r),i=qr(n,s),i.callback=e??null,Cn(r,i,s),t.current.lanes=s,Io(t,s,n),St(t,n),t}function vu(t,e,r,n){var s=e.current,i=vt(),a=Pn(s);return r=i_(r),e.context===null?e.context=r:e.pendingContext=r,e=qr(i,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Cn(s,e,a),t!==null&&(fr(t,s,a,i),Ql(t,s,a)),a}function Oc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function c0(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function pm(t,e){c0(t,e),(t=t.alternate)&&c0(t,e)}function Ob(){return null}var o_=typeof reportError=="function"?reportError:function(t){console.error(t)};function gm(t){this._internalRoot=t}xu.prototype.render=gm.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(U(409));vu(t,e,null,null)};xu.prototype.unmount=gm.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ss(function(){vu(null,t,null,null)}),e[Gr]=null}};function xu(t){this._internalRoot=t}xu.prototype.unstable_scheduleHydration=function(t){if(t){var e=Lv();t={blockedOn:null,target:t,priority:e};for(var r=0;r<yn.length&&e!==0&&e<yn[r].priority;r++);yn.splice(r,0,t),r===0&&Uv(t)}};function ym(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function _u(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function u0(){}function Vb(t,e,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var d=Oc(a);i.call(d)}}var a=a_(e,n,t,0,null,!1,!1,"",u0);return t._reactRootContainer=a,t[Gr]=a.current,no(t.nodeType===8?t.parentNode:t),Ss(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var c=n;n=function(){var d=Oc(u);c.call(d)}}var u=mm(t,0,!1,null,null,!1,!1,"",u0);return t._reactRootContainer=u,t[Gr]=u.current,no(t.nodeType===8?t.parentNode:t),Ss(function(){vu(e,u,r,n)}),u}function wu(t,e,r,n,s){var i=r._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var c=s;s=function(){var u=Oc(a);c.call(u)}}vu(e,a,t,s)}else a=Vb(r,e,t,s,n);return Oc(a)}Vv=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Ia(e.pendingLanes);r!==0&&(Vf(e,r|1),St(e,Oe()),!(de&6)&&(Ci=Oe()+500,Qn()))}break;case 13:Ss(function(){var n=Qr(t,1);if(n!==null){var s=vt();fr(n,t,1,s)}}),pm(t,1)}};Mf=function(t){if(t.tag===13){var e=Qr(t,134217728);if(e!==null){var r=vt();fr(e,t,134217728,r)}pm(t,134217728)}};Mv=function(t){if(t.tag===13){var e=Pn(t),r=Qr(t,e);if(r!==null){var n=vt();fr(r,t,e,n)}pm(t,e)}};Lv=function(){return me};Fv=function(t,e){var r=me;try{return me=t,e()}finally{me=r}};ph=function(t,e,r){switch(e){case"input":if(lh(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=du(n);if(!s)throw Error(U(90));gv(n),lh(n,s)}}}break;case"textarea":vv(t,r);break;case"select":e=r.value,e!=null&&mi(t,!!r.multiple,e,!1)}};Tv=um;Iv=Ss;var Mb={usingClientEntryPoint:!1,Events:[No,ai,du,Ev,bv,um]},_a={findFiberByHostInstance:ps,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Lb={bundleType:_a.bundleType,version:_a.version,rendererPackageName:_a.rendererPackageName,rendererConfig:_a.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:rn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Av(t),t===null?null:t.stateNode},findFiberByHostInstance:_a.findFiberByHostInstance||Ob,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ol=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ol.isDisabled&&Ol.supportsFiber)try{ou=Ol.inject(Lb),kr=Ol}catch{}}zt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Mb;zt.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ym(e))throw Error(U(200));return Db(t,e,null,r)};zt.createRoot=function(t,e){if(!ym(t))throw Error(U(299));var r=!1,n="",s=o_;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=mm(t,1,!1,null,null,r,!1,n,s),t[Gr]=e.current,no(t.nodeType===8?t.parentNode:t),new gm(e)};zt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(U(188)):(t=Object.keys(t).join(","),Error(U(268,t)));return t=Av(e),t=t===null?null:t.stateNode,t};zt.flushSync=function(t){return Ss(t)};zt.hydrate=function(t,e,r){if(!_u(e))throw Error(U(200));return wu(null,t,e,!0,r)};zt.hydrateRoot=function(t,e,r){if(!ym(t))throw Error(U(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",a=o_;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=a_(e,null,t,1,r??null,s,!1,i,a),t[Gr]=e.current,no(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new xu(e)};zt.render=function(t,e,r){if(!_u(e))throw Error(U(200));return wu(null,t,e,!1,r)};zt.unmountComponentAtNode=function(t){if(!_u(t))throw Error(U(40));return t._reactRootContainer?(Ss(function(){wu(null,null,t,!1,function(){t._reactRootContainer=null,t[Gr]=null})}),!0):!1};zt.unstable_batchedUpdates=um;zt.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!_u(r))throw Error(U(200));if(t==null||t._reactInternals===void 0)throw Error(U(38));return wu(t,e,r,!1,n)};zt.version="18.3.1-next-f1338f8080-20240426";function l_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l_)}catch(t){console.error(t)}}l_(),lv.exports=zt;var Fb=lv.exports,c_,d0=Fb;c_=d0.createRoot,d0.hydrateRoot;const u_=L.createContext(void 0),Ub=()=>{const t=L.useContext(u_);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t},zb=({children:t})=>{const[e,r]=L.useState("system"),[n,s]=L.useState("dark");L.useEffect(()=>{const a=localStorage.getItem("theme");a&&["light","dark","system"].includes(a)&&r(a)},[]),L.useEffect(()=>{const a=()=>{if(e==="system"){const c=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";s(c)}else s(e)};if(a(),e==="system"){const c=window.matchMedia("(prefers-color-scheme: dark)");return c.addEventListener("change",a),()=>c.removeEventListener("change",a)}},[e]),L.useEffect(()=>{localStorage.setItem("theme",e);const a=document.documentElement;n==="dark"?a.classList.add("dark"):a.classList.remove("dark")},[e,n]);const i=a=>{r(a)};return l.jsx(u_.Provider,{value:{theme:e,resolvedTheme:n,setTheme:i},children:t})};/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bb=()=>{};var h0={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d_=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},$b=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[r++];e[n++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[r++],a=t[r++],c=t[r++],u=((s&7)<<18|(i&63)<<12|(a&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{const i=t[r++],a=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},h_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,c=a?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,f=i>>2,p=(i&3)<<4|c>>4;let g=(c&15)<<2|d>>6,w=d&63;u||(w=64,a||(g=64)),n.push(r[f],r[p],r[g],r[w])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(d_(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):$b(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const i=r[t.charAt(s++)],c=s<t.length?r[t.charAt(s)]:0;++s;const d=s<t.length?r[t.charAt(s)]:64;++s;const p=s<t.length?r[t.charAt(s)]:64;if(++s,i==null||c==null||d==null||p==null)throw new qb;const g=i<<2|c>>4;if(n.push(g),d!==64){const w=c<<4&240|d>>2;if(n.push(w),p!==64){const N=d<<6&192|p;n.push(N)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class qb extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Hb=function(t){const e=d_(t);return h_.encodeByteArray(e,!0)},Vc=function(t){return Hb(t).replace(/\./g,"")},f_=function(t){try{return h_.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wb(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kb=()=>Wb().__FIREBASE_DEFAULTS__,Gb=()=>{if(typeof process>"u"||typeof h0>"u")return;const t=h0.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Qb=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&f_(t[1]);return e&&JSON.parse(e)},ku=()=>{try{return Bb()||Kb()||Gb()||Qb()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},m_=t=>{var e,r;return(r=(e=ku())==null?void 0:e.emulatorHosts)==null?void 0:r[t]},p_=t=>{const e=m_(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},g_=()=>{var t;return(t=ku())==null?void 0:t.config},y_=t=>{var e;return(e=ku())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yb{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fs(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function vm(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v_(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Vc(JSON.stringify(r)),Vc(JSON.stringify(a)),""].join(".")}const $a={};function Xb(){const t={prod:[],emulator:[]};for(const e of Object.keys($a))$a[e]?t.emulator.push(e):t.prod.push(e);return t}function Jb(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let f0=!1;function xm(t,e){if(typeof window>"u"||typeof document>"u"||!Fs(window.location.host)||$a[t]===e||$a[t]||f0)return;$a[t]=e;function r(g){return`__firebase__banner__${g}`}const n="__firebase__banner",i=Xb().prod.length>0;function a(){const g=document.getElementById(n);g&&g.remove()}function c(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function u(g,w){g.setAttribute("width","24"),g.setAttribute("id",w),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function d(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{f0=!0,a()},g}function f(g,w){g.setAttribute("id",w),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function p(){const g=Jb(n),w=r("text"),N=document.getElementById(w)||document.createElement("span"),S=r("learnmore"),C=document.getElementById(S)||document.createElement("a"),T=r("preprendIcon"),_=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const k=g.element;c(k),f(C,S);const j=d();u(_,T),k.append(_,N,C,j),document.body.appendChild(k)}i?(N.innerText="Preview backend disconnected.",_.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(_.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,N.innerText="Preview backend running in this workspace."),N.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ft(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Zb(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ft())}function e2(){var e;const t=(e=ku())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function t2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function r2(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function n2(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function s2(){const t=ft();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function i2(){return!e2()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function a2(){try{return typeof indexedDB=="object"}catch{return!1}}function o2(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l2="FirebaseError";class er extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=l2,Object.setPrototypeOf(this,er.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Co.prototype.create)}}class Co{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?c2(i,n):"Error",c=`${this.serviceName}: ${a} (${s}).`;return new er(s,c,n)}}function c2(t,e){return t.replace(u2,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const u2=/\{\$([^}]+)}/g;function d2(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ns(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const i=t[s],a=e[s];if(m0(i)&&m0(a)){if(!Ns(i,a))return!1}else if(i!==a)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function m0(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ro(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Na(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,i]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Aa(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function h2(t,e){const r=new f2(t,e);return r.subscribe.bind(r)}class f2{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");m2(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=Fd),s.error===void 0&&(s.error=Fd),s.complete===void 0&&(s.complete=Fd);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function m2(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Fd(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ae(t){return t&&t._delegate?t._delegate:t}class Un{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ms="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p2{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new Yb;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(y2(e))try{this.getOrInitializeService({instanceIdentifier:ms})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:s});n.resolve(i)}catch{}}}}clearInstance(e=ms){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ms){return this.instances.has(e)}getOptions(e=ms){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);n===c&&a.resolve(s)}return s}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),s=this.onInitCallbacks.get(n)??new Set;s.add(e),this.onInitCallbacks.set(n,s);const i=this.instances.get(n);return i&&e(i,n),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:g2(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ms){return this.component?this.component.multipleInstances?e:ms:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function g2(t){return t===ms?void 0:t}function y2(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v2{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new p2(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ie;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ie||(ie={}));const x2={debug:ie.DEBUG,verbose:ie.VERBOSE,info:ie.INFO,warn:ie.WARN,error:ie.ERROR,silent:ie.SILENT},_2=ie.INFO,w2={[ie.DEBUG]:"log",[ie.VERBOSE]:"log",[ie.INFO]:"info",[ie.WARN]:"warn",[ie.ERROR]:"error"},k2=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=w2[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class _m{constructor(e){this.name=e,this._logLevel=_2,this._logHandler=k2,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ie))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?x2[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ie.DEBUG,...e),this._logHandler(this,ie.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ie.VERBOSE,...e),this._logHandler(this,ie.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ie.INFO,...e),this._logHandler(this,ie.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ie.WARN,...e),this._logHandler(this,ie.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ie.ERROR,...e),this._logHandler(this,ie.ERROR,...e)}}const E2=(t,e)=>e.some(r=>t instanceof r);let p0,g0;function b2(){return p0||(p0=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function T2(){return g0||(g0=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const x_=new WeakMap,Gh=new WeakMap,__=new WeakMap,Ud=new WeakMap,wm=new WeakMap;function I2(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{r(Dn(t.result)),s()},a=()=>{n(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&x_.set(r,t)}).catch(()=>{}),wm.set(e,t),e}function S2(t){if(Gh.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{r(),s()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});Gh.set(t,e)}let Qh={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Gh.get(t);if(e==="objectStoreNames")return t.objectStoreNames||__.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Dn(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function N2(t){Qh=t(Qh)}function A2(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(zd(this),e,...r);return __.set(n,e.sort?e.sort():[e]),Dn(n)}:T2().includes(t)?function(...e){return t.apply(zd(this),e),Dn(x_.get(this))}:function(...e){return Dn(t.apply(zd(this),e))}}function C2(t){return typeof t=="function"?A2(t):(t instanceof IDBTransaction&&S2(t),E2(t,b2())?new Proxy(t,Qh):t)}function Dn(t){if(t instanceof IDBRequest)return I2(t);if(Ud.has(t))return Ud.get(t);const e=C2(t);return e!==t&&(Ud.set(t,e),wm.set(e,t)),e}const zd=t=>wm.get(t);function R2(t,e,{blocked:r,upgrade:n,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),c=Dn(a);return n&&a.addEventListener("upgradeneeded",u=>{n(Dn(a.result),u.oldVersion,u.newVersion,Dn(a.transaction),u)}),r&&a.addEventListener("blocked",u=>r(u.oldVersion,u.newVersion,u)),c.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const P2=["get","getKey","getAll","getAllKeys","count"],j2=["put","add","delete","clear"],Bd=new Map;function y0(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Bd.get(e))return Bd.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=j2.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||P2.includes(r)))return;const i=async function(a,...c){const u=this.transaction(a,s?"readwrite":"readonly");let d=u.store;return n&&(d=d.index(c.shift())),(await Promise.all([d[r](...c),s&&u.done]))[0]};return Bd.set(e,i),i}N2(t=>({...t,get:(e,r,n)=>y0(e,r)||t.get(e,r,n),has:(e,r)=>!!y0(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D2{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(O2(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function O2(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Yh="@firebase/app",v0="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xr=new _m("@firebase/app"),V2="@firebase/app-compat",M2="@firebase/analytics-compat",L2="@firebase/analytics",F2="@firebase/app-check-compat",U2="@firebase/app-check",z2="@firebase/auth",B2="@firebase/auth-compat",$2="@firebase/database",q2="@firebase/data-connect",H2="@firebase/database-compat",W2="@firebase/functions",K2="@firebase/functions-compat",G2="@firebase/installations",Q2="@firebase/installations-compat",Y2="@firebase/messaging",X2="@firebase/messaging-compat",J2="@firebase/performance",Z2="@firebase/performance-compat",eT="@firebase/remote-config",tT="@firebase/remote-config-compat",rT="@firebase/storage",nT="@firebase/storage-compat",sT="@firebase/firestore",iT="@firebase/ai",aT="@firebase/firestore-compat",oT="firebase",lT="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xh="[DEFAULT]",cT={[Yh]:"fire-core",[V2]:"fire-core-compat",[L2]:"fire-analytics",[M2]:"fire-analytics-compat",[U2]:"fire-app-check",[F2]:"fire-app-check-compat",[z2]:"fire-auth",[B2]:"fire-auth-compat",[$2]:"fire-rtdb",[q2]:"fire-data-connect",[H2]:"fire-rtdb-compat",[W2]:"fire-fn",[K2]:"fire-fn-compat",[G2]:"fire-iid",[Q2]:"fire-iid-compat",[Y2]:"fire-fcm",[X2]:"fire-fcm-compat",[J2]:"fire-perf",[Z2]:"fire-perf-compat",[eT]:"fire-rc",[tT]:"fire-rc-compat",[rT]:"fire-gcs",[nT]:"fire-gcs-compat",[sT]:"fire-fst",[aT]:"fire-fst-compat",[iT]:"fire-vertex","fire-js":"fire-js",[oT]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mc=new Map,uT=new Map,Jh=new Map;function x0(t,e){try{t.container.addComponent(e)}catch(r){Xr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function As(t){const e=t.name;if(Jh.has(e))return Xr.debug(`There were multiple attempts to register component ${e}.`),!1;Jh.set(e,t);for(const r of Mc.values())x0(r,t);for(const r of uT.values())x0(r,t);return!0}function Eu(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Dt(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dT={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},On=new Co("app","Firebase",dT);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Un("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw On.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Us=lT;function w_(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:Xh,automaticDataCollectionEnabled:!0,...e},s=n.name;if(typeof s!="string"||!s)throw On.create("bad-app-name",{appName:String(s)});if(r||(r=g_()),!r)throw On.create("no-options");const i=Mc.get(s);if(i){if(Ns(r,i.options)&&Ns(n,i.config))return i;throw On.create("duplicate-app",{appName:s})}const a=new v2(s);for(const u of Jh.values())a.addComponent(u);const c=new hT(r,n,a);return Mc.set(s,c),c}function km(t=Xh){const e=Mc.get(t);if(!e&&t===Xh&&g_())return w_();if(!e)throw On.create("no-app",{appName:t});return e}function br(t,e,r){let n=cT[t]??t;r&&(n+=`-${r}`);const s=n.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const a=[`Unable to register library "${n}" with version "${e}":`];s&&a.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Xr.warn(a.join(" "));return}As(new Un(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fT="firebase-heartbeat-database",mT=1,fo="firebase-heartbeat-store";let $d=null;function k_(){return $d||($d=R2(fT,mT,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(fo)}catch(r){console.warn(r)}}}}).catch(t=>{throw On.create("idb-open",{originalErrorMessage:t.message})})),$d}async function pT(t){try{const r=(await k_()).transaction(fo),n=await r.objectStore(fo).get(E_(t));return await r.done,n}catch(e){if(e instanceof er)Xr.warn(e.message);else{const r=On.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Xr.warn(r.message)}}}async function _0(t,e){try{const n=(await k_()).transaction(fo,"readwrite");await n.objectStore(fo).put(e,E_(t)),await n.done}catch(r){if(r instanceof er)Xr.warn(r.message);else{const n=On.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Xr.warn(n.message)}}}function E_(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gT=1024,yT=30;class vT{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new _T(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=w0();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)==null?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>yT){const a=wT(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Xr.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=w0(),{heartbeatsToSend:n,unsentEntries:s}=xT(this._heartbeatsCache.heartbeats),i=Vc(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(r){return Xr.warn(r),""}}}function w0(){return new Date().toISOString().substring(0,10)}function xT(t,e=gT){const r=[];let n=t.slice();for(const s of t){const i=r.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),k0(r)>e){i.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),k0(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class _T{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return a2()?o2().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await pT(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return _0(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return _0(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function k0(t){return Vc(JSON.stringify({version:2,heartbeats:t})).length}function wT(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kT(t){As(new Un("platform-logger",e=>new D2(e),"PRIVATE")),As(new Un("heartbeat",e=>new vT(e),"PRIVATE")),br(Yh,v0,t),br(Yh,v0,"esm2020"),br("fire-js","")}kT("");function b_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ET=b_,T_=new Co("auth","Firebase",b_());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lc=new _m("@firebase/auth");function bT(t,...e){Lc.logLevel<=ie.WARN&&Lc.warn(`Auth (${Us}): ${t}`,...e)}function rc(t,...e){Lc.logLevel<=ie.ERROR&&Lc.error(`Auth (${Us}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pr(t,...e){throw Em(t,...e)}function Tr(t,...e){return Em(t,...e)}function I_(t,e,r){const n={...ET(),[e]:r};return new Co("auth","Firebase",n).create(e,{appName:t.name})}function Hr(t){return I_(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Em(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return T_.create(t,...e)}function J(t,e,...r){if(!t)throw Em(e,...r)}function Br(t){const e="INTERNAL ASSERTION FAILED: "+t;throw rc(e),new Error(e)}function Jr(t,e){t||Br(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zh(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function TT(){return E0()==="http:"||E0()==="https:"}function E0(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IT(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(TT()||r2()||"connection"in navigator)?navigator.onLine:!0}function ST(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(e,r){this.shortDelay=e,this.longDelay=r,Jr(r>e,"Short delay should be less than long delay!"),this.isMobile=Zb()||n2()}get(){return IT()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bm(t,e){Jr(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S_{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Br("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Br("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Br("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NT={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AT=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],CT=new Po(3e4,6e4);function nn(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function jr(t,e,r,n,s={}){return N_(t,s,async()=>{let i={},a={};n&&(e==="GET"?a=n:i={body:JSON.stringify(n)});const c=Ro({key:t.config.apiKey,...a}).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:u,...i};return t2()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Fs(t.emulatorConfig.host)&&(d.credentials="include"),S_.fetch()(await A_(t,t.config.apiHost,r,c),d)})}async function N_(t,e,r){t._canInitEmulator=!1;const n={...NT,...e};try{const s=new PT(t),i=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw Vl(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const c=i.ok?a.errorMessage:a.error.message,[u,d]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Vl(t,"credential-already-in-use",a);if(u==="EMAIL_EXISTS")throw Vl(t,"email-already-in-use",a);if(u==="USER_DISABLED")throw Vl(t,"user-disabled",a);const f=n[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw I_(t,f,d);pr(t,f)}}catch(s){if(s instanceof er)throw s;pr(t,"network-request-failed",{message:String(s)})}}async function jo(t,e,r,n,s={}){const i=await jr(t,e,r,n,s);return"mfaPendingCredential"in i&&pr(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function A_(t,e,r,n){const s=`${e}${r}?${n}`,i=t,a=i.config.emulator?bm(t.config,s):`${t.config.apiScheme}://${s}`;return AT.includes(r)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}function RT(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class PT{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Tr(this.auth,"network-request-failed")),CT.get())})}}function Vl(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=Tr(t,e,n);return s.customData._tokenResponse=r,s}function b0(t){return t!==void 0&&t.enterprise!==void 0}class jT{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return RT(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function DT(t,e){return jr(t,"GET","/v2/recaptchaConfig",nn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OT(t,e){return jr(t,"POST","/v1/accounts:delete",e)}async function Fc(t,e){return jr(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qa(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function VT(t,e=!1){const r=Ae(t),n=await r.getIdToken(e),s=Tm(n);J(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:s,token:n,authTime:qa(qd(s.auth_time)),issuedAtTime:qa(qd(s.iat)),expirationTime:qa(qd(s.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function qd(t){return Number(t)*1e3}function Tm(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return rc("JWT malformed, contained fewer than 3 sections"),null;try{const s=f_(r);return s?JSON.parse(s):(rc("Failed to decode base64 JWT payload"),null)}catch(s){return rc("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function T0(t){const e=Tm(t);return J(e,"internal-error"),J(typeof e.exp<"u","internal-error"),J(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ri(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof er&&MT(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function MT({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LT{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=qa(this.lastLoginAt),this.creationTime=qa(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uc(t){var p;const e=t.auth,r=await t.getIdToken(),n=await Ri(t,Fc(e,{idToken:r}));J(n==null?void 0:n.users.length,e,"internal-error");const s=n.users[0];t._notifyReloadListener(s);const i=(p=s.providerUserInfo)!=null&&p.length?C_(s.providerUserInfo):[],a=UT(t.providerData,i),c=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(a!=null&&a.length),d=c?u:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new ef(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,f)}async function FT(t){const e=Ae(t);await Uc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function UT(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function C_(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zT(t,e){const r=await N_(t,{},async()=>{const n=Ro({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,a=await A_(t,s,"/v1/token",`key=${i}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:n};return t.emulatorConfig&&Fs(t.emulatorConfig.host)&&(u.credentials="include"),S_.fetch()(a,u)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function BT(t,e){return jr(t,"POST","/v2/accounts:revokeToken",nn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){J(e.idToken,"internal-error"),J(typeof e.idToken<"u","internal-error"),J(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):T0(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){J(e.length!==0,"internal-error");const r=T0(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(J(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:i}=await zT(e,r);this.updateTokensAndExpiration(n,s,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:i}=r,a=new _i;return n&&(J(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),s&&(J(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(J(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new _i,this.toJSON())}_performRefresh(){return Br("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mn(t,e){J(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ur{constructor({uid:e,auth:r,stsTokenManager:n,...s}){this.providerId="firebase",this.proactiveRefresh=new LT(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new ef(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await Ri(this,this.stsTokenManager.getToken(this.auth,e));return J(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return VT(this,e)}reload(){return FT(this)}_assign(e){this!==e&&(J(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new ur({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){J(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Uc(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Dt(this.auth.app))return Promise.reject(Hr(this.auth));const e=await this.getIdToken();return await Ri(this,OT(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,s=r.email??void 0,i=r.phoneNumber??void 0,a=r.photoURL??void 0,c=r.tenantId??void 0,u=r._redirectEventId??void 0,d=r.createdAt??void 0,f=r.lastLoginAt??void 0,{uid:p,emailVerified:g,isAnonymous:w,providerData:N,stsTokenManager:S}=r;J(p&&S,e,"internal-error");const C=_i.fromJSON(this.name,S);J(typeof p=="string",e,"internal-error"),mn(n,e.name),mn(s,e.name),J(typeof g=="boolean",e,"internal-error"),J(typeof w=="boolean",e,"internal-error"),mn(i,e.name),mn(a,e.name),mn(c,e.name),mn(u,e.name),mn(d,e.name),mn(f,e.name);const T=new ur({uid:p,auth:e,email:s,emailVerified:g,displayName:n,isAnonymous:w,photoURL:a,phoneNumber:i,tenantId:c,stsTokenManager:C,createdAt:d,lastLoginAt:f});return N&&Array.isArray(N)&&(T.providerData=N.map(_=>({..._}))),u&&(T._redirectEventId=u),T}static async _fromIdTokenResponse(e,r,n=!1){const s=new _i;s.updateFromServerResponse(r);const i=new ur({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await Uc(i),i}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];J(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?C_(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),c=new _i;c.updateFromIdToken(n);const u=new ur({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:a}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new ef(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I0=new Map;function $r(t){Jr(t instanceof Function,"Expected a class definition");let e=I0.get(t);return e?(Jr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,I0.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}R_.type="NONE";const S0=R_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nc(t,e,r){return`firebase:${t}:${e}:${r}`}class wi{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:i}=this.auth;this.fullUserKey=nc(this.userKey,s.apiKey,i),this.fullPersistenceKey=nc("persistence",s.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await Fc(this.auth,{idToken:e}).catch(()=>{});return r?ur._fromGetAccountInfoResponse(this.auth,r,e):null}return ur._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new wi($r(S0),e,n);const s=(await Promise.all(r.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||$r(S0);const a=nc(n,e.config.apiKey,e.name);let c=null;for(const d of r)try{const f=await d._get(a);if(f){let p;if(typeof f=="string"){const g=await Fc(e,{idToken:f}).catch(()=>{});if(!g)break;p=await ur._fromGetAccountInfoResponse(e,g,f)}else p=ur._fromJSON(e,f);d!==i&&(c=p),i=d;break}}catch{}const u=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new wi(i,e,n):(i=u[0],c&&await i._set(a,c.toJSON()),await Promise.all(r.map(async d=>{if(d!==i)try{await d._remove(a)}catch{}})),new wi(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N0(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(O_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(P_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(M_(e))return"Blackberry";if(L_(e))return"Webos";if(j_(e))return"Safari";if((e.includes("chrome/")||D_(e))&&!e.includes("edge/"))return"Chrome";if(V_(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function P_(t=ft()){return/firefox\//i.test(t)}function j_(t=ft()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function D_(t=ft()){return/crios\//i.test(t)}function O_(t=ft()){return/iemobile/i.test(t)}function V_(t=ft()){return/android/i.test(t)}function M_(t=ft()){return/blackberry/i.test(t)}function L_(t=ft()){return/webos/i.test(t)}function Im(t=ft()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function $T(t=ft()){var e;return Im(t)&&!!((e=window.navigator)!=null&&e.standalone)}function qT(){return s2()&&document.documentMode===10}function F_(t=ft()){return Im(t)||V_(t)||L_(t)||M_(t)||/windows phone/i.test(t)||O_(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U_(t,e=[]){let r;switch(t){case"Browser":r=N0(ft());break;case"Worker":r=`${N0(ft())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Us}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HT{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((a,c)=>{try{const u=e(i);a(u)}catch(u){c(u)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WT(t,e={}){return jr(t,"GET","/v2/passwordPolicy",nn(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KT=6;class GT{constructor(e){var n;const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??KT,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QT{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new A0(this),this.idTokenSubscription=new A0(this),this.beforeStateQueue=new HT(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=T_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=$r(r)),this._initializationPromise=this.queue(async()=>{var n,s,i;if(!this._deleted&&(this.persistenceManager=await wi.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await Fc(this,{idToken:e}),n=await ur._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(Dt(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(c,c))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(i=this.redirectUser)==null?void 0:i._redirectEventId,c=n==null?void 0:n._redirectEventId,u=await this.tryRedirectSignIn(e);(!a||a===c)&&(u!=null&&u.user)&&(n=u.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(a){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return J(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Uc(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=ST()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Dt(this.app))return Promise.reject(Hr(this));const r=e?Ae(e):null;return r&&J(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&J(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Dt(this.app)?Promise.reject(Hr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Dt(this.app)?Promise.reject(Hr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence($r(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await WT(this),r=new GT(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Co("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await BT(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&$r(e)||this._popupRedirectResolver;J(r,this,"argument-error"),this.redirectPersistenceManager=await wi.create(this,[$r(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)==null?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((r=this.currentUser)==null?void 0:r.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(J(c,this,"internal-error"),c.then(()=>{a||i(this.currentUser)}),typeof r=="function"){const u=e.addObserver(r,n,s);return()=>{a=!0,u()}}else{const u=e.addObserver(r);return()=>{a=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return J(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=U_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var r;if(Dt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((r=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getToken());return e!=null&&e.error&&bT(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Yn(t){return Ae(t)}class A0{constructor(e){this.auth=e,this.observer=null,this.addObserver=h2(r=>this.observer=r)}get next(){return J(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function YT(t){bu=t}function z_(t){return bu.loadJS(t)}function XT(){return bu.recaptchaEnterpriseScript}function JT(){return bu.gapiScript}function ZT(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class eI{constructor(){this.enterprise=new tI}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class tI{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const rI="recaptcha-enterprise",B_="NO_RECAPTCHA";class nI{constructor(e){this.type=rI,this.auth=Yn(e)}async verify(e="verify",r=!1){async function n(i){if(!r){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(a,c)=>{DT(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const d=new jT(u);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,a(d.siteKey)}}).catch(u=>{c(u)})})}function s(i,a,c){const u=window.grecaptcha;b0(u)?u.enterprise.ready(()=>{u.enterprise.execute(i,{action:e}).then(d=>{a(d)}).catch(()=>{a(B_)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new eI().execute("siteKey",{action:"verify"}):new Promise((i,a)=>{n(this.auth).then(c=>{if(!r&&b0(window.grecaptcha))s(c,i,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let u=XT();u.length!==0&&(u+=c),z_(u).then(()=>{s(c,i,a)}).catch(d=>{a(d)})}}).catch(c=>{a(c)})})}}async function C0(t,e,r,n=!1,s=!1){const i=new nI(t);let a;if(s)a=B_;else try{a=await i.verify(r)}catch{a=await i.verify(r,!0)}const c={...e};if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const u=c.phoneEnrollmentInfo.phoneNumber,d=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:d,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return n?Object.assign(c,{captchaResp:a}):Object.assign(c,{captchaResponse:a}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function zc(t,e,r,n,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await C0(t,e,r,r==="getOobCode");return n(t,a)}else return n(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await C0(t,e,r,r==="getOobCode");return n(t,c)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sI(t,e){const r=Eu(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),i=r.getOptions();if(Ns(i,e??{}))return s;pr(s,"already-initialized")}return r.initialize({options:e})}function iI(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map($r);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function aI(t,e,r){const n=Yn(t);J(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!!(r!=null&&r.disableWarnings),i=$_(e),{host:a,port:c}=oI(e),u=c===null?"":`:${c}`,d={url:`${i}//${a}${u}/`},f=Object.freeze({host:a,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){J(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),J(Ns(d,n.config.emulator)&&Ns(f,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=d,n.emulatorConfig=f,n.settings.appVerificationDisabledForTesting=!0,Fs(a)?(vm(`${i}//${a}${u}`),xm("Auth",!0)):lI()}function $_(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function oI(t){const e=$_(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const i=s[1];return{host:i,port:R0(n.substr(i.length+1))}}else{const[i,a]=n.split(":");return{host:i,port:R0(a)}}}function R0(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function lI(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sm{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Br("not implemented")}_getIdTokenResponse(e){return Br("not implemented")}_linkToIdToken(e,r){return Br("not implemented")}_getReauthenticationResolver(e){return Br("not implemented")}}async function cI(t,e){return jr(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uI(t,e){return jo(t,"POST","/v1/accounts:signInWithPassword",nn(t,e))}async function dI(t,e){return jr(t,"POST","/v1/accounts:sendOobCode",nn(t,e))}async function hI(t,e){return dI(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fI(t,e){return jo(t,"POST","/v1/accounts:signInWithEmailLink",nn(t,e))}async function mI(t,e){return jo(t,"POST","/v1/accounts:signInWithEmailLink",nn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mo extends Sm{constructor(e,r,n,s=null){super("password",n),this._email=e,this._password=r,this._tenantId=s}static _fromEmailAndPassword(e,r){return new mo(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new mo(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return zc(e,r,"signInWithPassword",uI);case"emailLink":return fI(e,{email:this._email,oobCode:this._password});default:pr(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return zc(e,n,"signUpPassword",cI);case"emailLink":return mI(e,{idToken:r,email:this._email,oobCode:this._password});default:pr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ki(t,e){return jo(t,"POST","/v1/accounts:signInWithIdp",nn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pI="http://localhost";class Cs extends Sm{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Cs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):pr("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,...i}=r;if(!n||!s)return null;const a=new Cs(n,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return ki(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,ki(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,ki(e,r)}buildRequest(){const e={requestUri:pI,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Ro(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gI(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function yI(t){const e=Na(Aa(t)).link,r=e?Na(Aa(e)).deep_link_id:null,n=Na(Aa(t)).deep_link_id;return(n?Na(Aa(n)).link:null)||n||r||e||t}class Nm{constructor(e){const r=Na(Aa(e)),n=r.apiKey??null,s=r.oobCode??null,i=gI(r.mode??null);J(n&&s&&i,"argument-error"),this.apiKey=n,this.operation=i,this.code=s,this.continueUrl=r.continueUrl??null,this.languageCode=r.lang??null,this.tenantId=r.tenantId??null}static parseLink(e){const r=yI(e);try{return new Nm(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi{constructor(){this.providerId=zi.PROVIDER_ID}static credential(e,r){return mo._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=Nm.parseLink(r);return J(n,"argument-error"),mo._fromEmailAndCode(e,n.code,n.tenantId)}}zi.PROVIDER_ID="password";zi.EMAIL_PASSWORD_SIGN_IN_METHOD="password";zi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do extends q_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn extends Do{constructor(){super("facebook.com")}static credential(e){return Cs._fromParams({providerId:xn.PROVIDER_ID,signInMethod:xn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xn.credentialFromTaggedObject(e)}static credentialFromError(e){return xn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xn.credential(e.oauthAccessToken)}catch{return null}}}xn.FACEBOOK_SIGN_IN_METHOD="facebook.com";xn.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n extends Do{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Cs._fromParams({providerId:_n.PROVIDER_ID,signInMethod:_n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return _n.credentialFromTaggedObject(e)}static credentialFromError(e){return _n.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return _n.credential(r,n)}catch{return null}}}_n.GOOGLE_SIGN_IN_METHOD="google.com";_n.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn extends Do{constructor(){super("github.com")}static credential(e){return Cs._fromParams({providerId:wn.PROVIDER_ID,signInMethod:wn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return wn.credentialFromTaggedObject(e)}static credentialFromError(e){return wn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return wn.credential(e.oauthAccessToken)}catch{return null}}}wn.GITHUB_SIGN_IN_METHOD="github.com";wn.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn extends Do{constructor(){super("twitter.com")}static credential(e,r){return Cs._fromParams({providerId:kn.PROVIDER_ID,signInMethod:kn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return kn.credentialFromTaggedObject(e)}static credentialFromError(e){return kn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return kn.credential(r,n)}catch{return null}}}kn.TWITTER_SIGN_IN_METHOD="twitter.com";kn.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vI(t,e){return jo(t,"POST","/v1/accounts:signUp",nn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rs{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const i=await ur._fromIdTokenResponse(e,n,s),a=P0(n);return new Rs({user:i,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=P0(n);return new Rs({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function P0(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bc extends er{constructor(e,r,n,s){super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Bc.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new Bc(e,r,n,s)}}function H_(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Bc._fromErrorAndOperation(t,i,e,n):i})}async function xI(t,e,r=!1){const n=await Ri(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Rs._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _I(t,e,r=!1){const{auth:n}=t;if(Dt(n.app))return Promise.reject(Hr(n));const s="reauthenticate";try{const i=await Ri(t,H_(n,s,e,t),r);J(i.idToken,n,"internal-error");const a=Tm(i.idToken);J(a,n,"internal-error");const{sub:c}=a;return J(t.uid===c,n,"user-mismatch"),Rs._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&pr(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W_(t,e,r=!1){if(Dt(t.app))return Promise.reject(Hr(t));const n="signIn",s=await H_(t,n,e),i=await Rs._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(i.user),i}async function wI(t,e){return W_(Yn(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K_(t){const e=Yn(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function kI(t,e,r){const n=Yn(t);await zc(n,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",hI)}async function EI(t,e,r){if(Dt(t.app))return Promise.reject(Hr(t));const n=Yn(t),a=await zc(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",vI).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&K_(t),u}),c=await Rs._fromIdTokenResponse(n,"signIn",a);return await n._updateCurrentUser(c.user),c}function bI(t,e,r){return Dt(t.app)?Promise.reject(Hr(t)):wI(Ae(t),zi.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&K_(t),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TI(t,e){return jr(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function II(t,{displayName:e,photoURL:r}){if(e===void 0&&r===void 0)return;const n=Ae(t),i={idToken:await n.getIdToken(),displayName:e,photoUrl:r,returnSecureToken:!0},a=await Ri(n,TI(n.auth,i));n.displayName=a.displayName||null,n.photoURL=a.photoUrl||null;const c=n.providerData.find(({providerId:u})=>u==="password");c&&(c.displayName=n.displayName,c.photoURL=n.photoURL),await n._updateTokensIfNecessary(a)}function SI(t,e,r,n){return Ae(t).onIdTokenChanged(e,r,n)}function NI(t,e,r){return Ae(t).beforeAuthStateChanged(e,r)}function AI(t,e,r,n){return Ae(t).onAuthStateChanged(e,r,n)}function CI(t){return Ae(t).signOut()}const $c="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G_{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem($c,"1"),this.storage.removeItem($c),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RI=1e3,PI=10;class Q_ extends G_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=F_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,c,u)=>{this.notifyListeners(a,u)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},i=this.storage.getItem(n);qT()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,PI):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},RI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}Q_.type="LOCAL";const jI=Q_;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y_ extends G_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}Y_.type="SESSION";const X_=Y_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DI(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tu{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new Tu(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:i}=r.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const c=Array.from(a).map(async d=>d(r.origin,i)),u=await DI(c);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:u})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Tu.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Am(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OI{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((c,u)=>{const d=Am("",20);s.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},n);a={messageChannel:s,onMessage(p){const g=p;if(g.data.eventId===d)switch(g.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(g.data.response);break;default:clearTimeout(f),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:r},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ir(){return window}function VI(t){Ir().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J_(){return typeof Ir().WorkerGlobalScope<"u"&&typeof Ir().importScripts=="function"}async function MI(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function LI(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function FI(){return J_()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z_="firebaseLocalStorageDb",UI=1,qc="firebaseLocalStorage",ew="fbase_key";class Oo{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Iu(t,e){return t.transaction([qc],e?"readwrite":"readonly").objectStore(qc)}function zI(){const t=indexedDB.deleteDatabase(Z_);return new Oo(t).toPromise()}function tf(){const t=indexedDB.open(Z_,UI);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(qc,{keyPath:ew})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(qc)?e(n):(n.close(),await zI(),e(await tf()))})})}async function j0(t,e,r){const n=Iu(t,!0).put({[ew]:e,value:r});return new Oo(n).toPromise()}async function BI(t,e){const r=Iu(t,!1).get(e),n=await new Oo(r).toPromise();return n===void 0?null:n.value}function D0(t,e){const r=Iu(t,!0).delete(e);return new Oo(r).toPromise()}const $I=800,qI=3;class tw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await tf(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>qI)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return J_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Tu._getInstance(FI()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var r,n;if(this.activeServiceWorker=await MI(),!this.activeServiceWorker)return;this.sender=new OI(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(r=e[0])!=null&&r.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||LI()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await tf();return await j0(e,$c,"1"),await D0(e,$c),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>j0(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>BI(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>D0(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Iu(s,!1).getAll();return new Oo(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),$I)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}tw.type="LOCAL";const HI=tw;new Po(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WI(t,e){return e?$r(e):(J(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cm extends Sm{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ki(e,this._buildIdpRequest())}_linkToIdToken(e,r){return ki(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return ki(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function KI(t){return W_(t.auth,new Cm(t),t.bypassAuthState)}function GI(t){const{auth:e,user:r}=t;return J(r,e,"internal-error"),_I(r,new Cm(t),t.bypassAuthState)}async function QI(t){const{auth:e,user:r}=t;return J(r,e,"internal-error"),xI(r,new Cm(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rw{constructor(e,r,n,s,i=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:i,error:a,type:c}=e;if(a){this.reject(a);return}const u={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return KI;case"linkViaPopup":case"linkViaRedirect":return QI;case"reauthViaPopup":case"reauthViaRedirect":return GI;default:pr(this.auth,"internal-error")}}resolve(e){Jr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Jr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YI=new Po(2e3,1e4);class fi extends rw{constructor(e,r,n,s,i){super(e,r,s,i),this.provider=n,this.authWindow=null,this.pollId=null,fi.currentPopupAction&&fi.currentPopupAction.cancel(),fi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return J(e,this.auth,"internal-error"),e}async onExecution(){Jr(this.filter.length===1,"Popup operations only handle one event");const e=Am();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Tr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Tr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,fi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if((n=(r=this.authWindow)==null?void 0:r.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Tr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,YI.get())};e()}}fi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XI="pendingRedirect",sc=new Map;class JI extends rw{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=sc.get(this.auth._key());if(!e){try{const n=await ZI(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}sc.set(this.auth._key(),e)}return this.bypassAuthState||sc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function ZI(t,e){const r=rS(e),n=tS(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function eS(t,e){sc.set(t._key(),e)}function tS(t){return $r(t._redirectPersistence)}function rS(t){return nc(XI,t.config.apiKey,t.name)}async function nS(t,e,r=!1){if(Dt(t.app))return Promise.reject(Hr(t));const n=Yn(t),s=WI(n,e),a=await new JI(n,s,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sS=10*60*1e3;class iS{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!aS(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!nw(e)){const s=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";r.onError(Tr(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=sS&&this.cachedEventUids.clear(),this.cachedEventUids.has(O0(e))}saveEventToCache(e){this.cachedEventUids.add(O0(e)),this.lastProcessedEventTime=Date.now()}}function O0(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function nw({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function aS(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return nw(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oS(t,e={}){return jr(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lS=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,cS=/^https?/;async function uS(t){if(t.config.emulator)return;const{authorizedDomains:e}=await oS(t);for(const r of e)try{if(dS(r))return}catch{}pr(t,"unauthorized-domain")}function dS(t){const e=Zh(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!cS.test(r))return!1;if(lS.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hS=new Po(3e4,6e4);function V0(){const t=Ir().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function fS(t){return new Promise((e,r)=>{var s,i,a;function n(){V0(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{V0(),r(Tr(t,"network-request-failed"))},timeout:hS.get()})}if((i=(s=Ir().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((a=Ir().gapi)!=null&&a.load)n();else{const c=ZT("iframefcb");return Ir()[c]=()=>{gapi.load?n():r(Tr(t,"network-request-failed"))},z_(`${JT()}?onload=${c}`).catch(u=>r(u))}}).catch(e=>{throw ic=null,e})}let ic=null;function mS(t){return ic=ic||fS(t),ic}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pS=new Po(5e3,15e3),gS="__/auth/iframe",yS="emulator/auth/iframe",vS={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},xS=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function _S(t){const e=t.config;J(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?bm(e,yS):`https://${t.config.authDomain}/${gS}`,n={apiKey:e.apiKey,appName:t.name,v:Us},s=xS.get(t.config.apiHost);s&&(n.eid=s);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${Ro(n).slice(1)}`}async function wS(t){const e=await mS(t),r=Ir().gapi;return J(r,t,"internal-error"),e.open({where:document.body,url:_S(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:vS,dontclear:!0},n=>new Promise(async(s,i)=>{await n.restyle({setHideOnLeave:!1});const a=Tr(t,"network-request-failed"),c=Ir().setTimeout(()=>{i(a)},pS.get());function u(){Ir().clearTimeout(c),s(n)}n.ping(u).then(u,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kS={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},ES=500,bS=600,TS="_blank",IS="http://localhost";class M0{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function SS(t,e,r,n=ES,s=bS){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const u={...kS,width:n.toString(),height:s.toString(),top:i,left:a},d=ft().toLowerCase();r&&(c=D_(d)?TS:r),P_(d)&&(e=e||IS,u.scrollbars="yes");const f=Object.entries(u).reduce((g,[w,N])=>`${g}${w}=${N},`,"");if($T(d)&&c!=="_self")return NS(e||"",c),new M0(null);const p=window.open(e||"",c,f);J(p,t,"popup-blocked");try{p.focus()}catch{}return new M0(p)}function NS(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AS="__/auth/handler",CS="emulator/auth/handler",RS=encodeURIComponent("fac");async function L0(t,e,r,n,s,i){J(t.config.authDomain,t,"auth-domain-config-required"),J(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Us,eventId:s};if(e instanceof q_){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",d2(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))a[f]=p}if(e instanceof Do){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(a.scopes=f.join(","))}t.tenantId&&(a.tid=t.tenantId);const c=a;for(const f of Object.keys(c))c[f]===void 0&&delete c[f];const u=await t._getAppCheckToken(),d=u?`#${RS}=${encodeURIComponent(u)}`:"";return`${PS(t)}?${Ro(c).slice(1)}${d}`}function PS({config:t}){return t.emulator?bm(t,CS):`https://${t.authDomain}/${AS}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hd="webStorageSupport";class jS{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=X_,this._completeRedirectFn=nS,this._overrideRedirectResult=eS}async _openPopup(e,r,n,s){var a;Jr((a=this.eventManagers[e._key()])==null?void 0:a.manager,"_initialize() not called before _openPopup()");const i=await L0(e,r,n,Zh(),s);return SS(e,i,Am())}async _openRedirect(e,r,n,s){await this._originValidation(e);const i=await L0(e,r,n,Zh(),s);return VI(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:i}=this.eventManagers[r];return s?Promise.resolve(s):(Jr(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await wS(e),n=new iS(e);return r.register("authEvent",s=>(J(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Hd,{type:Hd},s=>{var a;const i=(a=s==null?void 0:s[0])==null?void 0:a[Hd];i!==void 0&&r(!!i),pr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=uS(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return F_()||j_()||Im()}}const DS=jS;var F0="@firebase/auth",U0="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OS{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){J(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VS(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function MS(t){As(new Un("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=n.options;J(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const u={apiKey:a,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:U_(t)},d=new QT(n,s,i,u);return iI(d,r),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),As(new Un("auth-internal",e=>{const r=Yn(e.getProvider("auth").getImmediate());return(n=>new OS(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),br(F0,U0,VS(t)),br(F0,U0,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LS=5*60,FS=y_("authIdTokenMaxAge")||LS;let z0=null;const US=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>FS)return;const s=r==null?void 0:r.token;z0!==s&&(z0=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function zS(t=km()){const e=Eu(t,"auth");if(e.isInitialized())return e.getImmediate();const r=sI(t,{popupRedirectResolver:DS,persistence:[HI,jI,X_]}),n=y_("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const a=US(i.toString());NI(r,a,()=>a(r.currentUser)),SI(r,c=>a(c))}}const s=m_("auth");return s&&aI(r,`http://${s}`),r}function BS(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}YT({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const i=Tr("internal-error");i.customData=s,r(i)},n.type="text/javascript",n.charset="UTF-8",BS().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});MS("Browser");var $S="firebase",qS="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */br($S,qS,"app");var B0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Vn,sw;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(v,y){function E(){}E.prototype=y.prototype,v.D=y.prototype,v.prototype=new E,v.prototype.constructor=v,v.C=function(b,A,R){for(var I=Array(arguments.length-2),mt=2;mt<arguments.length;mt++)I[mt-2]=arguments[mt];return y.prototype[A].apply(b,I)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(v,y,E){E||(E=0);var b=Array(16);if(typeof y=="string")for(var A=0;16>A;++A)b[A]=y.charCodeAt(E++)|y.charCodeAt(E++)<<8|y.charCodeAt(E++)<<16|y.charCodeAt(E++)<<24;else for(A=0;16>A;++A)b[A]=y[E++]|y[E++]<<8|y[E++]<<16|y[E++]<<24;y=v.g[0],E=v.g[1],A=v.g[2];var R=v.g[3],I=y+(R^E&(A^R))+b[0]+3614090360&4294967295;y=E+(I<<7&4294967295|I>>>25),I=R+(A^y&(E^A))+b[1]+3905402710&4294967295,R=y+(I<<12&4294967295|I>>>20),I=A+(E^R&(y^E))+b[2]+606105819&4294967295,A=R+(I<<17&4294967295|I>>>15),I=E+(y^A&(R^y))+b[3]+3250441966&4294967295,E=A+(I<<22&4294967295|I>>>10),I=y+(R^E&(A^R))+b[4]+4118548399&4294967295,y=E+(I<<7&4294967295|I>>>25),I=R+(A^y&(E^A))+b[5]+1200080426&4294967295,R=y+(I<<12&4294967295|I>>>20),I=A+(E^R&(y^E))+b[6]+2821735955&4294967295,A=R+(I<<17&4294967295|I>>>15),I=E+(y^A&(R^y))+b[7]+4249261313&4294967295,E=A+(I<<22&4294967295|I>>>10),I=y+(R^E&(A^R))+b[8]+1770035416&4294967295,y=E+(I<<7&4294967295|I>>>25),I=R+(A^y&(E^A))+b[9]+2336552879&4294967295,R=y+(I<<12&4294967295|I>>>20),I=A+(E^R&(y^E))+b[10]+4294925233&4294967295,A=R+(I<<17&4294967295|I>>>15),I=E+(y^A&(R^y))+b[11]+2304563134&4294967295,E=A+(I<<22&4294967295|I>>>10),I=y+(R^E&(A^R))+b[12]+1804603682&4294967295,y=E+(I<<7&4294967295|I>>>25),I=R+(A^y&(E^A))+b[13]+4254626195&4294967295,R=y+(I<<12&4294967295|I>>>20),I=A+(E^R&(y^E))+b[14]+2792965006&4294967295,A=R+(I<<17&4294967295|I>>>15),I=E+(y^A&(R^y))+b[15]+1236535329&4294967295,E=A+(I<<22&4294967295|I>>>10),I=y+(A^R&(E^A))+b[1]+4129170786&4294967295,y=E+(I<<5&4294967295|I>>>27),I=R+(E^A&(y^E))+b[6]+3225465664&4294967295,R=y+(I<<9&4294967295|I>>>23),I=A+(y^E&(R^y))+b[11]+643717713&4294967295,A=R+(I<<14&4294967295|I>>>18),I=E+(R^y&(A^R))+b[0]+3921069994&4294967295,E=A+(I<<20&4294967295|I>>>12),I=y+(A^R&(E^A))+b[5]+3593408605&4294967295,y=E+(I<<5&4294967295|I>>>27),I=R+(E^A&(y^E))+b[10]+38016083&4294967295,R=y+(I<<9&4294967295|I>>>23),I=A+(y^E&(R^y))+b[15]+3634488961&4294967295,A=R+(I<<14&4294967295|I>>>18),I=E+(R^y&(A^R))+b[4]+3889429448&4294967295,E=A+(I<<20&4294967295|I>>>12),I=y+(A^R&(E^A))+b[9]+568446438&4294967295,y=E+(I<<5&4294967295|I>>>27),I=R+(E^A&(y^E))+b[14]+3275163606&4294967295,R=y+(I<<9&4294967295|I>>>23),I=A+(y^E&(R^y))+b[3]+4107603335&4294967295,A=R+(I<<14&4294967295|I>>>18),I=E+(R^y&(A^R))+b[8]+1163531501&4294967295,E=A+(I<<20&4294967295|I>>>12),I=y+(A^R&(E^A))+b[13]+2850285829&4294967295,y=E+(I<<5&4294967295|I>>>27),I=R+(E^A&(y^E))+b[2]+4243563512&4294967295,R=y+(I<<9&4294967295|I>>>23),I=A+(y^E&(R^y))+b[7]+1735328473&4294967295,A=R+(I<<14&4294967295|I>>>18),I=E+(R^y&(A^R))+b[12]+2368359562&4294967295,E=A+(I<<20&4294967295|I>>>12),I=y+(E^A^R)+b[5]+4294588738&4294967295,y=E+(I<<4&4294967295|I>>>28),I=R+(y^E^A)+b[8]+2272392833&4294967295,R=y+(I<<11&4294967295|I>>>21),I=A+(R^y^E)+b[11]+1839030562&4294967295,A=R+(I<<16&4294967295|I>>>16),I=E+(A^R^y)+b[14]+4259657740&4294967295,E=A+(I<<23&4294967295|I>>>9),I=y+(E^A^R)+b[1]+2763975236&4294967295,y=E+(I<<4&4294967295|I>>>28),I=R+(y^E^A)+b[4]+1272893353&4294967295,R=y+(I<<11&4294967295|I>>>21),I=A+(R^y^E)+b[7]+4139469664&4294967295,A=R+(I<<16&4294967295|I>>>16),I=E+(A^R^y)+b[10]+3200236656&4294967295,E=A+(I<<23&4294967295|I>>>9),I=y+(E^A^R)+b[13]+681279174&4294967295,y=E+(I<<4&4294967295|I>>>28),I=R+(y^E^A)+b[0]+3936430074&4294967295,R=y+(I<<11&4294967295|I>>>21),I=A+(R^y^E)+b[3]+3572445317&4294967295,A=R+(I<<16&4294967295|I>>>16),I=E+(A^R^y)+b[6]+76029189&4294967295,E=A+(I<<23&4294967295|I>>>9),I=y+(E^A^R)+b[9]+3654602809&4294967295,y=E+(I<<4&4294967295|I>>>28),I=R+(y^E^A)+b[12]+3873151461&4294967295,R=y+(I<<11&4294967295|I>>>21),I=A+(R^y^E)+b[15]+530742520&4294967295,A=R+(I<<16&4294967295|I>>>16),I=E+(A^R^y)+b[2]+3299628645&4294967295,E=A+(I<<23&4294967295|I>>>9),I=y+(A^(E|~R))+b[0]+4096336452&4294967295,y=E+(I<<6&4294967295|I>>>26),I=R+(E^(y|~A))+b[7]+1126891415&4294967295,R=y+(I<<10&4294967295|I>>>22),I=A+(y^(R|~E))+b[14]+2878612391&4294967295,A=R+(I<<15&4294967295|I>>>17),I=E+(R^(A|~y))+b[5]+4237533241&4294967295,E=A+(I<<21&4294967295|I>>>11),I=y+(A^(E|~R))+b[12]+1700485571&4294967295,y=E+(I<<6&4294967295|I>>>26),I=R+(E^(y|~A))+b[3]+2399980690&4294967295,R=y+(I<<10&4294967295|I>>>22),I=A+(y^(R|~E))+b[10]+4293915773&4294967295,A=R+(I<<15&4294967295|I>>>17),I=E+(R^(A|~y))+b[1]+2240044497&4294967295,E=A+(I<<21&4294967295|I>>>11),I=y+(A^(E|~R))+b[8]+1873313359&4294967295,y=E+(I<<6&4294967295|I>>>26),I=R+(E^(y|~A))+b[15]+4264355552&4294967295,R=y+(I<<10&4294967295|I>>>22),I=A+(y^(R|~E))+b[6]+2734768916&4294967295,A=R+(I<<15&4294967295|I>>>17),I=E+(R^(A|~y))+b[13]+1309151649&4294967295,E=A+(I<<21&4294967295|I>>>11),I=y+(A^(E|~R))+b[4]+4149444226&4294967295,y=E+(I<<6&4294967295|I>>>26),I=R+(E^(y|~A))+b[11]+3174756917&4294967295,R=y+(I<<10&4294967295|I>>>22),I=A+(y^(R|~E))+b[2]+718787259&4294967295,A=R+(I<<15&4294967295|I>>>17),I=E+(R^(A|~y))+b[9]+3951481745&4294967295,v.g[0]=v.g[0]+y&4294967295,v.g[1]=v.g[1]+(A+(I<<21&4294967295|I>>>11))&4294967295,v.g[2]=v.g[2]+A&4294967295,v.g[3]=v.g[3]+R&4294967295}n.prototype.u=function(v,y){y===void 0&&(y=v.length);for(var E=y-this.blockSize,b=this.B,A=this.h,R=0;R<y;){if(A==0)for(;R<=E;)s(this,v,R),R+=this.blockSize;if(typeof v=="string"){for(;R<y;)if(b[A++]=v.charCodeAt(R++),A==this.blockSize){s(this,b),A=0;break}}else for(;R<y;)if(b[A++]=v[R++],A==this.blockSize){s(this,b),A=0;break}}this.h=A,this.o+=y},n.prototype.v=function(){var v=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);v[0]=128;for(var y=1;y<v.length-8;++y)v[y]=0;var E=8*this.o;for(y=v.length-8;y<v.length;++y)v[y]=E&255,E/=256;for(this.u(v),v=Array(16),y=E=0;4>y;++y)for(var b=0;32>b;b+=8)v[E++]=this.g[y]>>>b&255;return v};function i(v,y){var E=c;return Object.prototype.hasOwnProperty.call(E,v)?E[v]:E[v]=y(v)}function a(v,y){this.h=y;for(var E=[],b=!0,A=v.length-1;0<=A;A--){var R=v[A]|0;b&&R==y||(E[A]=R,b=!1)}this.g=E}var c={};function u(v){return-128<=v&&128>v?i(v,function(y){return new a([y|0],0>y?-1:0)}):new a([v|0],0>v?-1:0)}function d(v){if(isNaN(v)||!isFinite(v))return p;if(0>v)return C(d(-v));for(var y=[],E=1,b=0;v>=E;b++)y[b]=v/E|0,E*=4294967296;return new a(y,0)}function f(v,y){if(v.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(v.charAt(0)=="-")return C(f(v.substring(1),y));if(0<=v.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=d(Math.pow(y,8)),b=p,A=0;A<v.length;A+=8){var R=Math.min(8,v.length-A),I=parseInt(v.substring(A,A+R),y);8>R?(R=d(Math.pow(y,R)),b=b.j(R).add(d(I))):(b=b.j(E),b=b.add(d(I)))}return b}var p=u(0),g=u(1),w=u(16777216);t=a.prototype,t.m=function(){if(S(this))return-C(this).m();for(var v=0,y=1,E=0;E<this.g.length;E++){var b=this.i(E);v+=(0<=b?b:4294967296+b)*y,y*=4294967296}return v},t.toString=function(v){if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(N(this))return"0";if(S(this))return"-"+C(this).toString(v);for(var y=d(Math.pow(v,6)),E=this,b="";;){var A=j(E,y).g;E=T(E,A.j(y));var R=((0<E.g.length?E.g[0]:E.h)>>>0).toString(v);if(E=A,N(E))return R+b;for(;6>R.length;)R="0"+R;b=R+b}},t.i=function(v){return 0>v?0:v<this.g.length?this.g[v]:this.h};function N(v){if(v.h!=0)return!1;for(var y=0;y<v.g.length;y++)if(v.g[y]!=0)return!1;return!0}function S(v){return v.h==-1}t.l=function(v){return v=T(this,v),S(v)?-1:N(v)?0:1};function C(v){for(var y=v.g.length,E=[],b=0;b<y;b++)E[b]=~v.g[b];return new a(E,~v.h).add(g)}t.abs=function(){return S(this)?C(this):this},t.add=function(v){for(var y=Math.max(this.g.length,v.g.length),E=[],b=0,A=0;A<=y;A++){var R=b+(this.i(A)&65535)+(v.i(A)&65535),I=(R>>>16)+(this.i(A)>>>16)+(v.i(A)>>>16);b=I>>>16,R&=65535,I&=65535,E[A]=I<<16|R}return new a(E,E[E.length-1]&-2147483648?-1:0)};function T(v,y){return v.add(C(y))}t.j=function(v){if(N(this)||N(v))return p;if(S(this))return S(v)?C(this).j(C(v)):C(C(this).j(v));if(S(v))return C(this.j(C(v)));if(0>this.l(w)&&0>v.l(w))return d(this.m()*v.m());for(var y=this.g.length+v.g.length,E=[],b=0;b<2*y;b++)E[b]=0;for(b=0;b<this.g.length;b++)for(var A=0;A<v.g.length;A++){var R=this.i(b)>>>16,I=this.i(b)&65535,mt=v.i(A)>>>16,nr=v.i(A)&65535;E[2*b+2*A]+=I*nr,_(E,2*b+2*A),E[2*b+2*A+1]+=R*nr,_(E,2*b+2*A+1),E[2*b+2*A+1]+=I*mt,_(E,2*b+2*A+1),E[2*b+2*A+2]+=R*mt,_(E,2*b+2*A+2)}for(b=0;b<y;b++)E[b]=E[2*b+1]<<16|E[2*b];for(b=y;b<2*y;b++)E[b]=0;return new a(E,0)};function _(v,y){for(;(v[y]&65535)!=v[y];)v[y+1]+=v[y]>>>16,v[y]&=65535,y++}function k(v,y){this.g=v,this.h=y}function j(v,y){if(N(y))throw Error("division by zero");if(N(v))return new k(p,p);if(S(v))return y=j(C(v),y),new k(C(y.g),C(y.h));if(S(y))return y=j(v,C(y)),new k(C(y.g),y.h);if(30<v.g.length){if(S(v)||S(y))throw Error("slowDivide_ only works with positive integers.");for(var E=g,b=y;0>=b.l(v);)E=F(E),b=F(b);var A=D(E,1),R=D(b,1);for(b=D(b,2),E=D(E,2);!N(b);){var I=R.add(b);0>=I.l(v)&&(A=A.add(E),R=I),b=D(b,1),E=D(E,1)}return y=T(v,A.j(y)),new k(A,y)}for(A=p;0<=v.l(y);){for(E=Math.max(1,Math.floor(v.m()/y.m())),b=Math.ceil(Math.log(E)/Math.LN2),b=48>=b?1:Math.pow(2,b-48),R=d(E),I=R.j(y);S(I)||0<I.l(v);)E-=b,R=d(E),I=R.j(y);N(R)&&(R=g),A=A.add(R),v=T(v,I)}return new k(A,v)}t.A=function(v){return j(this,v).h},t.and=function(v){for(var y=Math.max(this.g.length,v.g.length),E=[],b=0;b<y;b++)E[b]=this.i(b)&v.i(b);return new a(E,this.h&v.h)},t.or=function(v){for(var y=Math.max(this.g.length,v.g.length),E=[],b=0;b<y;b++)E[b]=this.i(b)|v.i(b);return new a(E,this.h|v.h)},t.xor=function(v){for(var y=Math.max(this.g.length,v.g.length),E=[],b=0;b<y;b++)E[b]=this.i(b)^v.i(b);return new a(E,this.h^v.h)};function F(v){for(var y=v.g.length+1,E=[],b=0;b<y;b++)E[b]=v.i(b)<<1|v.i(b-1)>>>31;return new a(E,v.h)}function D(v,y){var E=y>>5;y%=32;for(var b=v.g.length-E,A=[],R=0;R<b;R++)A[R]=0<y?v.i(R+E)>>>y|v.i(R+E+1)<<32-y:v.i(R+E);return new a(A,v.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,sw=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=f,Vn=a}).apply(typeof B0<"u"?B0:typeof self<"u"?self:typeof window<"u"?window:{});var Ml=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var iw,Ca,aw,ac,rf,ow,lw,cw;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,h,m){return o==Array.prototype||o==Object.prototype||(o[h]=m.value),o};function r(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ml=="object"&&Ml];for(var h=0;h<o.length;++h){var m=o[h];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var n=r(this);function s(o,h){if(h)e:{var m=n;o=o.split(".");for(var x=0;x<o.length-1;x++){var P=o[x];if(!(P in m))break e;m=m[P]}o=o[o.length-1],x=m[o],h=h(x),h!=x&&h!=null&&e(m,o,{configurable:!0,writable:!0,value:h})}}function i(o,h){o instanceof String&&(o+="");var m=0,x=!1,P={next:function(){if(!x&&m<o.length){var O=m++;return{value:h(O,o[O]),done:!1}}return x=!0,{done:!0,value:void 0}}};return P[Symbol.iterator]=function(){return P},P}s("Array.prototype.values",function(o){return o||function(){return i(this,function(h,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},c=this||self;function u(o){var h=typeof o;return h=h!="object"?h:o?Array.isArray(o)?"array":h:"null",h=="array"||h=="object"&&typeof o.length=="number"}function d(o){var h=typeof o;return h=="object"&&o!=null||h=="function"}function f(o,h,m){return o.call.apply(o.bind,arguments)}function p(o,h,m){if(!o)throw Error();if(2<arguments.length){var x=Array.prototype.slice.call(arguments,2);return function(){var P=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(P,x),o.apply(h,P)}}return function(){return o.apply(h,arguments)}}function g(o,h,m){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,g.apply(null,arguments)}function w(o,h){var m=Array.prototype.slice.call(arguments,1);return function(){var x=m.slice();return x.push.apply(x,arguments),o.apply(this,x)}}function N(o,h){function m(){}m.prototype=h.prototype,o.aa=h.prototype,o.prototype=new m,o.prototype.constructor=o,o.Qb=function(x,P,O){for(var B=Array(arguments.length-2),ge=2;ge<arguments.length;ge++)B[ge-2]=arguments[ge];return h.prototype[P].apply(x,B)}}function S(o){const h=o.length;if(0<h){const m=Array(h);for(let x=0;x<h;x++)m[x]=o[x];return m}return[]}function C(o,h){for(let m=1;m<arguments.length;m++){const x=arguments[m];if(u(x)){const P=o.length||0,O=x.length||0;o.length=P+O;for(let B=0;B<O;B++)o[P+B]=x[B]}else o.push(x)}}class T{constructor(h,m){this.i=h,this.j=m,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function _(o){return/^[\s\xa0]*$/.test(o)}function k(){var o=c.navigator;return o&&(o=o.userAgent)?o:""}function j(o){return j[" "](o),o}j[" "]=function(){};var F=k().indexOf("Gecko")!=-1&&!(k().toLowerCase().indexOf("webkit")!=-1&&k().indexOf("Edge")==-1)&&!(k().indexOf("Trident")!=-1||k().indexOf("MSIE")!=-1)&&k().indexOf("Edge")==-1;function D(o,h,m){for(const x in o)h.call(m,o[x],x,o)}function v(o,h){for(const m in o)h.call(void 0,o[m],m,o)}function y(o){const h={};for(const m in o)h[m]=o[m];return h}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(o,h){let m,x;for(let P=1;P<arguments.length;P++){x=arguments[P];for(m in x)o[m]=x[m];for(let O=0;O<E.length;O++)m=E[O],Object.prototype.hasOwnProperty.call(x,m)&&(o[m]=x[m])}}function A(o){var h=1;o=o.split(":");const m=[];for(;0<h&&o.length;)m.push(o.shift()),h--;return o.length&&m.push(o.join(":")),m}function R(o){c.setTimeout(()=>{throw o},0)}function I(){var o=z;let h=null;return o.g&&(h=o.g,o.g=o.g.next,o.g||(o.h=null),h.next=null),h}class mt{constructor(){this.h=this.g=null}add(h,m){const x=nr.get();x.set(h,m),this.h?this.h.next=x:this.g=x,this.h=x}}var nr=new T(()=>new sn,o=>o.reset());class sn{constructor(){this.next=this.g=this.h=null}set(h,m){this.h=h,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let Rt,W=!1,z=new mt,q=()=>{const o=c.Promise.resolve(void 0);Rt=()=>{o.then(re)}};var re=()=>{for(var o;o=I();){try{o.h.call(o.g)}catch(m){R(m)}var h=nr;h.j(o),100>h.h&&(h.h++,o.next=h.g,h.g=o)}W=!1};function ue(){this.s=this.s,this.C=this.C}ue.prototype.s=!1,ue.prototype.ma=function(){this.s||(this.s=!0,this.N())},ue.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function pe(o,h){this.type=o,this.g=this.target=h,this.defaultPrevented=!1}pe.prototype.h=function(){this.defaultPrevented=!0};var pt=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var o=!1,h=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const m=()=>{};c.addEventListener("test",m,h),c.removeEventListener("test",m,h)}catch{}return o}();function Ge(o,h){if(pe.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var m=this.type=o.type,x=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=h,h=o.relatedTarget){if(F){e:{try{j(h.nodeName);var P=!0;break e}catch{}P=!1}P||(h=null)}}else m=="mouseover"?h=o.fromElement:m=="mouseout"&&(h=o.toElement);this.relatedTarget=h,x?(this.clientX=x.clientX!==void 0?x.clientX:x.pageX,this.clientY=x.clientY!==void 0?x.clientY:x.pageY,this.screenX=x.screenX||0,this.screenY=x.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:sr[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&Ge.aa.h.call(this)}}N(Ge,pe);var sr={2:"touch",3:"pen",4:"mouse"};Ge.prototype.h=function(){Ge.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var $t="closure_listenable_"+(1e6*Math.random()|0),Xu=0;function Go(o,h,m,x,P){this.listener=o,this.proxy=null,this.src=h,this.type=m,this.capture=!!x,this.ha=P,this.key=++Xu,this.da=this.fa=!1}function $s(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function es(o){this.src=o,this.g={},this.h=0}es.prototype.add=function(o,h,m,x,P){var O=o.toString();o=this.g[O],o||(o=this.g[O]=[],this.h++);var B=an(o,h,x,P);return-1<B?(h=o[B],m||(h.fa=!1)):(h=new Go(h,this.src,O,!!x,P),h.fa=m,o.push(h)),h};function yr(o,h){var m=h.type;if(m in o.g){var x=o.g[m],P=Array.prototype.indexOf.call(x,h,void 0),O;(O=0<=P)&&Array.prototype.splice.call(x,P,1),O&&($s(h),o.g[m].length==0&&(delete o.g[m],o.h--))}}function an(o,h,m,x){for(var P=0;P<o.length;++P){var O=o[P];if(!O.da&&O.listener==h&&O.capture==!!m&&O.ha==x)return P}return-1}var ts="closure_lm_"+(1e6*Math.random()|0),Yi={};function on(o,h,m,x,P){if(Array.isArray(h)){for(var O=0;O<h.length;O++)on(o,h[O],m,x,P);return null}return m=qt(m),o&&o[$t]?o.K(h,m,d(x)?!!x.capture:!!x,P):Xi(o,h,m,!1,x,P)}function Xi(o,h,m,x,P,O){if(!h)throw Error("Invalid event type");var B=d(P)?!!P.capture:!!P,ge=Zi(o);if(ge||(o[ts]=ge=new es(o)),m=ge.add(h,m,x,B,O),m.proxy)return m;if(x=Ji(),m.proxy=x,x.src=o,x.listener=m,o.addEventListener)pt||(P=B),P===void 0&&(P=!1),o.addEventListener(h.toString(),x,P);else if(o.attachEvent)o.attachEvent(Yo(h.toString()),x);else if(o.addListener&&o.removeListener)o.addListener(x);else throw Error("addEventListener and attachEvent are unavailable.");return m}function Ji(){function o(m){return h.call(o.src,o.listener,m)}const h=Xo;return o}function Qo(o,h,m,x,P){if(Array.isArray(h))for(var O=0;O<h.length;O++)Qo(o,h[O],m,x,P);else x=d(x)?!!x.capture:!!x,m=qt(m),o&&o[$t]?(o=o.i,h=String(h).toString(),h in o.g&&(O=o.g[h],m=an(O,m,x,P),-1<m&&($s(O[m]),Array.prototype.splice.call(O,m,1),O.length==0&&(delete o.g[h],o.h--)))):o&&(o=Zi(o))&&(h=o.g[h.toString()],o=-1,h&&(o=an(h,m,x,P)),(m=-1<o?h[o]:null)&&rs(m))}function rs(o){if(typeof o!="number"&&o&&!o.da){var h=o.src;if(h&&h[$t])yr(h.i,o);else{var m=o.type,x=o.proxy;h.removeEventListener?h.removeEventListener(m,x,o.capture):h.detachEvent?h.detachEvent(Yo(m),x):h.addListener&&h.removeListener&&h.removeListener(x),(m=Zi(h))?(yr(m,o),m.h==0&&(m.src=null,h[ts]=null)):$s(o)}}}function Yo(o){return o in Yi?Yi[o]:Yi[o]="on"+o}function Xo(o,h){if(o.da)o=!0;else{h=new Ge(h,this);var m=o.listener,x=o.ha||o.src;o.fa&&rs(o),o=m.call(x,h)}return o}function Zi(o){return o=o[ts],o instanceof es?o:null}var gt="__closure_events_fn_"+(1e9*Math.random()>>>0);function qt(o){return typeof o=="function"?o:(o[gt]||(o[gt]=function(h){return o.handleEvent(h)}),o[gt])}function je(){ue.call(this),this.i=new es(this),this.M=this,this.F=null}N(je,ue),je.prototype[$t]=!0,je.prototype.removeEventListener=function(o,h,m,x){Qo(this,o,h,m,x)};function Qe(o,h){var m,x=o.F;if(x)for(m=[];x;x=x.F)m.push(x);if(o=o.M,x=h.type||h,typeof h=="string")h=new pe(h,o);else if(h instanceof pe)h.target=h.target||o;else{var P=h;h=new pe(x,o),b(h,P)}if(P=!0,m)for(var O=m.length-1;0<=O;O--){var B=h.g=m[O];P=qs(B,x,!0,h)&&P}if(B=h.g=o,P=qs(B,x,!0,h)&&P,P=qs(B,x,!1,h)&&P,m)for(O=0;O<m.length;O++)B=h.g=m[O],P=qs(B,x,!1,h)&&P}je.prototype.N=function(){if(je.aa.N.call(this),this.i){var o=this.i,h;for(h in o.g){for(var m=o.g[h],x=0;x<m.length;x++)$s(m[x]);delete o.g[h],o.h--}}this.F=null},je.prototype.K=function(o,h,m,x){return this.i.add(String(o),h,!1,m,x)},je.prototype.L=function(o,h,m,x){return this.i.add(String(o),h,!0,m,x)};function qs(o,h,m,x){if(h=o.i.g[String(h)],!h)return!0;h=h.concat();for(var P=!0,O=0;O<h.length;++O){var B=h[O];if(B&&!B.da&&B.capture==m){var ge=B.listener,Xe=B.ha||B.src;B.fa&&yr(o.i,B),P=ge.call(Xe,x)!==!1&&P}}return P&&!x.defaultPrevented}function ea(o,h,m){if(typeof o=="function")m&&(o=g(o,m));else if(o&&typeof o.handleEvent=="function")o=g(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:c.setTimeout(o,h||0)}function Jo(o){o.g=ea(()=>{o.g=null,o.i&&(o.i=!1,Jo(o))},o.l);const h=o.h;o.h=null,o.m.apply(null,h)}class Zo extends ue{constructor(h,m){super(),this.m=h,this.l=m,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Jo(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ln(o){ue.call(this),this.h=o,this.g={}}N(ln,ue);var ns=[];function el(o){D(o.g,function(h,m){this.g.hasOwnProperty(m)&&rs(h)},o),o.g={}}ln.prototype.N=function(){ln.aa.N.call(this),el(this)},ln.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Hs=c.JSON.stringify,Ju=c.JSON.parse,Zu=class{stringify(o){return c.JSON.stringify(o,void 0)}parse(o){return c.JSON.parse(o,void 0)}};function ta(){}ta.prototype.h=null;function ra(o){return o.h||(o.h=o.i())}function tl(){}var ss={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function na(){pe.call(this,"d")}N(na,pe);function sa(){pe.call(this,"c")}N(sa,pe);var Or={},rl=null;function Ws(){return rl=rl||new je}Or.La="serverreachability";function nl(o){pe.call(this,Or.La,o)}N(nl,pe);function is(o){const h=Ws();Qe(h,new nl(h))}Or.STAT_EVENT="statevent";function sl(o,h){pe.call(this,Or.STAT_EVENT,o),this.stat=h}N(sl,pe);function Ye(o){const h=Ws();Qe(h,new sl(h,o))}Or.Ma="timingevent";function il(o,h){pe.call(this,Or.Ma,o),this.size=h}N(il,pe);function as(o,h){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){o()},h)}function os(){this.g=!0}os.prototype.xa=function(){this.g=!1};function ed(o,h,m,x,P,O){o.info(function(){if(o.g)if(O)for(var B="",ge=O.split("&"),Xe=0;Xe<ge.length;Xe++){var he=ge[Xe].split("=");if(1<he.length){var st=he[0];he=he[1];var it=st.split("_");B=2<=it.length&&it[1]=="type"?B+(st+"="+he+"&"):B+(st+"=redacted&")}}else B=null;else B=O;return"XMLHTTP REQ ("+x+") [attempt "+P+"]: "+h+`
`+m+`
`+B})}function $(o,h,m,x,P,O,B){o.info(function(){return"XMLHTTP RESP ("+x+") [ attempt "+P+"]: "+h+`
`+m+`
`+O+" "+B})}function Y(o,h,m,x){o.info(function(){return"XMLHTTP TEXT ("+h+"): "+ls(o,m)+(x?" "+x:"")})}function Ht(o,h){o.info(function(){return"TIMEOUT: "+h})}os.prototype.info=function(){};function ls(o,h){if(!o.g)return h;if(!h)return null;try{var m=JSON.parse(h);if(m){for(o=0;o<m.length;o++)if(Array.isArray(m[o])){var x=m[o];if(!(2>x.length)){var P=x[1];if(Array.isArray(P)&&!(1>P.length)){var O=P[0];if(O!="noop"&&O!="stop"&&O!="close")for(var B=1;B<P.length;B++)P[B]=""}}}}return Hs(m)}catch{return h}}var cn={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},vp={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},td;function al(){}N(al,ta),al.prototype.g=function(){return new XMLHttpRequest},al.prototype.i=function(){return{}},td=new al;function un(o,h,m,x){this.j=o,this.i=h,this.l=m,this.R=x||1,this.U=new ln(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new xp}function xp(){this.i=null,this.g="",this.h=!1}var _p={},rd={};function nd(o,h,m){o.L=1,o.v=ul(Vr(h)),o.m=m,o.P=!0,wp(o,null)}function wp(o,h){o.F=Date.now(),ol(o),o.A=Vr(o.v);var m=o.A,x=o.R;Array.isArray(x)||(x=[String(x)]),Op(m.i,"t",x),o.C=0,m=o.j.J,o.h=new xp,o.g=Zp(o.j,m?h:null,!o.m),0<o.O&&(o.M=new Zo(g(o.Y,o,o.g),o.O)),h=o.U,m=o.g,x=o.ca;var P="readystatechange";Array.isArray(P)||(P&&(ns[0]=P.toString()),P=ns);for(var O=0;O<P.length;O++){var B=on(m,P[O],x||h.handleEvent,!1,h.h||h);if(!B)break;h.g[B.key]=B}h=o.H?y(o.H):{},o.m?(o.u||(o.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,h)):(o.u="GET",o.g.ea(o.A,o.u,null,h)),is(),ed(o.i,o.u,o.A,o.l,o.R,o.m)}un.prototype.ca=function(o){o=o.target;const h=this.M;h&&Mr(o)==3?h.j():this.Y(o)},un.prototype.Y=function(o){try{if(o==this.g)e:{const it=Mr(this.g);var h=this.g.Ba();const Qs=this.g.Z();if(!(3>it)&&(it!=3||this.g&&(this.h.h||this.g.oa()||Bp(this.g)))){this.J||it!=4||h==7||(h==8||0>=Qs?is(3):is(2)),sd(this);var m=this.g.Z();this.X=m;t:if(kp(this)){var x=Bp(this.g);o="";var P=x.length,O=Mr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){cs(this),ia(this);var B="";break t}this.h.i=new c.TextDecoder}for(h=0;h<P;h++)this.h.h=!0,o+=this.h.i.decode(x[h],{stream:!(O&&h==P-1)});x.length=0,this.h.g+=o,this.C=0,B=this.h.g}else B=this.g.oa();if(this.o=m==200,$(this.i,this.u,this.A,this.l,this.R,it,m),this.o){if(this.T&&!this.K){t:{if(this.g){var ge,Xe=this.g;if((ge=Xe.g?Xe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(ge)){var he=ge;break t}}he=null}if(m=he)Y(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,id(this,m);else{this.o=!1,this.s=3,Ye(12),cs(this),ia(this);break e}}if(this.P){m=!0;let ir;for(;!this.J&&this.C<B.length;)if(ir=G1(this,B),ir==rd){it==4&&(this.s=4,Ye(14),m=!1),Y(this.i,this.l,null,"[Incomplete Response]");break}else if(ir==_p){this.s=4,Ye(15),Y(this.i,this.l,B,"[Invalid Chunk]"),m=!1;break}else Y(this.i,this.l,ir,null),id(this,ir);if(kp(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),it!=4||B.length!=0||this.h.h||(this.s=1,Ye(16),m=!1),this.o=this.o&&m,!m)Y(this.i,this.l,B,"[Invalid Chunked Response]"),cs(this),ia(this);else if(0<B.length&&!this.W){this.W=!0;var st=this.j;st.g==this&&st.ba&&!st.M&&(st.j.info("Great, no buffering proxy detected. Bytes received: "+B.length),dd(st),st.M=!0,Ye(11))}}else Y(this.i,this.l,B,null),id(this,B);it==4&&cs(this),this.o&&!this.J&&(it==4?Qp(this.j,this):(this.o=!1,ol(this)))}else dk(this.g),m==400&&0<B.indexOf("Unknown SID")?(this.s=3,Ye(12)):(this.s=0,Ye(13)),cs(this),ia(this)}}}catch{}finally{}};function kp(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function G1(o,h){var m=o.C,x=h.indexOf(`
`,m);return x==-1?rd:(m=Number(h.substring(m,x)),isNaN(m)?_p:(x+=1,x+m>h.length?rd:(h=h.slice(x,x+m),o.C=x+m,h)))}un.prototype.cancel=function(){this.J=!0,cs(this)};function ol(o){o.S=Date.now()+o.I,Ep(o,o.I)}function Ep(o,h){if(o.B!=null)throw Error("WatchDog timer not null");o.B=as(g(o.ba,o),h)}function sd(o){o.B&&(c.clearTimeout(o.B),o.B=null)}un.prototype.ba=function(){this.B=null;const o=Date.now();0<=o-this.S?(Ht(this.i,this.A),this.L!=2&&(is(),Ye(17)),cs(this),this.s=2,ia(this)):Ep(this,this.S-o)};function ia(o){o.j.G==0||o.J||Qp(o.j,o)}function cs(o){sd(o);var h=o.M;h&&typeof h.ma=="function"&&h.ma(),o.M=null,el(o.U),o.g&&(h=o.g,o.g=null,h.abort(),h.ma())}function id(o,h){try{var m=o.j;if(m.G!=0&&(m.g==o||ad(m.h,o))){if(!o.K&&ad(m.h,o)&&m.G==3){try{var x=m.Da.g.parse(h)}catch{x=null}if(Array.isArray(x)&&x.length==3){var P=x;if(P[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<o.F)gl(m),ml(m);else break e;ud(m),Ye(18)}}else m.za=P[1],0<m.za-m.T&&37500>P[2]&&m.F&&m.v==0&&!m.C&&(m.C=as(g(m.Za,m),6e3));if(1>=Ip(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else ds(m,11)}else if((o.K||m.g==o)&&gl(m),!_(h))for(P=m.Da.g.parse(h),h=0;h<P.length;h++){let he=P[h];if(m.T=he[0],he=he[1],m.G==2)if(he[0]=="c"){m.K=he[1],m.ia=he[2];const st=he[3];st!=null&&(m.la=st,m.j.info("VER="+m.la));const it=he[4];it!=null&&(m.Aa=it,m.j.info("SVER="+m.Aa));const Qs=he[5];Qs!=null&&typeof Qs=="number"&&0<Qs&&(x=1.5*Qs,m.L=x,m.j.info("backChannelRequestTimeoutMs_="+x)),x=m;const ir=o.g;if(ir){const vl=ir.g?ir.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(vl){var O=x.h;O.g||vl.indexOf("spdy")==-1&&vl.indexOf("quic")==-1&&vl.indexOf("h2")==-1||(O.j=O.l,O.g=new Set,O.h&&(od(O,O.h),O.h=null))}if(x.D){const hd=ir.g?ir.g.getResponseHeader("X-HTTP-Session-Id"):null;hd&&(x.ya=hd,_e(x.I,x.D,hd))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-o.F,m.j.info("Handshake RTT: "+m.R+"ms")),x=m;var B=o;if(x.qa=Jp(x,x.J?x.ia:null,x.W),B.K){Sp(x.h,B);var ge=B,Xe=x.L;Xe&&(ge.I=Xe),ge.B&&(sd(ge),ol(ge)),x.g=B}else Kp(x);0<m.i.length&&pl(m)}else he[0]!="stop"&&he[0]!="close"||ds(m,7);else m.G==3&&(he[0]=="stop"||he[0]=="close"?he[0]=="stop"?ds(m,7):cd(m):he[0]!="noop"&&m.l&&m.l.ta(he),m.v=0)}}is(4)}catch{}}var Q1=class{constructor(o,h){this.g=o,this.map=h}};function bp(o){this.l=o||10,c.PerformanceNavigationTiming?(o=c.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Tp(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Ip(o){return o.h?1:o.g?o.g.size:0}function ad(o,h){return o.h?o.h==h:o.g?o.g.has(h):!1}function od(o,h){o.g?o.g.add(h):o.h=h}function Sp(o,h){o.h&&o.h==h?o.h=null:o.g&&o.g.has(h)&&o.g.delete(h)}bp.prototype.cancel=function(){if(this.i=Np(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function Np(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let h=o.i;for(const m of o.g.values())h=h.concat(m.D);return h}return S(o.i)}function Y1(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(u(o)){for(var h=[],m=o.length,x=0;x<m;x++)h.push(o[x]);return h}h=[],m=0;for(x in o)h[m++]=o[x];return h}function X1(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(u(o)||typeof o=="string"){var h=[];o=o.length;for(var m=0;m<o;m++)h.push(m);return h}h=[],m=0;for(const x in o)h[m++]=x;return h}}}function Ap(o,h){if(o.forEach&&typeof o.forEach=="function")o.forEach(h,void 0);else if(u(o)||typeof o=="string")Array.prototype.forEach.call(o,h,void 0);else for(var m=X1(o),x=Y1(o),P=x.length,O=0;O<P;O++)h.call(void 0,x[O],m&&m[O],o)}var Cp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function J1(o,h){if(o){o=o.split("&");for(var m=0;m<o.length;m++){var x=o[m].indexOf("="),P=null;if(0<=x){var O=o[m].substring(0,x);P=o[m].substring(x+1)}else O=o[m];h(O,P?decodeURIComponent(P.replace(/\+/g," ")):"")}}}function us(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof us){this.h=o.h,ll(this,o.j),this.o=o.o,this.g=o.g,cl(this,o.s),this.l=o.l;var h=o.i,m=new la;m.i=h.i,h.g&&(m.g=new Map(h.g),m.h=h.h),Rp(this,m),this.m=o.m}else o&&(h=String(o).match(Cp))?(this.h=!1,ll(this,h[1]||"",!0),this.o=aa(h[2]||""),this.g=aa(h[3]||"",!0),cl(this,h[4]),this.l=aa(h[5]||"",!0),Rp(this,h[6]||"",!0),this.m=aa(h[7]||"")):(this.h=!1,this.i=new la(null,this.h))}us.prototype.toString=function(){var o=[],h=this.j;h&&o.push(oa(h,Pp,!0),":");var m=this.g;return(m||h=="file")&&(o.push("//"),(h=this.o)&&o.push(oa(h,Pp,!0),"@"),o.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&o.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&o.push("/"),o.push(oa(m,m.charAt(0)=="/"?tk:ek,!0))),(m=this.i.toString())&&o.push("?",m),(m=this.m)&&o.push("#",oa(m,nk)),o.join("")};function Vr(o){return new us(o)}function ll(o,h,m){o.j=m?aa(h,!0):h,o.j&&(o.j=o.j.replace(/:$/,""))}function cl(o,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);o.s=h}else o.s=null}function Rp(o,h,m){h instanceof la?(o.i=h,sk(o.i,o.h)):(m||(h=oa(h,rk)),o.i=new la(h,o.h))}function _e(o,h,m){o.i.set(h,m)}function ul(o){return _e(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function aa(o,h){return o?h?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function oa(o,h,m){return typeof o=="string"?(o=encodeURI(o).replace(h,Z1),m&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function Z1(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var Pp=/[#\/\?@]/g,ek=/[#\?:]/g,tk=/[#\?]/g,rk=/[#\?@]/g,nk=/#/g;function la(o,h){this.h=this.g=null,this.i=o||null,this.j=!!h}function dn(o){o.g||(o.g=new Map,o.h=0,o.i&&J1(o.i,function(h,m){o.add(decodeURIComponent(h.replace(/\+/g," ")),m)}))}t=la.prototype,t.add=function(o,h){dn(this),this.i=null,o=Ks(this,o);var m=this.g.get(o);return m||this.g.set(o,m=[]),m.push(h),this.h+=1,this};function jp(o,h){dn(o),h=Ks(o,h),o.g.has(h)&&(o.i=null,o.h-=o.g.get(h).length,o.g.delete(h))}function Dp(o,h){return dn(o),h=Ks(o,h),o.g.has(h)}t.forEach=function(o,h){dn(this),this.g.forEach(function(m,x){m.forEach(function(P){o.call(h,P,x,this)},this)},this)},t.na=function(){dn(this);const o=Array.from(this.g.values()),h=Array.from(this.g.keys()),m=[];for(let x=0;x<h.length;x++){const P=o[x];for(let O=0;O<P.length;O++)m.push(h[x])}return m},t.V=function(o){dn(this);let h=[];if(typeof o=="string")Dp(this,o)&&(h=h.concat(this.g.get(Ks(this,o))));else{o=Array.from(this.g.values());for(let m=0;m<o.length;m++)h=h.concat(o[m])}return h},t.set=function(o,h){return dn(this),this.i=null,o=Ks(this,o),Dp(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[h]),this.h+=1,this},t.get=function(o,h){return o?(o=this.V(o),0<o.length?String(o[0]):h):h};function Op(o,h,m){jp(o,h),0<m.length&&(o.i=null,o.g.set(Ks(o,h),S(m)),o.h+=m.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],h=Array.from(this.g.keys());for(var m=0;m<h.length;m++){var x=h[m];const O=encodeURIComponent(String(x)),B=this.V(x);for(x=0;x<B.length;x++){var P=O;B[x]!==""&&(P+="="+encodeURIComponent(String(B[x]))),o.push(P)}}return this.i=o.join("&")};function Ks(o,h){return h=String(h),o.j&&(h=h.toLowerCase()),h}function sk(o,h){h&&!o.j&&(dn(o),o.i=null,o.g.forEach(function(m,x){var P=x.toLowerCase();x!=P&&(jp(this,x),Op(this,P,m))},o)),o.j=h}function ik(o,h){const m=new os;if(c.Image){const x=new Image;x.onload=w(hn,m,"TestLoadImage: loaded",!0,h,x),x.onerror=w(hn,m,"TestLoadImage: error",!1,h,x),x.onabort=w(hn,m,"TestLoadImage: abort",!1,h,x),x.ontimeout=w(hn,m,"TestLoadImage: timeout",!1,h,x),c.setTimeout(function(){x.ontimeout&&x.ontimeout()},1e4),x.src=o}else h(!1)}function ak(o,h){const m=new os,x=new AbortController,P=setTimeout(()=>{x.abort(),hn(m,"TestPingServer: timeout",!1,h)},1e4);fetch(o,{signal:x.signal}).then(O=>{clearTimeout(P),O.ok?hn(m,"TestPingServer: ok",!0,h):hn(m,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(P),hn(m,"TestPingServer: error",!1,h)})}function hn(o,h,m,x,P){try{P&&(P.onload=null,P.onerror=null,P.onabort=null,P.ontimeout=null),x(m)}catch{}}function ok(){this.g=new Zu}function lk(o,h,m){const x=m||"";try{Ap(o,function(P,O){let B=P;d(P)&&(B=Hs(P)),h.push(x+O+"="+encodeURIComponent(B))})}catch(P){throw h.push(x+"type="+encodeURIComponent("_badmap")),P}}function dl(o){this.l=o.Ub||null,this.j=o.eb||!1}N(dl,ta),dl.prototype.g=function(){return new hl(this.l,this.j)},dl.prototype.i=function(o){return function(){return o}}({});function hl(o,h){je.call(this),this.D=o,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}N(hl,je),t=hl.prototype,t.open=function(o,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=h,this.readyState=1,ua(this)},t.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(h.body=o),(this.D||c).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ca(this)),this.readyState=0},t.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,ua(this)),this.g&&(this.readyState=3,ua(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Vp(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function Vp(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}t.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var h=o.value?o.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!o.done}))&&(this.response=this.responseText+=h)}o.done?ca(this):ua(this),this.readyState==3&&Vp(this)}},t.Ra=function(o){this.g&&(this.response=this.responseText=o,ca(this))},t.Qa=function(o){this.g&&(this.response=o,ca(this))},t.ga=function(){this.g&&ca(this)};function ca(o){o.readyState=4,o.l=null,o.j=null,o.v=null,ua(o)}t.setRequestHeader=function(o,h){this.u.append(o,h)},t.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],h=this.h.entries();for(var m=h.next();!m.done;)m=m.value,o.push(m[0]+": "+m[1]),m=h.next();return o.join(`\r
`)};function ua(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(hl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function Mp(o){let h="";return D(o,function(m,x){h+=x,h+=":",h+=m,h+=`\r
`}),h}function ld(o,h,m){e:{for(x in m){var x=!1;break e}x=!0}x||(m=Mp(m),typeof o=="string"?m!=null&&encodeURIComponent(String(m)):_e(o,h,m))}function Re(o){je.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}N(Re,je);var ck=/^https?$/i,uk=["POST","PUT"];t=Re.prototype,t.Ha=function(o){this.J=o},t.ea=function(o,h,m,x){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);h=h?h.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():td.g(),this.v=this.o?ra(this.o):ra(td),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(h,String(o),!0),this.B=!1}catch(O){Lp(this,O);return}if(o=m||"",m=new Map(this.headers),x)if(Object.getPrototypeOf(x)===Object.prototype)for(var P in x)m.set(P,x[P]);else if(typeof x.keys=="function"&&typeof x.get=="function")for(const O of x.keys())m.set(O,x.get(O));else throw Error("Unknown input type for opt_headers: "+String(x));x=Array.from(m.keys()).find(O=>O.toLowerCase()=="content-type"),P=c.FormData&&o instanceof c.FormData,!(0<=Array.prototype.indexOf.call(uk,h,void 0))||x||P||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[O,B]of m)this.g.setRequestHeader(O,B);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{zp(this),this.u=!0,this.g.send(o),this.u=!1}catch(O){Lp(this,O)}};function Lp(o,h){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=h,o.m=5,Fp(o),fl(o)}function Fp(o){o.A||(o.A=!0,Qe(o,"complete"),Qe(o,"error"))}t.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,Qe(this,"complete"),Qe(this,"abort"),fl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),fl(this,!0)),Re.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Up(this):this.bb())},t.bb=function(){Up(this)};function Up(o){if(o.h&&typeof a<"u"&&(!o.v[1]||Mr(o)!=4||o.Z()!=2)){if(o.u&&Mr(o)==4)ea(o.Ea,0,o);else if(Qe(o,"readystatechange"),Mr(o)==4){o.h=!1;try{const B=o.Z();e:switch(B){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var m;if(!(m=h)){var x;if(x=B===0){var P=String(o.D).match(Cp)[1]||null;!P&&c.self&&c.self.location&&(P=c.self.location.protocol.slice(0,-1)),x=!ck.test(P?P.toLowerCase():"")}m=x}if(m)Qe(o,"complete"),Qe(o,"success");else{o.m=6;try{var O=2<Mr(o)?o.g.statusText:""}catch{O=""}o.l=O+" ["+o.Z()+"]",Fp(o)}}finally{fl(o)}}}}function fl(o,h){if(o.g){zp(o);const m=o.g,x=o.v[0]?()=>{}:null;o.g=null,o.v=null,h||Qe(o,"ready");try{m.onreadystatechange=x}catch{}}}function zp(o){o.I&&(c.clearTimeout(o.I),o.I=null)}t.isActive=function(){return!!this.g};function Mr(o){return o.g?o.g.readyState:0}t.Z=function(){try{return 2<Mr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(o){if(this.g){var h=this.g.responseText;return o&&h.indexOf(o)==0&&(h=h.substring(o.length)),Ju(h)}};function Bp(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function dk(o){const h={};o=(o.g&&2<=Mr(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let x=0;x<o.length;x++){if(_(o[x]))continue;var m=A(o[x]);const P=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const O=h[P]||[];h[P]=O,O.push(m)}v(h,function(x){return x.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function da(o,h,m){return m&&m.internalChannelParams&&m.internalChannelParams[o]||h}function $p(o){this.Aa=0,this.i=[],this.j=new os,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=da("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=da("baseRetryDelayMs",5e3,o),this.cb=da("retryDelaySeedMs",1e4,o),this.Wa=da("forwardChannelMaxRetries",2,o),this.wa=da("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new bp(o&&o.concurrentRequestLimit),this.Da=new ok,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=$p.prototype,t.la=8,t.G=1,t.connect=function(o,h,m,x){Ye(0),this.W=o,this.H=h||{},m&&x!==void 0&&(this.H.OSID=m,this.H.OAID=x),this.F=this.X,this.I=Jp(this,null,this.W),pl(this)};function cd(o){if(qp(o),o.G==3){var h=o.U++,m=Vr(o.I);if(_e(m,"SID",o.K),_e(m,"RID",h),_e(m,"TYPE","terminate"),ha(o,m),h=new un(o,o.j,h),h.L=2,h.v=ul(Vr(m)),m=!1,c.navigator&&c.navigator.sendBeacon)try{m=c.navigator.sendBeacon(h.v.toString(),"")}catch{}!m&&c.Image&&(new Image().src=h.v,m=!0),m||(h.g=Zp(h.j,null),h.g.ea(h.v)),h.F=Date.now(),ol(h)}Xp(o)}function ml(o){o.g&&(dd(o),o.g.cancel(),o.g=null)}function qp(o){ml(o),o.u&&(c.clearTimeout(o.u),o.u=null),gl(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&c.clearTimeout(o.s),o.s=null)}function pl(o){if(!Tp(o.h)&&!o.s){o.s=!0;var h=o.Ga;Rt||q(),W||(Rt(),W=!0),z.add(h,o),o.B=0}}function hk(o,h){return Ip(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=h.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=as(g(o.Ga,o,h),Yp(o,o.B)),o.B++,!0)}t.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;const P=new un(this,this.j,o);let O=this.o;if(this.S&&(O?(O=y(O),b(O,this.S)):O=this.S),this.m!==null||this.O||(P.H=O,O=null),this.P)e:{for(var h=0,m=0;m<this.i.length;m++){t:{var x=this.i[m];if("__data__"in x.map&&(x=x.map.__data__,typeof x=="string")){x=x.length;break t}x=void 0}if(x===void 0)break;if(h+=x,4096<h){h=m;break e}if(h===4096||m===this.i.length-1){h=m+1;break e}}h=1e3}else h=1e3;h=Wp(this,P,h),m=Vr(this.I),_e(m,"RID",o),_e(m,"CVER",22),this.D&&_e(m,"X-HTTP-Session-Id",this.D),ha(this,m),O&&(this.O?h="headers="+encodeURIComponent(String(Mp(O)))+"&"+h:this.m&&ld(m,this.m,O)),od(this.h,P),this.Ua&&_e(m,"TYPE","init"),this.P?(_e(m,"$req",h),_e(m,"SID","null"),P.T=!0,nd(P,m,null)):nd(P,m,h),this.G=2}}else this.G==3&&(o?Hp(this,o):this.i.length==0||Tp(this.h)||Hp(this))};function Hp(o,h){var m;h?m=h.l:m=o.U++;const x=Vr(o.I);_e(x,"SID",o.K),_e(x,"RID",m),_e(x,"AID",o.T),ha(o,x),o.m&&o.o&&ld(x,o.m,o.o),m=new un(o,o.j,m,o.B+1),o.m===null&&(m.H=o.o),h&&(o.i=h.D.concat(o.i)),h=Wp(o,m,1e3),m.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),od(o.h,m),nd(m,x,h)}function ha(o,h){o.H&&D(o.H,function(m,x){_e(h,x,m)}),o.l&&Ap({},function(m,x){_e(h,x,m)})}function Wp(o,h,m){m=Math.min(o.i.length,m);var x=o.l?g(o.l.Na,o.l,o):null;e:{var P=o.i;let O=-1;for(;;){const B=["count="+m];O==-1?0<m?(O=P[0].g,B.push("ofs="+O)):O=0:B.push("ofs="+O);let ge=!0;for(let Xe=0;Xe<m;Xe++){let he=P[Xe].g;const st=P[Xe].map;if(he-=O,0>he)O=Math.max(0,P[Xe].g-100),ge=!1;else try{lk(st,B,"req"+he+"_")}catch{x&&x(st)}}if(ge){x=B.join("&");break e}}}return o=o.i.splice(0,m),h.D=o,x}function Kp(o){if(!o.g&&!o.u){o.Y=1;var h=o.Fa;Rt||q(),W||(Rt(),W=!0),z.add(h,o),o.v=0}}function ud(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=as(g(o.Fa,o),Yp(o,o.v)),o.v++,!0)}t.Fa=function(){if(this.u=null,Gp(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=as(g(this.ab,this),o)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ye(10),ml(this),Gp(this))};function dd(o){o.A!=null&&(c.clearTimeout(o.A),o.A=null)}function Gp(o){o.g=new un(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var h=Vr(o.qa);_e(h,"RID","rpc"),_e(h,"SID",o.K),_e(h,"AID",o.T),_e(h,"CI",o.F?"0":"1"),!o.F&&o.ja&&_e(h,"TO",o.ja),_e(h,"TYPE","xmlhttp"),ha(o,h),o.m&&o.o&&ld(h,o.m,o.o),o.L&&(o.g.I=o.L);var m=o.g;o=o.ia,m.L=1,m.v=ul(Vr(h)),m.m=null,m.P=!0,wp(m,o)}t.Za=function(){this.C!=null&&(this.C=null,ml(this),ud(this),Ye(19))};function gl(o){o.C!=null&&(c.clearTimeout(o.C),o.C=null)}function Qp(o,h){var m=null;if(o.g==h){gl(o),dd(o),o.g=null;var x=2}else if(ad(o.h,h))m=h.D,Sp(o.h,h),x=1;else return;if(o.G!=0){if(h.o)if(x==1){m=h.m?h.m.length:0,h=Date.now()-h.F;var P=o.B;x=Ws(),Qe(x,new il(x,m)),pl(o)}else Kp(o);else if(P=h.s,P==3||P==0&&0<h.X||!(x==1&&hk(o,h)||x==2&&ud(o)))switch(m&&0<m.length&&(h=o.h,h.i=h.i.concat(m)),P){case 1:ds(o,5);break;case 4:ds(o,10);break;case 3:ds(o,6);break;default:ds(o,2)}}}function Yp(o,h){let m=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(m*=2),m*h}function ds(o,h){if(o.j.info("Error code "+h),h==2){var m=g(o.fb,o),x=o.Xa;const P=!x;x=new us(x||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||ll(x,"https"),ul(x),P?ik(x.toString(),m):ak(x.toString(),m)}else Ye(2);o.G=0,o.l&&o.l.sa(h),Xp(o),qp(o)}t.fb=function(o){o?(this.j.info("Successfully pinged google.com"),Ye(2)):(this.j.info("Failed to ping google.com"),Ye(1))};function Xp(o){if(o.G=0,o.ka=[],o.l){const h=Np(o.h);(h.length!=0||o.i.length!=0)&&(C(o.ka,h),C(o.ka,o.i),o.h.i.length=0,S(o.i),o.i.length=0),o.l.ra()}}function Jp(o,h,m){var x=m instanceof us?Vr(m):new us(m);if(x.g!="")h&&(x.g=h+"."+x.g),cl(x,x.s);else{var P=c.location;x=P.protocol,h=h?h+"."+P.hostname:P.hostname,P=+P.port;var O=new us(null);x&&ll(O,x),h&&(O.g=h),P&&cl(O,P),m&&(O.l=m),x=O}return m=o.D,h=o.ya,m&&h&&_e(x,m,h),_e(x,"VER",o.la),ha(o,x),x}function Zp(o,h,m){if(h&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=o.Ca&&!o.pa?new Re(new dl({eb:m})):new Re(o.pa),h.Ha(o.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function eg(){}t=eg.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function yl(){}yl.prototype.g=function(o,h){return new Pt(o,h)};function Pt(o,h){je.call(this),this.g=new $p(h),this.l=o,this.h=h&&h.messageUrlParams||null,o=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(o?o["X-WebChannel-Content-Type"]=h.messageContentType:o={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(o?o["X-WebChannel-Client-Profile"]=h.va:o={"X-WebChannel-Client-Profile":h.va}),this.g.S=o,(o=h&&h.Sb)&&!_(o)&&(this.g.m=o),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!_(h)&&(this.g.D=h,o=this.h,o!==null&&h in o&&(o=this.h,h in o&&delete o[h])),this.j=new Gs(this)}N(Pt,je),Pt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Pt.prototype.close=function(){cd(this.g)},Pt.prototype.o=function(o){var h=this.g;if(typeof o=="string"){var m={};m.__data__=o,o=m}else this.u&&(m={},m.__data__=Hs(o),o=m);h.i.push(new Q1(h.Ya++,o)),h.G==3&&pl(h)},Pt.prototype.N=function(){this.g.l=null,delete this.j,cd(this.g),delete this.g,Pt.aa.N.call(this)};function tg(o){na.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var h=o.__sm__;if(h){e:{for(const m in h){o=m;break e}o=void 0}(this.i=o)&&(o=this.i,h=h!==null&&o in h?h[o]:void 0),this.data=h}else this.data=o}N(tg,na);function rg(){sa.call(this),this.status=1}N(rg,sa);function Gs(o){this.g=o}N(Gs,eg),Gs.prototype.ua=function(){Qe(this.g,"a")},Gs.prototype.ta=function(o){Qe(this.g,new tg(o))},Gs.prototype.sa=function(o){Qe(this.g,new rg)},Gs.prototype.ra=function(){Qe(this.g,"b")},yl.prototype.createWebChannel=yl.prototype.g,Pt.prototype.send=Pt.prototype.o,Pt.prototype.open=Pt.prototype.m,Pt.prototype.close=Pt.prototype.close,cw=function(){return new yl},lw=function(){return Ws()},ow=Or,rf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},cn.NO_ERROR=0,cn.TIMEOUT=8,cn.HTTP_ERROR=6,ac=cn,vp.COMPLETE="complete",aw=vp,tl.EventType=ss,ss.OPEN="a",ss.CLOSE="b",ss.ERROR="c",ss.MESSAGE="d",je.prototype.listen=je.prototype.K,Ca=tl,Re.prototype.listenOnce=Re.prototype.L,Re.prototype.getLastError=Re.prototype.Ka,Re.prototype.getLastErrorCode=Re.prototype.Ba,Re.prototype.getStatus=Re.prototype.Z,Re.prototype.getResponseJson=Re.prototype.Oa,Re.prototype.getResponseText=Re.prototype.oa,Re.prototype.send=Re.prototype.ea,Re.prototype.setWithCredentials=Re.prototype.Ha,iw=Re}).apply(typeof Ml<"u"?Ml:typeof self<"u"?self:typeof window<"u"?window:{});const $0="@firebase/firestore",q0="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ct=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};ct.UNAUTHENTICATED=new ct(null),ct.GOOGLE_CREDENTIALS=new ct("google-credentials-uid"),ct.FIRST_PARTY=new ct("first-party-uid"),ct.MOCK_USER=new ct("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bi="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ps=new _m("@firebase/firestore");function Xs(){return Ps.logLevel}function K(t,...e){if(Ps.logLevel<=ie.DEBUG){const r=e.map(Rm);Ps.debug(`Firestore (${Bi}): ${t}`,...r)}}function Zr(t,...e){if(Ps.logLevel<=ie.ERROR){const r=e.map(Rm);Ps.error(`Firestore (${Bi}): ${t}`,...r)}}function Pi(t,...e){if(Ps.logLevel<=ie.WARN){const r=e.map(Rm);Ps.warn(`Firestore (${Bi}): ${t}`,...r)}}function Rm(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,uw(t,n,r)}function uw(t,e,r){let n=`FIRESTORE (${Bi}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Zr(n),new Error(n)}function fe(t,e,r,n){let s="Unexpected state";typeof r=="string"?s=r:n=r,t||uw(e,s,n)}function te(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class H extends er{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dw{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class HS{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(ct.UNAUTHENTICATED))}shutdown(){}}class WS{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class KS{constructor(e){this.t=e,this.currentUser=ct.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){fe(this.o===void 0,42304);let n=this.i;const s=u=>this.i!==n?(n=this.i,r(u)):Promise.resolve();let i=new Wr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Wr,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},c=u=>{K("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(K("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Wr)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(K("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(fe(typeof n.accessToken=="string",31837,{l:n}),new dw(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return fe(e===null||typeof e=="string",2055,{h:e}),new ct(e)}}class GS{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=ct.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class QS{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new GS(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(ct.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class H0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class YS{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Dt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){fe(this.o===void 0,3512);const n=i=>{i.error!=null&&K("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,K("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const s=i=>{K("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):K("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new H0(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(fe(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new H0(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XS(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pm{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=XS(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<r&&(n+=e.charAt(s[i]%62))}return n}}function ae(t,e){return t<e?-1:t>e?1:0}function nf(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const s=t.charAt(n),i=e.charAt(n);if(s!==i)return Wd(s)===Wd(i)?ae(s,i):Wd(s)?1:-1}return ae(t.length,e.length)}const JS=55296,ZS=57343;function Wd(t){const e=t.charCodeAt(0);return e>=JS&&e<=ZS}function ji(t,e,r){return t.length===e.length&&t.every((n,s)=>r(n,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W0="__name__";class _r{constructor(e,r,n){r===void 0?r=0:r>e.length&&Z(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&Z(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return _r.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof _r?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const i=_r.compareSegments(e.get(s),r.get(s));if(i!==0)return i}return ae(e.length,r.length)}static compareSegments(e,r){const n=_r.isNumericId(e),s=_r.isNumericId(r);return n&&!s?-1:!n&&s?1:n&&s?_r.extractNumericId(e).compare(_r.extractNumericId(r)):nf(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Vn.fromString(e.substring(4,e.length-2))}}class ve extends _r{construct(e,r,n){return new ve(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new H(V.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new ve(r)}static emptyPath(){return new ve([])}}const eN=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class et extends _r{construct(e,r,n){return new et(e,r,n)}static isValidIdentifier(e){return eN.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),et.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===W0}static keyField(){return new et([W0])}static fromServerFormat(e){const r=[];let n="",s=0;const i=()=>{if(n.length===0)throw new H(V.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new H(V.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new H(V.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,s+=2}else c==="`"?(a=!a,s++):c!=="."||a?(n+=c,s++):(i(),s++)}if(i(),a)throw new H(V.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new et(r)}static emptyPath(){return new et([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q{constructor(e){this.path=e}static fromPath(e){return new Q(ve.fromString(e))}static fromName(e){return new Q(ve.fromString(e).popFirst(5))}static empty(){return new Q(ve.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ve.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return ve.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Q(new ve(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hw(t,e,r){if(!r)throw new H(V.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function tN(t,e,r,n){if(e===!0&&n===!0)throw new H(V.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function K0(t){if(!Q.isDocumentKey(t))throw new H(V.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function G0(t){if(Q.isDocumentKey(t))throw new H(V.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function fw(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Su(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Z(12329,{type:typeof t})}function Ft(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new H(V.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Su(t);throw new H(V.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ue(t,e){const r={typeString:t};return e&&(r.value=e),r}function Vo(t,e){if(!fw(t))throw new H(V.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const s=e[n].typeString,i="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const a=t[n];if(s&&typeof a!==s){r=`JSON field '${n}' must be a ${s}.`;break}if(i!==void 0&&a!==i.value){r=`Expected '${n}' field to equal '${i.value}'`;break}}if(r)throw new H(V.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q0=-62135596800,Y0=1e6;class ye{static now(){return ye.fromMillis(Date.now())}static fromDate(e){return ye.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*Y0);return new ye(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new H(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new H(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<Q0)throw new H(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new H(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Y0}_compareTo(e){return this.seconds===e.seconds?ae(this.nanoseconds,e.nanoseconds):ae(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ye._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Vo(e,ye._jsonSchema))return new ye(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Q0;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ye._jsonSchemaVersion="firestore/timestamp/1.0",ye._jsonSchema={type:Ue("string",ye._jsonSchemaVersion),seconds:Ue("number"),nanoseconds:Ue("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ee{static fromTimestamp(e){return new ee(e)}static min(){return new ee(new ye(0,0))}static max(){return new ee(new ye(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const po=-1;function rN(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=ee.fromTimestamp(n===1e9?new ye(r+1,0):new ye(r,n));return new zn(s,Q.empty(),e)}function nN(t){return new zn(t.readTime,t.key,po)}class zn{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new zn(ee.min(),Q.empty(),po)}static max(){return new zn(ee.max(),Q.empty(),po)}}function sN(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Q.comparator(t.documentKey,e.documentKey),r!==0?r:ae(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class aN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $i(t){if(t.code!==V.FAILED_PRECONDITION||t.message!==iN)throw t;K("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Z(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new M((n,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,s)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,s)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof M?r:M.resolve(r)}catch(r){return M.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):M.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):M.reject(r)}static resolve(e){return new M((r,n)=>{r(e)})}static reject(e){return new M((r,n)=>{n(e)})}static waitFor(e){return new M((r,n)=>{let s=0,i=0,a=!1;e.forEach(c=>{++s,c.next(()=>{++i,a&&i===s&&r()},u=>n(u))}),a=!0,i===s&&r()})}static or(e){let r=M.resolve(!1);for(const n of e)r=r.next(s=>s?M.resolve(s):n());return r}static forEach(e,r){const n=[];return e.forEach((s,i)=>{n.push(r.call(this,s,i))}),this.waitFor(n)}static mapArray(e,r){return new M((n,s)=>{const i=e.length,a=new Array(i);let c=0;for(let u=0;u<i;u++){const d=u;r(e[d]).next(f=>{a[d]=f,++c,c===i&&n(a)},f=>s(f))}})}static doWhile(e,r){return new M((n,s)=>{const i=()=>{e()===!0?r().next(()=>{i()},s):n()};i()})}}function oN(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function qi(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Nu.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jm=-1;function Au(t){return t==null}function Hc(t){return t===0&&1/t==-1/0}function lN(t){return typeof t=="number"&&Number.isInteger(t)&&!Hc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mw="";function cN(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=X0(e)),e=uN(t.get(r),e);return X0(e)}function uN(t,e){let r=e;const n=t.length;for(let s=0;s<n;s++){const i=t.charAt(s);switch(i){case"\0":r+="";break;case mw:r+="";break;default:r+=i}}return r}function X0(t){return t+mw+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J0(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Xn(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function pw(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ce{constructor(e,r){this.comparator=e,this.root=r||Ze.EMPTY}insert(e,r){return new Ce(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Ze.BLACK,null,null))}remove(e){return new Ce(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ze.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ll(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ll(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ll(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ll(this.root,e,this.comparator,!0)}}class Ll{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ze{constructor(e,r,n,s,i){this.key=e,this.value=r,this.color=n??Ze.RED,this.left=s??Ze.EMPTY,this.right=i??Ze.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,i){return new Ze(e??this.key,r??this.value,n??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const i=n(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,r,n),null):i===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Ze.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return Ze.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ze.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ze.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Z(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Z(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Z(27949);return e+(this.isRed()?0:1)}}Ze.EMPTY=null,Ze.RED=!0,Ze.BLACK=!1;Ze.EMPTY=new class{constructor(){this.size=0}get key(){throw Z(57766)}get value(){throw Z(16141)}get color(){throw Z(16727)}get left(){throw Z(29726)}get right(){throw Z(36894)}copy(e,r,n,s,i){return this}insert(e,r,n){return new Ze(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qe{constructor(e){this.comparator=e,this.data=new Ce(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new Z0(this.data.getIterator())}getIteratorFrom(e){return new Z0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof qe)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new qe(this.comparator);return r.data=e,r}}class Z0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e){this.fields=e,e.sort(et.comparator)}static empty(){return new Vt([])}unionWith(e){let r=new qe(et.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Vt(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return ji(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nt{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new gw("Invalid base64 string: "+i):i}}(e);return new nt(r)}static fromUint8Array(e){const r=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new nt(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ae(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}nt.EMPTY_BYTE_STRING=new nt("");const dN=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bn(t){if(fe(!!t,39018),typeof t=="string"){let e=0;const r=dN.exec(t);if(fe(!!r,46558,{timestamp:t}),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:De(t.seconds),nanos:De(t.nanos)}}function De(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function $n(t){return typeof t=="string"?nt.fromBase64String(t):nt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yw="server_timestamp",vw="__type__",xw="__previous_value__",_w="__local_write_time__";function Dm(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[vw])==null?void 0:n.stringValue)===yw}function Cu(t){const e=t.mapValue.fields[xw];return Dm(e)?Cu(e):e}function go(t){const e=Bn(t.mapValue.fields[_w].timestampValue);return new ye(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hN{constructor(e,r,n,s,i,a,c,u,d,f){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=f}}const Wc="(default)";class yo{constructor(e,r){this.projectId=e,this.database=r||Wc}static empty(){return new yo("","")}get isDefaultDatabase(){return this.database===Wc}isEqual(e){return e instanceof yo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ww="__type__",kw="__max__",Fl={mapValue:{fields:{__type__:{stringValue:kw}}}},Ew="__vector__",Kc="value";function qn(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Dm(t)?4:mN(t)?9007199254740991:fN(t)?10:11:Z(28295,{value:t})}function Rr(t,e){if(t===e)return!0;const r=qn(t);if(r!==qn(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return go(t).isEqual(go(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=Bn(s.timestampValue),c=Bn(i.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return $n(s.bytesValue).isEqual($n(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return De(s.geoPointValue.latitude)===De(i.geoPointValue.latitude)&&De(s.geoPointValue.longitude)===De(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return De(s.integerValue)===De(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=De(s.doubleValue),c=De(i.doubleValue);return a===c?Hc(a)===Hc(c):isNaN(a)&&isNaN(c)}return!1}(t,e);case 9:return ji(t.arrayValue.values||[],e.arrayValue.values||[],Rr);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},c=i.mapValue.fields||{};if(J0(a)!==J0(c))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(c[u]===void 0||!Rr(a[u],c[u])))return!1;return!0}(t,e);default:return Z(52216,{left:t})}}function vo(t,e){return(t.values||[]).find(r=>Rr(r,e))!==void 0}function Di(t,e){if(t===e)return 0;const r=qn(t),n=qn(e);if(r!==n)return ae(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return ae(t.booleanValue,e.booleanValue);case 2:return function(i,a){const c=De(i.integerValue||i.doubleValue),u=De(a.integerValue||a.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return ey(t.timestampValue,e.timestampValue);case 4:return ey(go(t),go(e));case 5:return nf(t.stringValue,e.stringValue);case 6:return function(i,a){const c=$n(i),u=$n(a);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const c=i.split("/"),u=a.split("/");for(let d=0;d<c.length&&d<u.length;d++){const f=ae(c[d],u[d]);if(f!==0)return f}return ae(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const c=ae(De(i.latitude),De(a.latitude));return c!==0?c:ae(De(i.longitude),De(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return ty(t.arrayValue,e.arrayValue);case 10:return function(i,a){var g,w,N,S;const c=i.fields||{},u=a.fields||{},d=(g=c[Kc])==null?void 0:g.arrayValue,f=(w=u[Kc])==null?void 0:w.arrayValue,p=ae(((N=d==null?void 0:d.values)==null?void 0:N.length)||0,((S=f==null?void 0:f.values)==null?void 0:S.length)||0);return p!==0?p:ty(d,f)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===Fl.mapValue&&a===Fl.mapValue)return 0;if(i===Fl.mapValue)return 1;if(a===Fl.mapValue)return-1;const c=i.fields||{},u=Object.keys(c),d=a.fields||{},f=Object.keys(d);u.sort(),f.sort();for(let p=0;p<u.length&&p<f.length;++p){const g=nf(u[p],f[p]);if(g!==0)return g;const w=Di(c[u[p]],d[f[p]]);if(w!==0)return w}return ae(u.length,f.length)}(t.mapValue,e.mapValue);default:throw Z(23264,{he:r})}}function ey(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ae(t,e);const r=Bn(t),n=Bn(e),s=ae(r.seconds,n.seconds);return s!==0?s:ae(r.nanos,n.nanos)}function ty(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const i=Di(r[s],n[s]);if(i)return i}return ae(r.length,n.length)}function Oi(t){return sf(t)}function sf(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Bn(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return $n(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Q.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",s=!0;for(const i of r.values||[])s?s=!1:n+=",",n+=sf(i);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",i=!0;for(const a of n)i?i=!1:s+=",",s+=`${a}:${sf(r.fields[a])}`;return s+"}"}(t.mapValue):Z(61005,{value:t})}function oc(t){switch(qn(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Cu(t);return e?16+oc(e):16;case 5:return 2*t.stringValue.length;case 6:return $n(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((s,i)=>s+oc(i),0)}(t.arrayValue);case 10:case 11:return function(n){let s=0;return Xn(n.fields,(i,a)=>{s+=i.length+oc(a)}),s}(t.mapValue);default:throw Z(13486,{value:t})}}function ry(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function af(t){return!!t&&"integerValue"in t}function Om(t){return!!t&&"arrayValue"in t}function ny(t){return!!t&&"nullValue"in t}function sy(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function lc(t){return!!t&&"mapValue"in t}function fN(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[ww])==null?void 0:n.stringValue)===Ew}function Ha(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Xn(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Ha(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Ha(t.arrayValue.values[r]);return e}return{...t}}function mN(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===kw}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e){this.value=e}static empty(){return new Et({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!lc(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ha(r)}setAll(e){let r=et.emptyPath(),n={},s=[];e.forEach((a,c)=>{if(!r.isImmediateParentOf(c)){const u=this.getFieldsMap(r);this.applyChanges(u,n,s),n={},s=[],r=c.popLast()}a?n[c.lastSegment()]=Ha(a):s.push(c.lastSegment())});const i=this.getFieldsMap(r);this.applyChanges(i,n,s)}delete(e){const r=this.field(e.popLast());lc(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Rr(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];lc(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){Xn(r,(s,i)=>e[s]=i);for(const s of n)delete e[s]}clone(){return new Et(Ha(this.value))}}function bw(t){const e=[];return Xn(t.fields,(r,n)=>{const s=new et([r]);if(lc(n)){const i=bw(n.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new Vt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(e,r,n,s,i,a,c){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=i,this.data=a,this.documentState=c}static newInvalidDocument(e){return new dt(e,0,ee.min(),ee.min(),ee.min(),Et.empty(),0)}static newFoundDocument(e,r,n,s){return new dt(e,1,r,ee.min(),n,s,0)}static newNoDocument(e,r){return new dt(e,2,r,ee.min(),ee.min(),Et.empty(),0)}static newUnknownDocument(e,r){return new dt(e,3,r,ee.min(),ee.min(),Et.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(ee.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Et.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Et.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ee.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof dt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new dt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gc{constructor(e,r){this.position=e,this.inclusive=r}}function iy(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?n=Q.comparator(Q.fromName(a.referenceValue),r.key):n=Di(a,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function ay(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Rr(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(e,r="asc"){this.field=e,this.dir=r}}function pN(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tw=class{};class Fe extends Tw{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new yN(e,r,n):r==="array-contains"?new _N(e,n):r==="in"?new wN(e,n):r==="not-in"?new kN(e,n):r==="array-contains-any"?new EN(e,n):new Fe(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new vN(e,n):new xN(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(Di(r,this.value)):r!==null&&qn(this.value)===qn(r)&&this.matchesComparison(Di(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Z(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class gr extends Tw{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new gr(e,r)}matches(e){return Iw(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Iw(t){return t.op==="and"}function Sw(t){return gN(t)&&Iw(t)}function gN(t){for(const e of t.filters)if(e instanceof gr)return!1;return!0}function of(t){if(t instanceof Fe)return t.field.canonicalString()+t.op.toString()+Oi(t.value);if(Sw(t))return t.filters.map(e=>of(e)).join(",");{const e=t.filters.map(r=>of(r)).join(",");return`${t.op}(${e})`}}function Nw(t,e){return t instanceof Fe?function(n,s){return s instanceof Fe&&n.op===s.op&&n.field.isEqual(s.field)&&Rr(n.value,s.value)}(t,e):t instanceof gr?function(n,s){return s instanceof gr&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((i,a,c)=>i&&Nw(a,s.filters[c]),!0):!1}(t,e):void Z(19439)}function Aw(t){return t instanceof Fe?function(r){return`${r.field.canonicalString()} ${r.op} ${Oi(r.value)}`}(t):t instanceof gr?function(r){return r.op.toString()+" {"+r.getFilters().map(Aw).join(" ,")+"}"}(t):"Filter"}class yN extends Fe{constructor(e,r,n){super(e,r,n),this.key=Q.fromName(n.referenceValue)}matches(e){const r=Q.comparator(e.key,this.key);return this.matchesComparison(r)}}class vN extends Fe{constructor(e,r){super(e,"in",r),this.keys=Cw("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class xN extends Fe{constructor(e,r){super(e,"not-in",r),this.keys=Cw("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function Cw(t,e){var r;return(((r=e.arrayValue)==null?void 0:r.values)||[]).map(n=>Q.fromName(n.referenceValue))}class _N extends Fe{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Om(r)&&vo(r.arrayValue,this.value)}}class wN extends Fe{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&vo(this.value.arrayValue,r)}}class kN extends Fe{constructor(e,r){super(e,"not-in",r)}matches(e){if(vo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!vo(this.value.arrayValue,r)}}class EN extends Fe{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Om(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>vo(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bN{constructor(e,r=null,n=[],s=[],i=null,a=null,c=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=a,this.endAt=c,this.Te=null}}function oy(t,e=null,r=[],n=[],s=null,i=null,a=null){return new bN(t,e,r,n,s,i,a)}function Vm(t){const e=te(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>of(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),Au(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Oi(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Oi(n)).join(",")),e.Te=r}return e.Te}function Mm(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!pN(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!Nw(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ay(t.startAt,e.startAt)&&ay(t.endAt,e.endAt)}function lf(t){return Q.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi{constructor(e,r=null,n=[],s=[],i=null,a="F",c=null,u=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=a,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function TN(t,e,r,n,s,i,a,c){return new Hi(t,e,r,n,s,i,a,c)}function Ru(t){return new Hi(t)}function ly(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Rw(t){return t.collectionGroup!==null}function Wa(t){const e=te(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new qe(et.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(c=c.add(d.field))})}),c})(e).forEach(i=>{r.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new xo(i,n))}),r.has(et.keyField().canonicalString())||e.Ie.push(new xo(et.keyField(),n))}return e.Ie}function Sr(t){const e=te(t);return e.Ee||(e.Ee=IN(e,Wa(t))),e.Ee}function IN(t,e){if(t.limitType==="F")return oy(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new xo(s.field,i)});const r=t.endAt?new Gc(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Gc(t.startAt.position,t.startAt.inclusive):null;return oy(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function cf(t,e){const r=t.filters.concat([e]);return new Hi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function uf(t,e,r){return new Hi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Pu(t,e){return Mm(Sr(t),Sr(e))&&t.limitType===e.limitType}function Pw(t){return`${Vm(Sr(t))}|lt:${t.limitType}`}function Js(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>Aw(s)).join(", ")}]`),Au(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>Oi(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>Oi(s)).join(",")),`Target(${n})`}(Sr(t))}; limitType=${t.limitType})`}function ju(t,e){return e.isFoundDocument()&&function(n,s){const i=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):Q.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,s){for(const i of Wa(n))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const i of n.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(a,c,u){const d=iy(a,c,u);return a.inclusive?d<=0:d<0}(n.startAt,Wa(n),s)||n.endAt&&!function(a,c,u){const d=iy(a,c,u);return a.inclusive?d>=0:d>0}(n.endAt,Wa(n),s))}(t,e)}function SN(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function jw(t){return(e,r)=>{let n=!1;for(const s of Wa(t)){const i=NN(s,e,r);if(i!==0)return i;n=n||s.field.isKeyField()}return 0}}function NN(t,e,r){const n=t.field.isKeyField()?Q.comparator(e.key,r.key):function(i,a,c){const u=a.data.field(i),d=c.data.field(i);return u!==null&&d!==null?Di(u,d):Z(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Z(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,i]of n)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Xn(this.inner,(r,n)=>{for(const[s,i]of n)e(s,i)})}isEmpty(){return pw(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AN=new Ce(Q.comparator);function en(){return AN}const Dw=new Ce(Q.comparator);function Ra(...t){let e=Dw;for(const r of t)e=e.insert(r.key,r);return e}function Ow(t){let e=Dw;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function vs(){return Ka()}function Vw(){return Ka()}function Ka(){return new zs(t=>t.toString(),(t,e)=>t.isEqual(e))}const CN=new Ce(Q.comparator),RN=new qe(Q.comparator);function oe(...t){let e=RN;for(const r of t)e=e.add(r);return e}const PN=new qe(ae);function jN(){return PN}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lm(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Hc(e)?"-0":e}}function Mw(t){return{integerValue:""+t}}function DN(t,e){return lN(e)?Mw(e):Lm(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(){this._=void 0}}function ON(t,e,r){return t instanceof _o?function(s,i){const a={fields:{[vw]:{stringValue:yw},[_w]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Dm(i)&&(i=Cu(i)),i&&(a.fields[xw]=i),{mapValue:a}}(r,e):t instanceof wo?Fw(t,e):t instanceof ko?Uw(t,e):function(s,i){const a=Lw(s,i),c=cy(a)+cy(s.Ae);return af(a)&&af(s.Ae)?Mw(c):Lm(s.serializer,c)}(t,e)}function VN(t,e,r){return t instanceof wo?Fw(t,e):t instanceof ko?Uw(t,e):r}function Lw(t,e){return t instanceof Qc?function(n){return af(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class _o extends Du{}class wo extends Du{constructor(e){super(),this.elements=e}}function Fw(t,e){const r=zw(e);for(const n of t.elements)r.some(s=>Rr(s,n))||r.push(n);return{arrayValue:{values:r}}}class ko extends Du{constructor(e){super(),this.elements=e}}function Uw(t,e){let r=zw(e);for(const n of t.elements)r=r.filter(s=>!Rr(s,n));return{arrayValue:{values:r}}}class Qc extends Du{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function cy(t){return De(t.integerValue||t.doubleValue)}function zw(t){return Om(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MN{constructor(e,r){this.field=e,this.transform=r}}function LN(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof wo&&s instanceof wo||n instanceof ko&&s instanceof ko?ji(n.elements,s.elements,Rr):n instanceof Qc&&s instanceof Qc?Rr(n.Ae,s.Ae):n instanceof _o&&s instanceof _o}(t.transform,e.transform)}class FN{constructor(e,r){this.version=e,this.transformResults=r}}class Nt{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Nt}static exists(e){return new Nt(void 0,e)}static updateTime(e){return new Nt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function cc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Ou{}function Bw(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Vu(t.key,Nt.none()):new Mo(t.key,t.data,Nt.none());{const r=t.data,n=Et.empty();let s=new qe(et.comparator);for(let i of e.fields)if(!s.has(i)){let a=r.field(i);a===null&&i.length>1&&(i=i.popLast(),a=r.field(i)),a===null?n.delete(i):n.set(i,a),s=s.add(i)}return new Jn(t.key,n,new Vt(s.toArray()),Nt.none())}}function UN(t,e,r){t instanceof Mo?function(s,i,a){const c=s.value.clone(),u=dy(s.fieldTransforms,i,a.transformResults);c.setAll(u),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,r):t instanceof Jn?function(s,i,a){if(!cc(s.precondition,i))return void i.convertToUnknownDocument(a.version);const c=dy(s.fieldTransforms,i,a.transformResults),u=i.data;u.setAll($w(s)),u.setAll(c),i.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,r):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function Ga(t,e,r,n){return t instanceof Mo?function(i,a,c,u){if(!cc(i.precondition,a))return c;const d=i.value.clone(),f=hy(i.fieldTransforms,u,a);return d.setAll(f),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(t,e,r,n):t instanceof Jn?function(i,a,c,u){if(!cc(i.precondition,a))return c;const d=hy(i.fieldTransforms,u,a),f=a.data;return f.setAll($w(i)),f.setAll(d),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(p=>p.field))}(t,e,r,n):function(i,a,c){return cc(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c}(t,e,r)}function zN(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),i=Lw(n.transform,s||null);i!=null&&(r===null&&(r=Et.empty()),r.set(n.field,i))}return r||null}function uy(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&ji(n,s,(i,a)=>LN(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Mo extends Ou{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Jn extends Ou{constructor(e,r,n,s,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function $w(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function dy(t,e,r){const n=new Map;fe(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let s=0;s<r.length;s++){const i=t[s],a=i.transform,c=e.data.field(i.field);n.set(i.field,VN(a,c,r[s]))}return n}function hy(t,e,r){const n=new Map;for(const s of t){const i=s.transform,a=r.data.field(s.field);n.set(s.field,ON(i,a,e))}return n}class Vu extends Ou{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class BN extends Ou{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $N{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&UN(i,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Ga(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Ga(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=Vw();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let c=this.applyToLocalView(a,i.mutatedFields);c=r.has(s.key)?null:c;const u=Bw(a,c);u!==null&&n.set(s.key,u),a.isValidDocument()||a.convertToNoDocument(ee.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),oe())}isEqual(e){return this.batchId===e.batchId&&ji(this.mutations,e.mutations,(r,n)=>uy(r,n))&&ji(this.baseMutations,e.baseMutations,(r,n)=>uy(r,n))}}class Fm{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){fe(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let s=function(){return CN}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,n[a].version);return new Fm(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qN{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HN{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Me,ce;function WN(t){switch(t){case V.OK:return Z(64938);case V.CANCELLED:case V.UNKNOWN:case V.DEADLINE_EXCEEDED:case V.RESOURCE_EXHAUSTED:case V.INTERNAL:case V.UNAVAILABLE:case V.UNAUTHENTICATED:return!1;case V.INVALID_ARGUMENT:case V.NOT_FOUND:case V.ALREADY_EXISTS:case V.PERMISSION_DENIED:case V.FAILED_PRECONDITION:case V.ABORTED:case V.OUT_OF_RANGE:case V.UNIMPLEMENTED:case V.DATA_LOSS:return!0;default:return Z(15467,{code:t})}}function qw(t){if(t===void 0)return Zr("GRPC error has no .code"),V.UNKNOWN;switch(t){case Me.OK:return V.OK;case Me.CANCELLED:return V.CANCELLED;case Me.UNKNOWN:return V.UNKNOWN;case Me.DEADLINE_EXCEEDED:return V.DEADLINE_EXCEEDED;case Me.RESOURCE_EXHAUSTED:return V.RESOURCE_EXHAUSTED;case Me.INTERNAL:return V.INTERNAL;case Me.UNAVAILABLE:return V.UNAVAILABLE;case Me.UNAUTHENTICATED:return V.UNAUTHENTICATED;case Me.INVALID_ARGUMENT:return V.INVALID_ARGUMENT;case Me.NOT_FOUND:return V.NOT_FOUND;case Me.ALREADY_EXISTS:return V.ALREADY_EXISTS;case Me.PERMISSION_DENIED:return V.PERMISSION_DENIED;case Me.FAILED_PRECONDITION:return V.FAILED_PRECONDITION;case Me.ABORTED:return V.ABORTED;case Me.OUT_OF_RANGE:return V.OUT_OF_RANGE;case Me.UNIMPLEMENTED:return V.UNIMPLEMENTED;case Me.DATA_LOSS:return V.DATA_LOSS;default:return Z(39323,{code:t})}}(ce=Me||(Me={}))[ce.OK=0]="OK",ce[ce.CANCELLED=1]="CANCELLED",ce[ce.UNKNOWN=2]="UNKNOWN",ce[ce.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ce[ce.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ce[ce.NOT_FOUND=5]="NOT_FOUND",ce[ce.ALREADY_EXISTS=6]="ALREADY_EXISTS",ce[ce.PERMISSION_DENIED=7]="PERMISSION_DENIED",ce[ce.UNAUTHENTICATED=16]="UNAUTHENTICATED",ce[ce.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ce[ce.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ce[ce.ABORTED=10]="ABORTED",ce[ce.OUT_OF_RANGE=11]="OUT_OF_RANGE",ce[ce.UNIMPLEMENTED=12]="UNIMPLEMENTED",ce[ce.INTERNAL=13]="INTERNAL",ce[ce.UNAVAILABLE=14]="UNAVAILABLE",ce[ce.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KN(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GN=new Vn([4294967295,4294967295],0);function fy(t){const e=KN().encode(t),r=new sw;return r.update(e),new Uint8Array(r.digest())}function my(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Vn([r,n],0),new Vn([s,i],0)]}class Um{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Pa(`Invalid padding: ${r}`);if(n<0)throw new Pa(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Pa(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Pa(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Vn.fromNumber(this.ge)}ye(e,r,n){let s=e.add(r.multiply(Vn.fromNumber(n)));return s.compare(GN)===1&&(s=new Vn([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=fy(e),[n,s]=my(r);for(let i=0;i<this.hashCount;i++){const a=this.ye(n,s,i);if(!this.we(a))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new Um(i,s,r);return n.forEach(c=>a.insert(c)),a}insert(e){if(this.ge===0)return;const r=fy(e),[n,s]=my(r);for(let i=0;i<this.hashCount;i++){const a=this.ye(n,s,i);this.Se(a)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Pa extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mu{constructor(e,r,n,s,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,Lo.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Mu(ee.min(),s,new Ce(ae),en(),oe())}}class Lo{constructor(e,r,n,s,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Lo(n,r,oe(),oe(),oe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc{constructor(e,r,n,s){this.be=e,this.removedTargetIds=r,this.key=n,this.De=s}}class Hw{constructor(e,r){this.targetId=e,this.Ce=r}}class Ww{constructor(e,r,n=nt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class py{constructor(){this.ve=0,this.Fe=gy(),this.Me=nt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=oe(),r=oe(),n=oe();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:Z(38017,{changeType:i})}}),new Lo(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=gy()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,fe(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class QN{constructor(e){this.Ge=e,this.ze=new Map,this.je=en(),this.Je=Ul(),this.He=Ul(),this.Ye=new Ce(ae)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:Z(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,s)=>{this.rt(s)&&r(s)})}st(e){const r=e.targetId,n=e.Ce.count,s=this.ot(r);if(s){const i=s.target;if(lf(i))if(n===0){const a=new Q(i.path);this.et(r,a,dt.newNoDocument(a,ee.min()))}else fe(n===1,20013,{expectedCount:n});else{const a=this._t(r);if(a!==n){const c=this.ut(e),u=c?this.ct(c,e,a):1;if(u!==0){this.it(r);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,d)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:i=0}=r;let a,c;try{a=$n(n).toUint8Array()}catch(u){if(u instanceof gw)return Pi("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Um(a,s,i)}catch(u){return Pi(u instanceof Pa?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let s=0;return n.forEach(i=>{const a=this.Ge.ht(),c=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(r,i,null),s++)}),s}Tt(e){const r=new Map;this.ze.forEach((i,a)=>{const c=this.ot(a);if(c){if(i.current&&lf(c.target)){const u=new Q(c.target.path);this.It(u).has(a)||this.Et(a,u)||this.et(a,u,dt.newNoDocument(u,e))}i.Be&&(r.set(a,i.ke()),i.qe())}});let n=oe();this.He.forEach((i,a)=>{let c=!0;a.forEachWhile(u=>{const d=this.ot(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(n=n.add(i))}),this.je.forEach((i,a)=>a.setReadTime(e));const s=new Mu(e,r,this.Ye,this.je,n);return this.je=en(),this.Je=Ul(),this.He=Ul(),this.Ye=new Ce(ae),s}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,r)?s.Qe(r,1):s.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new py,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new qe(ae),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new qe(ae),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||K("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new py),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function Ul(){return new Ce(Q.comparator)}function gy(){return new Ce(Q.comparator)}const YN={asc:"ASCENDING",desc:"DESCENDING"},XN={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},JN={and:"AND",or:"OR"};class ZN{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function df(t,e){return t.useProto3Json||Au(e)?e:{value:e}}function Yc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Kw(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function eA(t,e){return Yc(t,e.toTimestamp())}function Nr(t){return fe(!!t,49232),ee.fromTimestamp(function(r){const n=Bn(r);return new ye(n.seconds,n.nanos)}(t))}function zm(t,e){return hf(t,e).canonicalString()}function hf(t,e){const r=function(s){return new ve(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?r:r.child(e)}function Gw(t){const e=ve.fromString(t);return fe(Zw(e),10190,{key:e.toString()}),e}function ff(t,e){return zm(t.databaseId,e.path)}function Kd(t,e){const r=Gw(e);if(r.get(1)!==t.databaseId.projectId)throw new H(V.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new H(V.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Q(Yw(r))}function Qw(t,e){return zm(t.databaseId,e)}function tA(t){const e=Gw(t);return e.length===4?ve.emptyPath():Yw(e)}function mf(t){return new ve(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Yw(t){return fe(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function yy(t,e,r){return{name:ff(t,e),fields:r.value.mapValue.fields}}function rA(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Z(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,f){return d.useProto3Json?(fe(f===void 0||typeof f=="string",58123),nt.fromBase64String(f||"")):(fe(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),nt.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(d){const f=d.code===void 0?V.UNKNOWN:qw(d.code);return new H(f,d.message||"")}(a);r=new Ww(n,s,i,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=Kd(t,n.document.name),i=Nr(n.document.updateTime),a=n.document.createTime?Nr(n.document.createTime):ee.min(),c=new Et({mapValue:{fields:n.document.fields}}),u=dt.newFoundDocument(s,i,a,c),d=n.targetIds||[],f=n.removedTargetIds||[];r=new uc(d,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=Kd(t,n.document),i=n.readTime?Nr(n.readTime):ee.min(),a=dt.newNoDocument(s,i),c=n.removedTargetIds||[];r=new uc([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=Kd(t,n.document),i=n.removedTargetIds||[];r=new uc([],i,s,null)}else{if(!("filter"in e))return Z(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:i}=n,a=new HN(s,i),c=n.targetId;r=new Hw(c,a)}}return r}function nA(t,e){let r;if(e instanceof Mo)r={update:yy(t,e.key,e.value)};else if(e instanceof Vu)r={delete:ff(t,e.key)};else if(e instanceof Jn)r={update:yy(t,e.key,e.data),updateMask:hA(e.fieldMask)};else{if(!(e instanceof BN))return Z(16599,{Vt:e.type});r={verify:ff(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(i,a){const c=a.transform;if(c instanceof _o)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof wo)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof ko)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Qc)return{fieldPath:a.field.canonicalString(),increment:c.Ae};throw Z(20930,{transform:a.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:eA(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Z(27497)}(t,e.precondition)),r}function sA(t,e){return t&&t.length>0?(fe(e!==void 0,14353),t.map(r=>function(s,i){let a=s.updateTime?Nr(s.updateTime):Nr(i);return a.isEqual(ee.min())&&(a=Nr(i)),new FN(a,s.transformResults||[])}(r,e))):[]}function iA(t,e){return{documents:[Qw(t,e.path)]}}function aA(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=Qw(t,s);const i=function(d){if(d.length!==0)return Jw(gr.create(d,"and"))}(e.filters);i&&(r.structuredQuery.where=i);const a=function(d){if(d.length!==0)return d.map(f=>function(g){return{field:Zs(g.field),direction:cA(g.dir)}}(f))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const c=df(t,e.limit);return c!==null&&(r.structuredQuery.limit=c),e.startAt&&(r.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:r,parent:s}}function oA(t){let e=tA(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){fe(n===1,65062);const f=r.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let i=[];r.where&&(i=function(p){const g=Xw(p);return g instanceof gr&&Sw(g)?g.getFilters():[g]}(r.where));let a=[];r.orderBy&&(a=function(p){return p.map(g=>function(N){return new xo(ei(N.field),function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(N.direction))}(g))}(r.orderBy));let c=null;r.limit&&(c=function(p){let g;return g=typeof p=="object"?p.value:p,Au(g)?null:g}(r.limit));let u=null;r.startAt&&(u=function(p){const g=!!p.before,w=p.values||[];return new Gc(w,g)}(r.startAt));let d=null;return r.endAt&&(d=function(p){const g=!p.before,w=p.values||[];return new Gc(w,g)}(r.endAt)),TN(e,s,a,i,c,"F",u,d)}function lA(t,e){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Z(28987,{purpose:s})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function Xw(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=ei(r.unaryFilter.field);return Fe.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=ei(r.unaryFilter.field);return Fe.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=ei(r.unaryFilter.field);return Fe.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=ei(r.unaryFilter.field);return Fe.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Z(61313);default:return Z(60726)}}(t):t.fieldFilter!==void 0?function(r){return Fe.create(ei(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Z(58110);default:return Z(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return gr.create(r.compositeFilter.filters.map(n=>Xw(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Z(1026)}}(r.compositeFilter.op))}(t):Z(30097,{filter:t})}function cA(t){return YN[t]}function uA(t){return XN[t]}function dA(t){return JN[t]}function Zs(t){return{fieldPath:t.canonicalString()}}function ei(t){return et.fromServerFormat(t.fieldPath)}function Jw(t){return t instanceof Fe?function(r){if(r.op==="=="){if(sy(r.value))return{unaryFilter:{field:Zs(r.field),op:"IS_NAN"}};if(ny(r.value))return{unaryFilter:{field:Zs(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(sy(r.value))return{unaryFilter:{field:Zs(r.field),op:"IS_NOT_NAN"}};if(ny(r.value))return{unaryFilter:{field:Zs(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Zs(r.field),op:uA(r.op),value:r.value}}}(t):t instanceof gr?function(r){const n=r.getFilters().map(s=>Jw(s));return n.length===1?n[0]:{compositeFilter:{op:dA(r.op),filters:n}}}(t):Z(54877,{filter:t})}function hA(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function Zw(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(e,r,n,s,i=ee.min(),a=ee.min(),c=nt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Tn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Tn(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Tn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Tn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fA{constructor(e){this.yt=e}}function mA(t){const e=oA({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?uf(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pA{constructor(){this.Cn=new gA}addToCollectionParentIndex(e,r){return this.Cn.add(r),M.resolve()}getCollectionParents(e,r){return M.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return M.resolve()}deleteFieldIndex(e,r){return M.resolve()}deleteAllFieldIndexes(e){return M.resolve()}createTargetIndexes(e,r){return M.resolve()}getDocumentsMatchingTarget(e,r){return M.resolve(null)}getIndexType(e,r){return M.resolve(0)}getFieldIndexes(e,r){return M.resolve([])}getNextCollectionGroupToUpdate(e){return M.resolve(null)}getMinOffset(e,r){return M.resolve(zn.min())}getMinOffsetFromCollectionGroup(e,r){return M.resolve(zn.min())}updateCollectionGroup(e,r,n){return M.resolve()}updateIndexEntries(e,r){return M.resolve()}}class gA{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new qe(ve.comparator),i=!s.has(n);return this.index[r]=s.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new qe(ve.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vy={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},e1=41943040;class wt{static withCacheSize(e){return new wt(e,wt.DEFAULT_COLLECTION_PERCENTILE,wt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */wt.DEFAULT_COLLECTION_PERCENTILE=10,wt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,wt.DEFAULT=new wt(e1,wt.DEFAULT_COLLECTION_PERCENTILE,wt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),wt.DISABLED=new wt(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Vi(0)}static cr(){return new Vi(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xy="LruGarbageCollector",yA=1048576;function _y([t,e],[r,n]){const s=ae(t,r);return s===0?ae(e,n):s}class vA{constructor(e){this.Ir=e,this.buffer=new qe(_y),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();_y(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class xA{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){K(xy,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){qi(r)?K(xy,"Ignoring IndexedDB error during garbage collection: ",r):await $i(r)}await this.Vr(3e5)})}}class _A{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return M.resolve(Nu.ce);const n=new vA(r);return this.mr.forEachTarget(e,s=>n.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>n.Ar(s))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(K("LruGarbageCollector","Garbage collection skipped; disabled"),M.resolve(vy)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(K("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),vy):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,s,i,a,c,u,d;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(K("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),s=this.params.maximumSequenceNumbersToCollect):s=p,a=Date.now(),this.nthSequenceNumber(e,s))).next(p=>(n=p,c=Date.now(),this.removeTargets(e,n,r))).next(p=>(i=p,u=Date.now(),this.removeOrphanedDocuments(e,n))).next(p=>(d=Date.now(),Xs()<=ie.DEBUG&&K("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-f}ms
	Determined least recently used ${s} in `+(c-a)+`ms
	Removed ${i} targets in `+(u-c)+`ms
	Removed ${p} documents in `+(d-u)+`ms
Total Duration: ${d-f}ms`),M.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:p})))}}function wA(t,e){return new _A(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kA{constructor(){this.changes=new zs(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,dt.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?M.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EA{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bA{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,r))).next(s=>(n!==null&&Ga(n.mutation,s,Vt.empty(),ye.now()),s))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,oe()).next(()=>n))}getLocalViewOfDocuments(e,r,n=oe()){const s=vs();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,n).next(i=>{let a=Ra();return i.forEach((c,u)=>{a=a.insert(c,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=vs();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,oe()))}populateOverlays(e,r,n){const s=[];return n.forEach(i=>{r.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,c)=>{r.set(a,c)})})}computeViews(e,r,n,s){let i=en();const a=Ka(),c=function(){return Ka()}();return r.forEach((u,d)=>{const f=n.get(d.key);s.has(d.key)&&(f===void 0||f.mutation instanceof Jn)?i=i.insert(d.key,d):f!==void 0?(a.set(d.key,f.mutation.getFieldMask()),Ga(f.mutation,d,f.mutation.getFieldMask(),ye.now())):a.set(d.key,Vt.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((d,f)=>a.set(d,f)),r.forEach((d,f)=>c.set(d,new EA(f,a.get(d)??null))),c))}recalculateAndSaveOverlays(e,r){const n=Ka();let s=new Ce((a,c)=>a-c),i=oe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const c of a)c.keys().forEach(u=>{const d=r.get(u);if(d===null)return;let f=n.get(u)||Vt.empty();f=c.applyToLocalView(d,f),n.set(u,f);const p=(s.get(c.batchId)||oe()).add(u);s=s.insert(c.batchId,p)})}).next(()=>{const a=[],c=s.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),d=u.key,f=u.value,p=Vw();f.forEach(g=>{if(!i.has(g)){const w=Bw(r.get(g),n.get(g));w!==null&&p.set(g,w),i=i.add(g)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,p))}return M.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,s){return function(a){return Q.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):Rw(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-i.size):M.resolve(vs());let c=po,u=i;return a.next(d=>M.forEach(d,(f,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),i.get(f)?M.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{u=u.insert(f,g)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,u,d,oe())).next(f=>({batchId:c,changes:Ow(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Q(r)).next(n=>{let s=Ra();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const i=r.collectionGroup;let a=Ra();return this.indexManager.getCollectionParents(e,i).next(c=>M.forEach(c,u=>{const d=function(p,g){return new Hi(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(r,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,n,s).next(f=>{f.forEach((p,g)=>{a=a.insert(p,g)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,s))).next(a=>{i.forEach((u,d)=>{const f=d.getKey();a.get(f)===null&&(a=a.insert(f,dt.newInvalidDocument(f)))});let c=Ra();return a.forEach((u,d)=>{const f=i.get(u);f!==void 0&&Ga(f.mutation,d,Vt.empty(),ye.now()),ju(r,d)&&(c=c.insert(u,d))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TA{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return M.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:Nr(s.createTime)}}(r)),M.resolve()}getNamedQuery(e,r){return M.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(s){return{name:s.name,query:mA(s.bundledQuery),readTime:Nr(s.readTime)}}(r)),M.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IA{constructor(){this.overlays=new Ce(Q.comparator),this.qr=new Map}getOverlay(e,r){return M.resolve(this.overlays.get(r))}getOverlays(e,r){const n=vs();return M.forEach(r,s=>this.getOverlay(e,s).next(i=>{i!==null&&n.set(s,i)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((s,i)=>{this.St(e,r,i)}),M.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.qr.get(n);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(n)),M.resolve()}getOverlaysForCollection(e,r,n){const s=vs(),i=r.length+1,a=new Q(r.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const u=c.getNext().value,d=u.getKey();if(!r.isPrefixOf(d.path))break;d.path.length===i&&u.largestBatchId>n&&s.set(u.getKey(),u)}return M.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let i=new Ce((d,f)=>d-f);const a=this.overlays.getIterator();for(;a.hasNext();){const d=a.getNext().value;if(d.getKey().getCollectionGroup()===r&&d.largestBatchId>n){let f=i.get(d.largestBatchId);f===null&&(f=vs(),i=i.insert(d.largestBatchId,f)),f.set(d.getKey(),d)}}const c=vs(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,f)=>c.set(d,f)),!(c.size()>=s)););return M.resolve(c)}St(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const a=this.qr.get(s.largestBatchId).delete(n.key);this.qr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new qN(r,n));let i=this.qr.get(r);i===void 0&&(i=oe(),this.qr.set(r,i)),this.qr.set(r,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SA{constructor(){this.sessionToken=nt.EMPTY_BYTE_STRING}getSessionToken(e){return M.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,M.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bm{constructor(){this.Qr=new qe(He.$r),this.Ur=new qe(He.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new He(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new He(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new Q(new ve([])),n=new He(r,e),s=new He(r,e+1),i=[];return this.Ur.forEachInRange([n,s],a=>{this.Gr(a),i.push(a.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new Q(new ve([])),n=new He(r,e),s=new He(r,e+1);let i=oe();return this.Ur.forEachInRange([n,s],a=>{i=i.add(a.key)}),i}containsKey(e){const r=new He(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class He{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return Q.comparator(e.key,r.key)||ae(e.Yr,r.Yr)}static Kr(e,r){return ae(e.Yr,r.Yr)||Q.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NA{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new qe(He.$r)}checkEmpty(e){return M.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new $N(i,r,n,s);this.mutationQueue.push(a);for(const c of s)this.Zr=this.Zr.add(new He(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return M.resolve(a)}lookupMutationBatch(e,r){return M.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.ei(n),i=s<0?0:s;return M.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return M.resolve(this.mutationQueue.length===0?jm:this.tr-1)}getAllMutationBatches(e){return M.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new He(r,0),s=new He(r,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,s],a=>{const c=this.Xr(a.Yr);i.push(c)}),M.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new qe(ae);return r.forEach(s=>{const i=new He(s,0),a=new He(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],c=>{n=n.add(c.Yr)})}),M.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let i=n;Q.isDocumentKey(i)||(i=i.child(""));const a=new He(new Q(i),0);let c=new qe(ae);return this.Zr.forEachWhile(u=>{const d=u.key.path;return!!n.isPrefixOf(d)&&(d.length===s&&(c=c.add(u.Yr)),!0)},a),M.resolve(this.ti(c))}ti(e){const r=[];return e.forEach(n=>{const s=this.Xr(n);s!==null&&r.push(s)}),r}removeMutationBatch(e,r){fe(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return M.forEach(r.mutations,s=>{const i=new He(s.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new He(r,0),s=this.Zr.firstAfterOrEqual(n);return M.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,M.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AA{constructor(e){this.ri=e,this.docs=function(){return new Ce(Q.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),i=s?s.size:0,a=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return M.resolve(n?n.document.mutableCopy():dt.newInvalidDocument(r))}getEntries(e,r){let n=en();return r.forEach(s=>{const i=this.docs.get(s);n=n.insert(s,i?i.document.mutableCopy():dt.newInvalidDocument(s))}),M.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let i=en();const a=r.path,c=new Q(a.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:d,value:{document:f}}=u.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||sN(nN(f),n)<=0||(s.has(f.key)||ju(r,f))&&(i=i.insert(f.key,f.mutableCopy()))}return M.resolve(i)}getAllFromCollectionGroup(e,r,n,s){Z(9500)}ii(e,r){return M.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new CA(this)}getSize(e){return M.resolve(this.size)}}class CA extends kA{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(n)}),M.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RA{constructor(e){this.persistence=e,this.si=new zs(r=>Vm(r),Mm),this.lastRemoteSnapshotVersion=ee.min(),this.highestTargetId=0,this.oi=0,this._i=new Bm,this.targetCount=0,this.ai=Vi.ur()}forEachTarget(e,r){return this.si.forEach((n,s)=>r(s)),M.resolve()}getLastRemoteSnapshotVersion(e){return M.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return M.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),M.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),M.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new Vi(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,M.resolve()}updateTargetData(e,r){return this.Pr(r),M.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,M.resolve()}removeTargets(e,r,n){let s=0;const i=[];return this.si.forEach((a,c)=>{c.sequenceNumber<=r&&n.get(c.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)}),M.waitFor(i).next(()=>s)}getTargetCount(e){return M.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return M.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),M.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const s=this.persistence.referenceDelegate,i=[];return s&&r.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),M.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),M.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return M.resolve(n)}containsKey(e,r){return M.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t1{constructor(e,r){this.ui={},this.overlays={},this.ci=new Nu(0),this.li=!1,this.li=!0,this.hi=new SA,this.referenceDelegate=e(this),this.Pi=new RA(this),this.indexManager=new pA,this.remoteDocumentCache=function(s){return new AA(s)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new fA(r),this.Ii=new TA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new IA,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new NA(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){K("MemoryPersistence","Starting transaction:",e);const s=new PA(this.ci.next());return this.referenceDelegate.Ei(),n(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,r){return M.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class PA extends aN{constructor(e){super(),this.currentSequenceNumber=e}}class $m{constructor(e){this.persistence=e,this.Ri=new Bm,this.Vi=null}static mi(e){return new $m(e)}get fi(){if(this.Vi)return this.Vi;throw Z(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),M.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),M.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),M.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(s=>this.fi.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return M.forEach(this.fi,n=>{const s=Q.fromPath(n);return this.gi(e,s).next(i=>{i||r.removeEntry(s,ee.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return M.or([()=>M.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class Xc{constructor(e,r){this.persistence=e,this.pi=new zs(n=>cN(n.path),(n,s)=>n.isEqual(s)),this.garbageCollector=wA(this,r)}static mi(e,r){return new Xc(e,r)}Ei(){}di(e){return M.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(s=>n+s))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return M.forEach(this.pi,(n,s)=>this.br(e,n,s).next(i=>i?M.resolve():r(s)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,a=>this.br(e,a,r).next(c=>{c||(n++,i.removeEntry(a,ee.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),M.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),M.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),M.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),M.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=oc(e.data.value)),r}br(e,r,n){return M.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const s=this.pi.get(r);return M.resolve(s!==void 0&&s>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qm{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=s}static As(e,r){let n=oe(),s=oe();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new qm(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jA{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DA{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return i2()?8:oN(ft())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,s){const i={result:null};return this.ys(e,r).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.ws(e,r,s,n).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new jA;return this.Ss(e,r,a).next(c=>{if(i.result=c,this.Vs)return this.bs(e,r,a,c.size)})}).next(()=>i.result)}bs(e,r,n,s){return n.documentReadCount<this.fs?(Xs()<=ie.DEBUG&&K("QueryEngine","SDK will not create cache indexes for query:",Js(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),M.resolve()):(Xs()<=ie.DEBUG&&K("QueryEngine","Query:",Js(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.gs*s?(Xs()<=ie.DEBUG&&K("QueryEngine","The SDK decides to create cache indexes for query:",Js(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Sr(r))):M.resolve())}ys(e,r){if(ly(r))return M.resolve(null);let n=Sr(r);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=uf(r,null,"F"),n=Sr(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const a=oe(...i);return this.ps.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,n).next(u=>{const d=this.Ds(r,c);return this.Cs(r,d,a,u.readTime)?this.ys(e,uf(r,null,"F")):this.vs(e,d,r,u)}))})))}ws(e,r,n,s){return ly(r)||s.isEqual(ee.min())?M.resolve(null):this.ps.getDocuments(e,n).next(i=>{const a=this.Ds(r,i);return this.Cs(r,a,n,s)?M.resolve(null):(Xs()<=ie.DEBUG&&K("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Js(r)),this.vs(e,a,r,rN(s,po)).next(c=>c))})}Ds(e,r){let n=new qe(jw(e));return r.forEach((s,i)=>{ju(e,i)&&(n=n.add(i))}),n}Cs(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,r,n){return Xs()<=ie.DEBUG&&K("QueryEngine","Using full collection scan to execute query:",Js(r)),this.ps.getDocumentsMatchingQuery(e,r,zn.min(),n)}vs(e,r,n,s){return this.ps.getDocumentsMatchingQuery(e,n,s).next(i=>(r.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hm="LocalStore",OA=3e8;class VA{constructor(e,r,n,s){this.persistence=e,this.Fs=r,this.serializer=s,this.Ms=new Ce(ae),this.xs=new zs(i=>Vm(i),Mm),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new bA(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function MA(t,e,r,n){return new VA(t,e,r,n)}async function r1(t,e){const r=te(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(i=>(s=i,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(i=>{const a=[],c=[];let u=oe();for(const d of s){a.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}for(const d of i){c.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}return r.localDocuments.getDocuments(n,u).next(d=>({Ls:d,removedBatchIds:a,addedBatchIds:c}))})})}function LA(t,e){const r=te(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),i=r.Ns.newChangeBuffer({trackRemovals:!0});return function(c,u,d,f){const p=d.batch,g=p.keys();let w=M.resolve();return g.forEach(N=>{w=w.next(()=>f.getEntry(u,N)).next(S=>{const C=d.docVersions.get(N);fe(C!==null,48541),S.version.compareTo(C)<0&&(p.applyToRemoteDocument(S,d),S.isValidDocument()&&(S.setReadTime(d.commitVersion),f.addEntry(S)))})}),w.next(()=>c.mutationQueue.removeMutationBatch(u,p))}(r,n,e,i).next(()=>i.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(c){let u=oe();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(u=u.add(c.batch.mutations[d].key));return u}(e))).next(()=>r.localDocuments.getDocuments(n,s))})}function n1(t){const e=te(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function FA(t,e){const r=te(t),n=e.snapshotVersion;let s=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=r.Ns.newChangeBuffer({trackRemovals:!0});s=r.Ms;const c=[];e.targetChanges.forEach((f,p)=>{const g=s.get(p);if(!g)return;c.push(r.Pi.removeMatchingKeys(i,f.removedDocuments,p).next(()=>r.Pi.addMatchingKeys(i,f.addedDocuments,p)));let w=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(p)!==null?w=w.withResumeToken(nt.EMPTY_BYTE_STRING,ee.min()).withLastLimboFreeSnapshotVersion(ee.min()):f.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(f.resumeToken,n)),s=s.insert(p,w),function(S,C,T){return S.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=OA?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(g,w,f)&&c.push(r.Pi.updateTargetData(i,w))});let u=en(),d=oe();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&c.push(r.persistence.referenceDelegate.updateLimboDocument(i,f))}),c.push(UA(i,a,e.documentUpdates).next(f=>{u=f.ks,d=f.qs})),!n.isEqual(ee.min())){const f=r.Pi.getLastRemoteSnapshotVersion(i).next(p=>r.Pi.setTargetsMetadata(i,i.currentSequenceNumber,n));c.push(f)}return M.waitFor(c).next(()=>a.apply(i)).next(()=>r.localDocuments.getLocalViewOfDocuments(i,u,d)).next(()=>u)}).then(i=>(r.Ms=s,i))}function UA(t,e,r){let n=oe(),s=oe();return r.forEach(i=>n=n.add(i)),e.getEntries(t,n).next(i=>{let a=en();return r.forEach((c,u)=>{const d=i.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(c)),u.isNoDocument()&&u.version.isEqual(ee.min())?(e.removeEntry(c,u.readTime),a=a.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),a=a.insert(c,u)):K(Hm,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)}),{ks:a,qs:s}})}function zA(t,e){const r=te(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=jm),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function BA(t,e){const r=te(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Pi.getTargetData(n,e).next(i=>i?(s=i,M.resolve(s)):r.Pi.allocateTargetId(n).next(a=>(s=new Tn(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.Ms.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function pf(t,e,r){const n=te(t),s=n.Ms.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,a=>n.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!qi(a))throw a;K(Hm,`Failed to update sequence numbers for target ${e}: ${a}`)}n.Ms=n.Ms.remove(e),n.xs.delete(s.target)}function wy(t,e,r){const n=te(t);let s=ee.min(),i=oe();return n.persistence.runTransaction("Execute query","readwrite",a=>function(u,d,f){const p=te(u),g=p.xs.get(f);return g!==void 0?M.resolve(p.Ms.get(g)):p.Pi.getTargetData(d,f)}(n,a,Sr(e)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(a,c.targetId).next(u=>{i=u})}).next(()=>n.Fs.getDocumentsMatchingQuery(a,e,r?s:ee.min(),r?i:oe())).next(c=>($A(n,SN(e),c),{documents:c,Qs:i})))}function $A(t,e,r){let n=t.Os.get(e)||ee.min();r.forEach((s,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),t.Os.set(e,n)}class ky{constructor(){this.activeTargetIds=jN()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class qA{constructor(){this.Mo=new ky,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new ky,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HA{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ey="ConnectivityMonitor";class by{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){K(Ey,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){K(Ey,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zl=null;function gf(){return zl===null?zl=function(){return 268435456+Math.round(2147483648*Math.random())}():zl++,"0x"+zl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gd="RestConnection",WA={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class KA{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${s}`,this.Wo=this.databaseId.database===Wc?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Go(e,r,n,s,i){const a=gf(),c=this.zo(e,r.toUriEncodedString());K(Gd,`Sending RPC '${e}' ${a}:`,c,n);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,s,i);const{host:d}=new URL(c),f=Fs(d);return this.Jo(e,c,u,n,f).then(p=>(K(Gd,`Received RPC '${e}' ${a}: `,p),p),p=>{throw Pi(Gd,`RPC '${e}' ${a} failed with error: `,p,"url: ",c,"request:",n),p})}Ho(e,r,n,s,i,a){return this.Go(e,r,n,s,i)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Bi}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,i)=>e[i]=s),n&&n.headers.forEach((s,i)=>e[i]=s)}zo(e,r){const n=WA[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GA{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lt="WebChannelConnection";class QA extends KA{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,s,i){const a=gf();return new Promise((c,u)=>{const d=new iw;d.setWithCredentials(!0),d.listenOnce(aw.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case ac.NO_ERROR:const p=d.getResponseJson();K(lt,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(p)),c(p);break;case ac.TIMEOUT:K(lt,`RPC '${e}' ${a} timed out`),u(new H(V.DEADLINE_EXCEEDED,"Request time out"));break;case ac.HTTP_ERROR:const g=d.getStatus();if(K(lt,`RPC '${e}' ${a} failed with status:`,g,"response text:",d.getResponseText()),g>0){let w=d.getResponseJson();Array.isArray(w)&&(w=w[0]);const N=w==null?void 0:w.error;if(N&&N.status&&N.message){const S=function(T){const _=T.toLowerCase().replace(/_/g,"-");return Object.values(V).indexOf(_)>=0?_:V.UNKNOWN}(N.status);u(new H(S,N.message))}else u(new H(V.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new H(V.UNAVAILABLE,"Connection failed."));break;default:Z(9055,{l_:e,streamId:a,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{K(lt,`RPC '${e}' ${a} completed.`)}});const f=JSON.stringify(s);K(lt,`RPC '${e}' ${a} sending request:`,s),d.send(r,"POST",f,n,15)})}T_(e,r,n){const s=gf(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=cw(),c=lw(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,r,n),u.encodeInitMessageHeaders=!0;const f=i.join("");K(lt,`Creating RPC '${e}' stream ${s}: ${f}`,u);const p=a.createWebChannel(f,u);this.I_(p);let g=!1,w=!1;const N=new GA({Yo:C=>{w?K(lt,`Not sending because RPC '${e}' stream ${s} is closed:`,C):(g||(K(lt,`Opening RPC '${e}' stream ${s} transport.`),p.open(),g=!0),K(lt,`RPC '${e}' stream ${s} sending:`,C),p.send(C))},Zo:()=>p.close()}),S=(C,T,_)=>{C.listen(T,k=>{try{_(k)}catch(j){setTimeout(()=>{throw j},0)}})};return S(p,Ca.EventType.OPEN,()=>{w||(K(lt,`RPC '${e}' stream ${s} transport opened.`),N.o_())}),S(p,Ca.EventType.CLOSE,()=>{w||(w=!0,K(lt,`RPC '${e}' stream ${s} transport closed`),N.a_(),this.E_(p))}),S(p,Ca.EventType.ERROR,C=>{w||(w=!0,Pi(lt,`RPC '${e}' stream ${s} transport errored. Name:`,C.name,"Message:",C.message),N.a_(new H(V.UNAVAILABLE,"The operation could not be completed")))}),S(p,Ca.EventType.MESSAGE,C=>{var T;if(!w){const _=C.data[0];fe(!!_,16349);const k=_,j=(k==null?void 0:k.error)||((T=k[0])==null?void 0:T.error);if(j){K(lt,`RPC '${e}' stream ${s} received error:`,j);const F=j.status;let D=function(E){const b=Me[E];if(b!==void 0)return qw(b)}(F),v=j.message;D===void 0&&(D=V.INTERNAL,v="Unknown error status: "+F+" with message "+j.message),w=!0,N.a_(new H(D,v)),p.close()}else K(lt,`RPC '${e}' stream ${s} received:`,_),N.u_(_)}}),S(c,ow.STAT_EVENT,C=>{C.stat===rf.PROXY?K(lt,`RPC '${e}' stream ${s} detected buffering proxy`):C.stat===rf.NOPROXY&&K(lt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{N.__()},0),N}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function Qd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lu(t){return new ZN(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s1{constructor(e,r,n=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),s=Math.max(0,r-n);s>0&&K("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ty="PersistentStream";class i1{constructor(e,r,n,s,i,a,c,u){this.Mi=e,this.S_=n,this.b_=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new s1(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===V.RESOURCE_EXHAUSTED?(Zr(r.toString()),Zr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===V.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.D_===r&&this.G_(n,s)},n=>{e(()=>{const s=new H(V.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(s)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{n(()=>this.z_(s))}),this.stream.onMessage(s=>{n(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return K(Ty,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(K(Ty,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class YA extends i1{constructor(e,r,n,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,a),this.serializer=i}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=rA(this.serializer,e),n=function(i){if(!("targetChange"in i))return ee.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?ee.min():a.readTime?Nr(a.readTime):ee.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=mf(this.serializer),r.addTarget=function(i,a){let c;const u=a.target;if(c=lf(u)?{documents:iA(i,u)}:{query:aA(i,u).ft},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=Kw(i,a.resumeToken);const d=df(i,a.expectedCount);d!==null&&(c.expectedCount=d)}else if(a.snapshotVersion.compareTo(ee.min())>0){c.readTime=Yc(i,a.snapshotVersion.toTimestamp());const d=df(i,a.expectedCount);d!==null&&(c.expectedCount=d)}return c}(this.serializer,e);const n=lA(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=mf(this.serializer),r.removeTarget=e,this.q_(r)}}class XA extends i1{constructor(e,r,n,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return fe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,fe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){fe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=sA(e.writeResults,e.commitTime),n=Nr(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=mf(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>nA(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JA{}class ZA extends JA{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new H(V.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Go(e,hf(r,n),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new H(V.UNKNOWN,i.toString())})}Ho(e,r,n,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.Ho(e,hf(r,n),s,a,c,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new H(V.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class eC{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Zr(r),this.aa=!1):K("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const js="RemoteStore";class tC{constructor(e,r,n,s,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(a=>{n.enqueueAndForget(async()=>{Bs(this)&&(K(js,"Restarting streams for network reachability change."),await async function(u){const d=te(u);d.Ea.add(4),await Fo(d),d.Ra.set("Unknown"),d.Ea.delete(4),await Fu(d)}(this))})}),this.Ra=new eC(n,s)}}async function Fu(t){if(Bs(t))for(const e of t.da)await e(!0)}async function Fo(t){for(const e of t.da)await e(!1)}function a1(t,e){const r=te(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),Qm(r)?Gm(r):Wi(r).O_()&&Km(r,e))}function Wm(t,e){const r=te(t),n=Wi(r);r.Ia.delete(e),n.O_()&&o1(r,e),r.Ia.size===0&&(n.O_()?n.L_():Bs(r)&&r.Ra.set("Unknown"))}function Km(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ee.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Wi(t).Y_(e)}function o1(t,e){t.Va.Ue(e),Wi(t).Z_(e)}function Gm(t){t.Va=new QN({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Wi(t).start(),t.Ra.ua()}function Qm(t){return Bs(t)&&!Wi(t).x_()&&t.Ia.size>0}function Bs(t){return te(t).Ea.size===0}function l1(t){t.Va=void 0}async function rC(t){t.Ra.set("Online")}async function nC(t){t.Ia.forEach((e,r)=>{Km(t,e)})}async function sC(t,e){l1(t),Qm(t)?(t.Ra.ha(e),Gm(t)):t.Ra.set("Unknown")}async function iC(t,e,r){if(t.Ra.set("Online"),e instanceof Ww&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const c of i.targetIds)s.Ia.has(c)&&(await s.remoteSyncer.rejectListen(c,a),s.Ia.delete(c),s.Va.removeTarget(c))}(t,e)}catch(n){K(js,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Jc(t,n)}else if(e instanceof uc?t.Va.Ze(e):e instanceof Hw?t.Va.st(e):t.Va.tt(e),!r.isEqual(ee.min()))try{const n=await n1(t.localStore);r.compareTo(n)>=0&&await function(i,a){const c=i.Va.Tt(a);return c.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const f=i.Ia.get(d);f&&i.Ia.set(d,f.withResumeToken(u.resumeToken,a))}}),c.targetMismatches.forEach((u,d)=>{const f=i.Ia.get(u);if(!f)return;i.Ia.set(u,f.withResumeToken(nt.EMPTY_BYTE_STRING,f.snapshotVersion)),o1(i,u);const p=new Tn(f.target,u,d,f.sequenceNumber);Km(i,p)}),i.remoteSyncer.applyRemoteEvent(c)}(t,r)}catch(n){K(js,"Failed to raise snapshot:",n),await Jc(t,n)}}async function Jc(t,e,r){if(!qi(e))throw e;t.Ea.add(1),await Fo(t),t.Ra.set("Offline"),r||(r=()=>n1(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{K(js,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await Fu(t)})}function c1(t,e){return e().catch(r=>Jc(t,r,e))}async function Uu(t){const e=te(t),r=Hn(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:jm;for(;aC(e);)try{const s=await zA(e.localStore,n);if(s===null){e.Ta.length===0&&r.L_();break}n=s.batchId,oC(e,s)}catch(s){await Jc(e,s)}u1(e)&&d1(e)}function aC(t){return Bs(t)&&t.Ta.length<10}function oC(t,e){t.Ta.push(e);const r=Hn(t);r.O_()&&r.X_&&r.ea(e.mutations)}function u1(t){return Bs(t)&&!Hn(t).x_()&&t.Ta.length>0}function d1(t){Hn(t).start()}async function lC(t){Hn(t).ra()}async function cC(t){const e=Hn(t);for(const r of t.Ta)e.ea(r.mutations)}async function uC(t,e,r){const n=t.Ta.shift(),s=Fm.from(n,e,r);await c1(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Uu(t)}async function dC(t,e){e&&Hn(t).X_&&await async function(n,s){if(function(a){return WN(a)&&a!==V.ABORTED}(s.code)){const i=n.Ta.shift();Hn(n).B_(),await c1(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Uu(n)}}(t,e),u1(t)&&d1(t)}async function Iy(t,e){const r=te(t);r.asyncQueue.verifyOperationInProgress(),K(js,"RemoteStore received new credentials");const n=Bs(r);r.Ea.add(3),await Fo(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await Fu(r)}async function hC(t,e){const r=te(t);e?(r.Ea.delete(2),await Fu(r)):e||(r.Ea.add(2),await Fo(r),r.Ra.set("Unknown"))}function Wi(t){return t.ma||(t.ma=function(r,n,s){const i=te(r);return i.sa(),new YA(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:rC.bind(null,t),t_:nC.bind(null,t),r_:sC.bind(null,t),H_:iC.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Qm(t)?Gm(t):t.Ra.set("Unknown")):(await t.ma.stop(),l1(t))})),t.ma}function Hn(t){return t.fa||(t.fa=function(r,n,s){const i=te(r);return i.sa(),new XA(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:lC.bind(null,t),r_:dC.bind(null,t),ta:cC.bind(null,t),na:uC.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Uu(t)):(await t.fa.stop(),t.Ta.length>0&&(K(js,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ym{constructor(e,r,n,s,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new Wr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,i){const a=Date.now()+n,c=new Ym(e,r,a,s,i);return c.start(n),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new H(V.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Xm(t,e){if(Zr("AsyncQueue",`${e}: ${t}`),qi(t))return new H(V.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei{static emptySet(e){return new Ei(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||Q.comparator(r.key,n.key):(r,n)=>Q.comparator(r.key,n.key),this.keyedMap=Ra(),this.sortedSet=new Ce(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Ei)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Ei;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sy{constructor(){this.ga=new Ce(Q.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):Z(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class Mi{constructor(e,r,n,s,i,a,c,u,d){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,r,n,s,i){const a=[];return r.forEach(c=>{a.push({type:0,doc:c})}),new Mi(e,r,Ei.emptySet(r),a,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Pu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fC{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class mC{constructor(){this.queries=Ny(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const s=te(r),i=s.queries;s.queries=Ny(),i.forEach((a,c)=>{for(const u of c.Sa)u.onError(n)})})(this,new H(V.ABORTED,"Firestore shutting down"))}}function Ny(){return new zs(t=>Pw(t),Pu)}async function Jm(t,e){const r=te(t);let n=3;const s=e.query;let i=r.queries.get(s);i?!i.ba()&&e.Da()&&(n=2):(i=new fC,n=e.Da()?0:1);try{switch(n){case 0:i.wa=await r.onListen(s,!0);break;case 1:i.wa=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(a){const c=Xm(a,`Initialization of query '${Js(e.query)}' failed`);return void e.onError(c)}r.queries.set(s,i),i.Sa.push(e),e.va(r.onlineState),i.wa&&e.Fa(i.wa)&&ep(r)}async function Zm(t,e){const r=te(t),n=e.query;let s=3;const i=r.queries.get(n);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function pC(t,e){const r=te(t);let n=!1;for(const s of e){const i=s.query,a=r.queries.get(i);if(a){for(const c of a.Sa)c.Fa(s)&&(n=!0);a.wa=s}}n&&ep(r)}function gC(t,e,r){const n=te(t),s=n.queries.get(e);if(s)for(const i of s.Sa)i.onError(r);n.queries.delete(e)}function ep(t){t.Ca.forEach(e=>{e.next()})}var yf,Ay;(Ay=yf||(yf={})).Ma="default",Ay.Cache="cache";class tp{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new Mi(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=Mi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==yf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h1{constructor(e){this.key=e}}class f1{constructor(e){this.key=e}}class yC{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=oe(),this.mutatedKeys=oe(),this.eu=jw(e),this.tu=new Ei(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new Sy,s=r?r.tu:this.tu;let i=r?r.mutatedKeys:this.mutatedKeys,a=s,c=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((f,p)=>{const g=s.get(f),w=ju(this.query,p)?p:null,N=!!g&&this.mutatedKeys.has(g.key),S=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let C=!1;g&&w?g.data.isEqual(w.data)?N!==S&&(n.track({type:3,doc:w}),C=!0):this.su(g,w)||(n.track({type:2,doc:w}),C=!0,(u&&this.eu(w,u)>0||d&&this.eu(w,d)<0)&&(c=!0)):!g&&w?(n.track({type:0,doc:w}),C=!0):g&&!w&&(n.track({type:1,doc:g}),C=!0,(u||d)&&(c=!0)),C&&(w?(a=a.add(w),i=S?i.add(f):i.delete(f)):(a=a.delete(f),i=i.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),i=i.delete(f.key),n.track({type:1,doc:f})}return{tu:a,iu:n,Cs:c,mutatedKeys:i}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((f,p)=>function(w,N){const S=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Z(20277,{Rt:C})}};return S(w)-S(N)}(f.type,p.type)||this.eu(f.doc,p.doc)),this.ou(n),s=s??!1;const c=r&&!s?this._u():[],u=this.Xa.size===0&&this.current&&!s?1:0,d=u!==this.Za;return this.Za=u,a.length!==0||d?{snapshot:new Mi(this.query,e.tu,i,a,e.mutatedKeys,u===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Sy,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=oe(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new f1(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new h1(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=oe();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return Mi.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const rp="SyncEngine";class vC{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class xC{constructor(e){this.key=e,this.hu=!1}}class _C{constructor(e,r,n,s,i,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new zs(c=>Pw(c),Pu),this.Iu=new Map,this.Eu=new Set,this.du=new Ce(Q.comparator),this.Au=new Map,this.Ru=new Bm,this.Vu={},this.mu=new Map,this.fu=Vi.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function wC(t,e,r=!0){const n=x1(t);let s;const i=n.Tu.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await m1(n,e,r,!0),s}async function kC(t,e){const r=x1(t);await m1(r,e,!0,!1)}async function m1(t,e,r,n){const s=await BA(t.localStore,Sr(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,r);let c;return n&&(c=await EC(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&r&&a1(t.remoteStore,s),c}async function EC(t,e,r,n,s){t.pu=(p,g,w)=>async function(S,C,T,_){let k=C.view.ru(T);k.Cs&&(k=await wy(S.localStore,C.query,!1).then(({documents:v})=>C.view.ru(v,k)));const j=_&&_.targetChanges.get(C.targetId),F=_&&_.targetMismatches.get(C.targetId)!=null,D=C.view.applyChanges(k,S.isPrimaryClient,j,F);return Ry(S,C.targetId,D.au),D.snapshot}(t,p,g,w);const i=await wy(t.localStore,e,!0),a=new yC(e,i.Qs),c=a.ru(i.documents),u=Lo.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),d=a.applyChanges(c,t.isPrimaryClient,u);Ry(t,r,d.au);const f=new vC(e,r,a);return t.Tu.set(e,f),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),d.snapshot}async function bC(t,e,r){const n=te(t),s=n.Tu.get(e),i=n.Iu.get(s.targetId);if(i.length>1)return n.Iu.set(s.targetId,i.filter(a=>!Pu(a,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await pf(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&Wm(n.remoteStore,s.targetId),vf(n,s.targetId)}).catch($i)):(vf(n,s.targetId),await pf(n.localStore,s.targetId,!0))}async function TC(t,e){const r=te(t),n=r.Tu.get(e),s=r.Iu.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Wm(r.remoteStore,n.targetId))}async function IC(t,e,r){const n=jC(t);try{const s=await function(a,c){const u=te(a),d=ye.now(),f=c.reduce((w,N)=>w.add(N.key),oe());let p,g;return u.persistence.runTransaction("Locally write mutations","readwrite",w=>{let N=en(),S=oe();return u.Ns.getEntries(w,f).next(C=>{N=C,N.forEach((T,_)=>{_.isValidDocument()||(S=S.add(T))})}).next(()=>u.localDocuments.getOverlayedDocuments(w,N)).next(C=>{p=C;const T=[];for(const _ of c){const k=zN(_,p.get(_.key).overlayedDocument);k!=null&&T.push(new Jn(_.key,k,bw(k.value.mapValue),Nt.exists(!0)))}return u.mutationQueue.addMutationBatch(w,d,T,c)}).next(C=>{g=C;const T=C.applyToLocalDocumentSet(p,S);return u.documentOverlayCache.saveOverlays(w,C.batchId,T)})}).then(()=>({batchId:g.batchId,changes:Ow(p)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(a,c,u){let d=a.Vu[a.currentUser.toKey()];d||(d=new Ce(ae)),d=d.insert(c,u),a.Vu[a.currentUser.toKey()]=d}(n,s.batchId,r),await Uo(n,s.changes),await Uu(n.remoteStore)}catch(s){const i=Xm(s,"Failed to persist write");r.reject(i)}}async function p1(t,e){const r=te(t);try{const n=await FA(r.localStore,e);e.targetChanges.forEach((s,i)=>{const a=r.Au.get(i);a&&(fe(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?a.hu=!0:s.modifiedDocuments.size>0?fe(a.hu,14607):s.removedDocuments.size>0&&(fe(a.hu,42227),a.hu=!1))}),await Uo(r,n,e)}catch(n){await $i(n)}}function Cy(t,e,r){const n=te(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Tu.forEach((i,a)=>{const c=a.view.va(e);c.snapshot&&s.push(c.snapshot)}),function(a,c){const u=te(a);u.onlineState=c;let d=!1;u.queries.forEach((f,p)=>{for(const g of p.Sa)g.va(c)&&(d=!0)}),d&&ep(u)}(n.eventManager,e),s.length&&n.Pu.H_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function SC(t,e,r){const n=te(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Au.get(e),i=s&&s.key;if(i){let a=new Ce(Q.comparator);a=a.insert(i,dt.newNoDocument(i,ee.min()));const c=oe().add(i),u=new Mu(ee.min(),new Map,new Ce(ae),a,c);await p1(n,u),n.du=n.du.remove(i),n.Au.delete(e),np(n)}else await pf(n.localStore,e,!1).then(()=>vf(n,e,r)).catch($i)}async function NC(t,e){const r=te(t),n=e.batch.batchId;try{const s=await LA(r.localStore,e);y1(r,n,null),g1(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Uo(r,s)}catch(s){await $i(s)}}async function AC(t,e,r){const n=te(t);try{const s=await function(a,c){const u=te(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let f;return u.mutationQueue.lookupMutationBatch(d,c).next(p=>(fe(p!==null,37113),f=p.keys(),u.mutationQueue.removeMutationBatch(d,p))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,f,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,f)).next(()=>u.localDocuments.getDocuments(d,f))})}(n.localStore,e);y1(n,e,r),g1(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Uo(n,s)}catch(s){await $i(s)}}function g1(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function y1(t,e,r){const n=te(t);let s=n.Vu[n.currentUser.toKey()];if(s){const i=s.get(e);i&&(r?i.reject(r):i.resolve(),s=s.remove(e)),n.Vu[n.currentUser.toKey()]=s}}function vf(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||v1(t,n)})}function v1(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(Wm(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),np(t))}function Ry(t,e,r){for(const n of r)n instanceof h1?(t.Ru.addReference(n.key,e),CC(t,n)):n instanceof f1?(K(rp,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||v1(t,n.key)):Z(19791,{wu:n})}function CC(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(K(rp,"New document in limbo: "+r),t.Eu.add(n),np(t))}function np(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new Q(ve.fromString(e)),n=t.fu.next();t.Au.set(n,new xC(r)),t.du=t.du.insert(r,n),a1(t.remoteStore,new Tn(Sr(Ru(r.path)),n,"TargetPurposeLimboResolution",Nu.ce))}}async function Uo(t,e,r){const n=te(t),s=[],i=[],a=[];n.Tu.isEmpty()||(n.Tu.forEach((c,u)=>{a.push(n.pu(u,e,r).then(d=>{var f;if((d||r)&&n.isPrimaryClient){const p=d?!d.fromCache:(f=r==null?void 0:r.targetChanges.get(u.targetId))==null?void 0:f.current;n.sharedClientState.updateQueryState(u.targetId,p?"current":"not-current")}if(d){s.push(d);const p=qm.As(u.targetId,d);i.push(p)}}))}),await Promise.all(a),n.Pu.H_(s),await async function(u,d){const f=te(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>M.forEach(d,g=>M.forEach(g.Es,w=>f.persistence.referenceDelegate.addReference(p,g.targetId,w)).next(()=>M.forEach(g.ds,w=>f.persistence.referenceDelegate.removeReference(p,g.targetId,w)))))}catch(p){if(!qi(p))throw p;K(Hm,"Failed to update sequence numbers: "+p)}for(const p of d){const g=p.targetId;if(!p.fromCache){const w=f.Ms.get(g),N=w.snapshotVersion,S=w.withLastLimboFreeSnapshotVersion(N);f.Ms=f.Ms.insert(g,S)}}}(n.localStore,i))}async function RC(t,e){const r=te(t);if(!r.currentUser.isEqual(e)){K(rp,"User change. New user:",e.toKey());const n=await r1(r.localStore,e);r.currentUser=e,function(i,a){i.mu.forEach(c=>{c.forEach(u=>{u.reject(new H(V.CANCELLED,a))})}),i.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Uo(r,n.Ls)}}function PC(t,e){const r=te(t),n=r.Au.get(e);if(n&&n.hu)return oe().add(n.key);{let s=oe();const i=r.Iu.get(e);if(!i)return s;for(const a of i){const c=r.Tu.get(a);s=s.unionWith(c.view.nu)}return s}}function x1(t){const e=te(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=p1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=PC.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=SC.bind(null,e),e.Pu.H_=pC.bind(null,e.eventManager),e.Pu.yu=gC.bind(null,e.eventManager),e}function jC(t){const e=te(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=NC.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=AC.bind(null,e),e}class Zc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Lu(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return MA(this.persistence,new DA,e.initialUser,this.serializer)}Cu(e){return new t1($m.mi,this.serializer)}Du(e){return new qA}async terminate(){var e,r;(e=this.gcScheduler)==null||e.stop(),(r=this.indexBackfillerScheduler)==null||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Zc.provider={build:()=>new Zc};class DC extends Zc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){fe(this.persistence.referenceDelegate instanceof Xc,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new xA(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?wt.withCacheSize(this.cacheSizeBytes):wt.DEFAULT;return new t1(n=>Xc.mi(n,r),this.serializer)}}class xf{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Cy(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=RC.bind(null,this.syncEngine),await hC(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new mC}()}createDatastore(e){const r=Lu(e.databaseInfo.databaseId),n=function(i){return new QA(i)}(e.databaseInfo);return function(i,a,c,u){return new ZA(i,a,c,u)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,s,i,a,c){return new tC(n,s,i,a,c)}(this.localStore,this.datastore,e.asyncQueue,r=>Cy(this.syncEngine,r,0),function(){return by.v()?new by:new HA}())}createSyncEngine(e,r){return function(s,i,a,c,u,d,f){const p=new _C(s,i,a,c,u,d);return f&&(p.gu=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(s){const i=te(s);K(js,"RemoteStore shutting down."),i.Ea.add(5),await Fo(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(r=this.eventManager)==null||r.terminate()}}xf.provider={build:()=>new xf};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Zr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wn="FirestoreClient";class OC{constructor(e,r,n,s,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=ct.UNAUTHENTICATED,this.clientId=Pm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async a=>{K(Wn,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(K(Wn,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Wr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Xm(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Yd(t,e){t.asyncQueue.verifyOperationInProgress(),K(Wn,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await r1(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Py(t,e){t.asyncQueue.verifyOperationInProgress();const r=await VC(t);K(Wn,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>Iy(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,s)=>Iy(e.remoteStore,s)),t._onlineComponents=e}async function VC(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){K(Wn,"Using user provided OfflineComponentProvider");try{await Yd(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(s){return s.name==="FirebaseError"?s.code===V.FAILED_PRECONDITION||s.code===V.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;Pi("Error using user provided cache. Falling back to memory cache: "+r),await Yd(t,new Zc)}}else K(Wn,"Using default OfflineComponentProvider"),await Yd(t,new DC(void 0));return t._offlineComponents}async function _1(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(K(Wn,"Using user provided OnlineComponentProvider"),await Py(t,t._uninitializedComponentsProvider._online)):(K(Wn,"Using default OnlineComponentProvider"),await Py(t,new xf))),t._onlineComponents}function MC(t){return _1(t).then(e=>e.syncEngine)}async function eu(t){const e=await _1(t),r=e.eventManager;return r.onListen=wC.bind(null,e.syncEngine),r.onUnlisten=bC.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=kC.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=TC.bind(null,e.syncEngine),r}function LC(t,e,r={}){const n=new Wr;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,c,u,d){const f=new sp({next:g=>{f.Nu(),a.enqueueAndForget(()=>Zm(i,p));const w=g.docs.has(c);!w&&g.fromCache?d.reject(new H(V.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&g.fromCache&&u&&u.source==="server"?d.reject(new H(V.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(g)},error:g=>d.reject(g)}),p=new tp(Ru(c.path),f,{includeMetadataChanges:!0,qa:!0});return Jm(i,p)}(await eu(t),t.asyncQueue,e,r,n)),n.promise}function FC(t,e,r={}){const n=new Wr;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,c,u,d){const f=new sp({next:g=>{f.Nu(),a.enqueueAndForget(()=>Zm(i,p)),g.fromCache&&u.source==="server"?d.reject(new H(V.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(g)},error:g=>d.reject(g)}),p=new tp(c,f,{includeMetadataChanges:!0,qa:!0});return Jm(i,p)}(await eu(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w1(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jy=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k1="firestore.googleapis.com",Dy=!0;class Oy{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new H(V.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=k1,this.ssl=Dy}else this.host=e.host,this.ssl=e.ssl??Dy;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=e1;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<yA)throw new H(V.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}tN("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=w1(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new H(V.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new H(V.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new H(V.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class zu{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Oy({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new H(V.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new H(V.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Oy(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new HS;switch(n.type){case"firstParty":return new QS(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new H(V.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=jy.get(r);n&&(K("ComponentProvider","Removing Datastore"),jy.delete(r),n.terminate())}(this),Promise.resolve()}}function UC(t,e,r,n={}){var d;t=Ft(t,zu);const s=Fs(e),i=t._getSettings(),a={...i,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${r}`;s&&(vm(`https://${c}`),xm("Firestore",!0)),i.host!==k1&&i.host!==c&&Pi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...i,host:c,ssl:s,emulatorOptions:n};if(!Ns(u,a)&&(t._setSettings(u),n.mockUserToken)){let f,p;if(typeof n.mockUserToken=="string")f=n.mockUserToken,p=ct.MOCK_USER;else{f=v_(n.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const g=n.mockUserToken.sub||n.mockUserToken.user_id;if(!g)throw new H(V.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new ct(g)}t._authCredentials=new WS(new dw(f,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Zn(this.firestore,e,this._query)}}class Ve{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Mn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ve(this.firestore,e,this._key)}toJSON(){return{type:Ve._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(Vo(r,Ve._jsonSchema))return new Ve(e,n||null,new Q(ve.fromString(r.referencePath)))}}Ve._jsonSchemaVersion="firestore/documentReference/1.0",Ve._jsonSchema={type:Ue("string",Ve._jsonSchemaVersion),referencePath:Ue("string")};class Mn extends Zn{constructor(e,r,n){super(e,r,Ru(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ve(this.firestore,null,new Q(e))}withConverter(e){return new Mn(this.firestore,e,this._path)}}function Te(t,e,...r){if(t=Ae(t),hw("collection","path",e),t instanceof zu){const n=ve.fromString(e,...r);return G0(n),new Mn(t,null,n)}{if(!(t instanceof Ve||t instanceof Mn))throw new H(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(ve.fromString(e,...r));return G0(n),new Mn(t.firestore,null,n)}}function Be(t,e,...r){if(t=Ae(t),arguments.length===1&&(e=Pm.newId()),hw("doc","path",e),t instanceof zu){const n=ve.fromString(e,...r);return K0(n),new Ve(t,null,new Q(n))}{if(!(t instanceof Ve||t instanceof Mn))throw new H(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(ve.fromString(e,...r));return K0(n),new Ve(t.firestore,t instanceof Mn?t.converter:null,new Q(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vy="AsyncQueue";class My{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new s1(this,"async_queue_retry"),this._c=()=>{const n=Qd();n&&K(Vy,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=Qd();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=Qd();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new Wr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!qi(e))throw e;K(Vy,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,Zr("INTERNAL UNHANDLED ERROR: ",Ly(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const s=Ym.createAndSchedule(this,e,r,n,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&Z(47125,{Pc:Ly(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function Ly(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fy(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const s=r;for(const i of n)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class tn extends zu{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new My,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new My(e),this._firestoreClient=void 0,await e}}}function zC(t,e){const r=typeof t=="object"?t:km(),n=typeof t=="string"?t:Wc,s=Eu(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const i=p_("firestore");i&&UC(s,...i)}return s}function zo(t){if(t._terminated)throw new H(V.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||BC(t),t._firestoreClient}function BC(t){var n,s,i;const e=t._freezeSettings(),r=function(c,u,d,f){return new hN(c,u,d,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,w1(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((n=t._app)==null?void 0:n.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new OC(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(c){const u=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Gt(nt.fromBase64String(e))}catch(r){throw new H(V.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Gt(nt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Gt._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Vo(e,Gt._jsonSchema))return Gt.fromBase64String(e.bytes)}}Gt._jsonSchemaVersion="firestore/bytes/1.0",Gt._jsonSchema={type:Ue("string",Gt._jsonSchemaVersion),bytes:Ue("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new H(V.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new et(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new H(V.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new H(V.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ae(this._lat,e._lat)||ae(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ar._jsonSchemaVersion}}static fromJSON(e){if(Vo(e,Ar._jsonSchema))return new Ar(e.latitude,e.longitude)}}Ar._jsonSchemaVersion="firestore/geoPoint/1.0",Ar._jsonSchema={type:Ue("string",Ar._jsonSchemaVersion),latitude:Ue("number"),longitude:Ue("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Cr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Vo(e,Cr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new Cr(e.vectorValues);throw new H(V.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Cr._jsonSchemaVersion="firestore/vectorValue/1.0",Cr._jsonSchema={type:Ue("string",Cr._jsonSchemaVersion),vectorValues:Ue("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $C=/^__.*__$/;class qC{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Jn(e,this.data,this.fieldMask,r,this.fieldTransforms):new Mo(e,this.data,r,this.fieldTransforms)}}class E1{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new Jn(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function b1(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Z(40011,{Ac:t})}}class ip{constructor(e,r,n,s,i,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new ip({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const r=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){var s;const r=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return tu(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(b1(this.Ac)&&$C.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class HC{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Lu(e)}Cc(e,r,n,s=!1){return new ip({Ac:e,methodName:r,Dc:n,path:et.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function $u(t){const e=t._freezeSettings(),r=Lu(t._databaseId);return new HC(t._databaseId,!!e.ignoreUndefinedProperties,r)}function T1(t,e,r,n,s,i={}){const a=t.Cc(i.merge||i.mergeFields?2:0,e,r,s);op("Data must be an object, but it was:",a,n);const c=N1(n,a);let u,d;if(i.merge)u=new Vt(a.fieldMask),d=a.fieldTransforms;else if(i.mergeFields){const f=[];for(const p of i.mergeFields){const g=_f(e,p,r);if(!a.contains(g))throw new H(V.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);C1(f,g)||f.push(g)}u=new Vt(f),d=a.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,d=a.fieldTransforms;return new qC(new Et(c),u,d)}class qu extends Bu{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof qu}}class ap extends Bu{_toFieldTransform(e){return new MN(e.path,new _o)}isEqual(e){return e instanceof ap}}function I1(t,e,r,n){const s=t.Cc(1,e,r);op("Data must be an object, but it was:",s,n);const i=[],a=Et.empty();Xn(n,(u,d)=>{const f=lp(e,u,r);d=Ae(d);const p=s.yc(f);if(d instanceof qu)i.push(f);else{const g=$o(d,p);g!=null&&(i.push(f),a.set(f,g))}});const c=new Vt(i);return new E1(a,c,s.fieldTransforms)}function S1(t,e,r,n,s,i){const a=t.Cc(1,e,r),c=[_f(e,n,r)],u=[s];if(i.length%2!=0)throw new H(V.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)c.push(_f(e,i[g])),u.push(i[g+1]);const d=[],f=Et.empty();for(let g=c.length-1;g>=0;--g)if(!C1(d,c[g])){const w=c[g];let N=u[g];N=Ae(N);const S=a.yc(w);if(N instanceof qu)d.push(w);else{const C=$o(N,S);C!=null&&(d.push(w),f.set(w,C))}}const p=new Vt(d);return new E1(f,p,a.fieldTransforms)}function WC(t,e,r,n=!1){return $o(r,t.Cc(n?4:3,e))}function $o(t,e){if(A1(t=Ae(t)))return op("Unsupported field value:",e,t),N1(t,e);if(t instanceof Bu)return function(n,s){if(!b1(s.Ac))throw s.Sc(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,s){const i=[];let a=0;for(const c of n){let u=$o(c,s.wc(a));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),a++}return{arrayValue:{values:i}}}(t,e)}return function(n,s){if((n=Ae(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return DN(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=ye.fromDate(n);return{timestampValue:Yc(s.serializer,i)}}if(n instanceof ye){const i=new ye(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Yc(s.serializer,i)}}if(n instanceof Ar)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Gt)return{bytesValue:Kw(s.serializer,n._byteString)};if(n instanceof Ve){const i=s.databaseId,a=n.firestore._databaseId;if(!a.isEqual(i))throw s.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:zm(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof Cr)return function(a,c){return{mapValue:{fields:{[ww]:{stringValue:Ew},[Kc]:{arrayValue:{values:a.toArray().map(d=>{if(typeof d!="number")throw c.Sc("VectorValues must only contain numeric values.");return Lm(c.serializer,d)})}}}}}}(n,s);throw s.Sc(`Unsupported field value: ${Su(n)}`)}(t,e)}function N1(t,e){const r={};return pw(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Xn(t,(n,s)=>{const i=$o(s,e.mc(n));i!=null&&(r[n]=i)}),{mapValue:{fields:r}}}function A1(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ye||t instanceof Ar||t instanceof Gt||t instanceof Ve||t instanceof Bu||t instanceof Cr)}function op(t,e,r){if(!A1(r)||!fw(r)){const n=Su(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function _f(t,e,r){if((e=Ae(e))instanceof Bo)return e._internalPath;if(typeof e=="string")return lp(t,e);throw tu("Field path arguments must be of type string or ",t,!1,void 0,r)}const KC=new RegExp("[~\\*/\\[\\]]");function lp(t,e,r){if(e.search(KC)>=0)throw tu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Bo(...e.split("."))._internalPath}catch{throw tu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function tu(t,e,r,n,s){const i=n&&!n.isEmpty(),a=s!==void 0;let c=`Function ${e}() called with invalid data`;r&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(i||a)&&(u+=" (found",i&&(u+=` in field ${n}`),a&&(u+=` in document ${s}`),u+=")"),new H(V.INVALID_ARGUMENT,c+t+u)}function C1(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R1{constructor(e,r,n,s,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ve(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new GC(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Hu("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class GC extends R1{data(){return super.data()}}function Hu(t,e){return typeof e=="string"?lp(t,e):e instanceof Bo?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P1(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new H(V.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class cp{}class j1 extends cp{}function tr(t,e,...r){let n=[];e instanceof cp&&n.push(e),n=n.concat(r),function(i){const a=i.filter(u=>u instanceof up).length,c=i.filter(u=>u instanceof Wu).length;if(a>1||a>0&&c>0)throw new H(V.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)t=s._apply(t);return t}class Wu extends j1{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Wu(e,r,n)}_apply(e){const r=this._parse(e);return D1(e._query,r),new Zn(e.firestore,e.converter,cf(e._query,r))}_parse(e){const r=$u(e.firestore);return function(i,a,c,u,d,f,p){let g;if(d.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new H(V.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){zy(p,f);const N=[];for(const S of p)N.push(Uy(u,i,S));g={arrayValue:{values:N}}}else g=Uy(u,i,p)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||zy(p,f),g=WC(c,a,p,f==="in"||f==="not-in");return Fe.create(d,f,g)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function rr(t,e,r){const n=e,s=Hu("where",t);return Wu._create(s,n,r)}class up extends cp{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new up(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:gr.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(s,i){let a=s;const c=i.getFlattenedFilters();for(const u of c)D1(a,u),a=cf(a,u)}(e._query,r),new Zn(e.firestore,e.converter,cf(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class dp extends j1{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new dp(e,r)}_apply(e){const r=function(s,i,a){if(s.startAt!==null)throw new H(V.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new H(V.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new xo(i,a)}(e._query,this._field,this._direction);return new Zn(e.firestore,e.converter,function(s,i){const a=s.explicitOrderBy.concat([i]);return new Hi(s.path,s.collectionGroup,a,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,r))}}function Ds(t,e="asc"){const r=e,n=Hu("orderBy",t);return dp._create(n,r)}function Uy(t,e,r){if(typeof(r=Ae(r))=="string"){if(r==="")throw new H(V.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Rw(e)&&r.indexOf("/")!==-1)throw new H(V.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(ve.fromString(r));if(!Q.isDocumentKey(n))throw new H(V.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return ry(t,new Q(n))}if(r instanceof Ve)return ry(t,r._key);throw new H(V.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Su(r)}.`)}function zy(t,e){if(!Array.isArray(t)||t.length===0)throw new H(V.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function D1(t,e){const r=function(s,i){for(const a of s)for(const c of a.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new H(V.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new H(V.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class QC{convertValue(e,r="none"){switch(qn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return De(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes($n(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Z(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Xn(e,(s,i)=>{n[s]=this.convertValue(i,r)}),n}convertVectorValue(e){var n,s,i;const r=(i=(s=(n=e.fields)==null?void 0:n[Kc].arrayValue)==null?void 0:s.values)==null?void 0:i.map(a=>De(a.doubleValue));return new Cr(r)}convertGeoPoint(e){return new Ar(De(e.latitude),De(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Cu(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(go(e));default:return null}}convertTimestamp(e){const r=Bn(e);return new ye(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=ve.fromString(e);fe(Zw(n),9688,{name:e});const s=new yo(n.get(1),n.get(3)),i=new Q(n.popFirst(5));return s.isEqual(r)||Zr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O1(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class ja{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ws extends R1{constructor(e,r,n,s,i,a){super(e,r,n,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new dc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Hu("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new H(V.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=ws._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}ws._jsonSchemaVersion="firestore/documentSnapshot/1.0",ws._jsonSchema={type:Ue("string",ws._jsonSchemaVersion),bundleSource:Ue("string","DocumentSnapshot"),bundleName:Ue("string"),bundle:Ue("string")};class dc extends ws{data(e={}){return super.data(e)}}class ks{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new ja(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new dc(this._firestore,this._userDataWriter,n.key,n,new ja(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new H(V.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(c=>{const u=new dc(s._firestore,s._userDataWriter,c.doc.key,c.doc,new ja(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(c=>i||c.type!==3).map(c=>{const u=new dc(s._firestore,s._userDataWriter,c.doc.key,c.doc,new ja(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,f=-1;return c.type!==0&&(d=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),f=a.indexOf(c.doc.key)),{type:YC(c.type),doc:u,oldIndex:d,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new H(V.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ks._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Pm.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(r.push(i._document),n.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function YC(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Z(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XC(t){t=Ft(t,Ve);const e=Ft(t.firestore,tn);return LC(zo(e),t._key).then(r=>V1(e,t,r))}ks._jsonSchemaVersion="firestore/querySnapshot/1.0",ks._jsonSchema={type:Ue("string",ks._jsonSchemaVersion),bundleSource:Ue("string","QuerySnapshot"),bundleName:Ue("string"),bundle:Ue("string")};class hp extends QC{constructor(e){super(),this.firestore=e}convertBytes(e){return new Gt(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Ve(this.firestore,null,r)}}function Os(t){t=Ft(t,Zn);const e=Ft(t.firestore,tn),r=zo(e),n=new hp(e);return P1(t._query),FC(r,t._query).then(s=>new ks(e,n,t,s))}function Ki(t,e,r,...n){t=Ft(t,Ve);const s=Ft(t.firestore,tn),i=$u(s);let a;return a=typeof(e=Ae(e))=="string"||e instanceof Bo?S1(i,"updateDoc",t._key,e,r,n):I1(i,"updateDoc",t._key,e),Ku(s,[a.toMutation(t._key,Nt.exists(!0))])}function qo(t){return Ku(Ft(t.firestore,tn),[new Vu(t._key,Nt.none())])}function Gi(t,e){const r=Ft(t.firestore,tn),n=Be(t),s=O1(t.converter,e);return Ku(r,[T1($u(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,Nt.exists(!1))]).then(()=>n)}function Ho(t,...e){var u,d,f;t=Ae(t);let r={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||Fy(e[n])||(r=e[n++]);const s={includeMetadataChanges:r.includeMetadataChanges,source:r.source};if(Fy(e[n])){const p=e[n];e[n]=(u=p.next)==null?void 0:u.bind(p),e[n+1]=(d=p.error)==null?void 0:d.bind(p),e[n+2]=(f=p.complete)==null?void 0:f.bind(p)}let i,a,c;if(t instanceof Ve)a=Ft(t.firestore,tn),c=Ru(t._key.path),i={next:p=>{e[n]&&e[n](V1(a,t,p))},error:e[n+1],complete:e[n+2]};else{const p=Ft(t,Zn);a=Ft(p.firestore,tn),c=p._query;const g=new hp(a);i={next:w=>{e[n]&&e[n](new ks(a,g,p,w))},error:e[n+1],complete:e[n+2]},P1(t._query)}return function(g,w,N,S){const C=new sp(S),T=new tp(w,C,N);return g.asyncQueue.enqueueAndForget(async()=>Jm(await eu(g),T)),()=>{C.Nu(),g.asyncQueue.enqueueAndForget(async()=>Zm(await eu(g),T))}}(zo(a),c,s,i)}function Ku(t,e){return function(n,s){const i=new Wr;return n.asyncQueue.enqueueAndForget(async()=>IC(await MC(n),s,i)),i.promise}(zo(t),e)}function V1(t,e,r){const n=r.docs.get(e._key),s=new hp(t);return new ws(t,s,e._key,n,new ja(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JC{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=$u(e)}set(e,r,n){this._verifyNotCommitted();const s=Xd(e,this._firestore),i=O1(s.converter,r,n),a=T1(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,n);return this._mutations.push(a.toMutation(s._key,Nt.none())),this}update(e,r,n,...s){this._verifyNotCommitted();const i=Xd(e,this._firestore);let a;return a=typeof(r=Ae(r))=="string"||r instanceof Bo?S1(this._dataReader,"WriteBatch.update",i._key,r,n,s):I1(this._dataReader,"WriteBatch.update",i._key,r),this._mutations.push(a.toMutation(i._key,Nt.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=Xd(e,this._firestore);return this._mutations=this._mutations.concat(new Vu(r._key,Nt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new H(V.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Xd(t,e){if((t=Ae(t)).firestore!==e)throw new H(V.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function Ee(){return new ap("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZC(t){return zo(t=Ft(t,tn)),new JC(t,e=>Ku(t,e))}(function(e,r=!0){(function(s){Bi=s})(Us),As(new Un("firestore",(n,{instanceIdentifier:s,options:i})=>{const a=n.getProvider("app").getImmediate(),c=new tn(new KS(n.getProvider("auth-internal")),new YS(a,n.getProvider("app-check-internal")),function(d,f){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new H(V.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new yo(d.options.projectId,f)}(a,s),a);return i={useFetchStreams:r,...i},c._setSettings(i),c},"PUBLIC").setMultipleInstances(!0)),br($0,q0,e),br($0,q0,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M1="firebasestorage.googleapis.com",eR="storageBucket",tR=2*60*1e3,rR=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr extends er{constructor(e,r,n=0){super(Jd(e),`Firebase Storage: ${r} (${Jd(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Dr.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Jd(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Pr;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Pr||(Pr={}));function Jd(t){return"storage/"+t}function nR(){const t="An unknown error occurred, please check the error payload for server response.";return new Dr(Pr.UNKNOWN,t)}function sR(){return new Dr(Pr.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function iR(){return new Dr(Pr.CANCELED,"User canceled the upload/download.")}function aR(t){return new Dr(Pr.INVALID_URL,"Invalid URL '"+t+"'.")}function oR(t){return new Dr(Pr.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function By(t){return new Dr(Pr.INVALID_ARGUMENT,t)}function L1(){return new Dr(Pr.APP_DELETED,"The Firebase app was deleted.")}function lR(t){return new Dr(Pr.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=dr.makeFromUrl(e,r)}catch{return new dr(e,"")}if(n.path==="")return n;throw oR(e)}static makeFromUrl(e,r){let n=null;const s="([A-Za-z0-9.\\-_]+)";function i(j){j.path.charAt(j.path.length-1)==="/"&&(j.path_=j.path_.slice(0,-1))}const a="(/(.*))?$",c=new RegExp("^gs://"+s+a,"i"),u={bucket:1,path:3};function d(j){j.path_=decodeURIComponent(j.path)}const f="v[A-Za-z0-9_]+",p=r.replace(/[.]/g,"\\."),g="(/([^?#]*).*)?$",w=new RegExp(`^https?://${p}/${f}/b/${s}/o${g}`,"i"),N={bucket:1,path:3},S=r===M1?"(?:storage.googleapis.com|storage.cloud.google.com)":r,C="([^?#]*)",T=new RegExp(`^https?://${S}/${s}/${C}`,"i"),k=[{regex:c,indices:u,postModify:i},{regex:w,indices:N,postModify:d},{regex:T,indices:{bucket:1,path:2},postModify:d}];for(let j=0;j<k.length;j++){const F=k[j],D=F.regex.exec(e);if(D){const v=D[F.indices.bucket];let y=D[F.indices.path];y||(y=""),n=new dr(v,y),F.postModify(n);break}}if(n==null)throw aR(e);return n}}class cR{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uR(t,e,r){let n=1,s=null,i=null,a=!1,c=0;function u(){return c===2}let d=!1;function f(...C){d||(d=!0,e.apply(null,C))}function p(C){s=setTimeout(()=>{s=null,t(w,u())},C)}function g(){i&&clearTimeout(i)}function w(C,...T){if(d){g();return}if(C){g(),f.call(null,C,...T);return}if(u()||a){g(),f.call(null,C,...T);return}n<64&&(n*=2);let k;c===1?(c=2,k=0):k=(n+Math.random())*1e3,p(k)}let N=!1;function S(C){N||(N=!0,g(),!d&&(s!==null?(C||(c=2),clearTimeout(s),p(0)):C||(c=1)))}return p(0),i=setTimeout(()=>{a=!0,S(!0)},r),S}function dR(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hR(t){return t!==void 0}function $y(t,e,r,n){if(n<e)throw By(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw By(`Invalid value for '${t}'. Expected ${r} or less.`)}function fR(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const s=e(n)+"="+e(t[n]);r=r+s+"&"}return r=r.slice(0,-1),r}var ru;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(ru||(ru={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mR(t,e){const r=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return r||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pR{constructor(e,r,n,s,i,a,c,u,d,f,p,g=!0,w=!1){this.url_=e,this.method_=r,this.headers_=n,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=a,this.callback_=c,this.errorCallback_=u,this.timeout_=d,this.progressCallback_=f,this.connectionFactory_=p,this.retry=g,this.isUsingEmulator=w,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((N,S)=>{this.resolve_=N,this.reject_=S,this.start_()})}start_(){const e=(n,s)=>{if(s){n(!1,new Bl(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const a=c=>{const u=c.loaded,d=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,d)};this.progressCallback_!==null&&i.addUploadProgressListener(a),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(a),this.pendingConnection_=null;const c=i.getErrorCode()===ru.NO_ERROR,u=i.getStatus();if(!c||mR(u,this.additionalRetryCodes_)&&this.retry){const f=i.getErrorCode()===ru.ABORT;n(!1,new Bl(!1,null,f));return}const d=this.successCodes_.indexOf(u)!==-1;n(!0,new Bl(d,i))})},r=(n,s)=>{const i=this.resolve_,a=this.reject_,c=s.connection;if(s.wasSuccessCode)try{const u=this.callback_(c,c.getResponse());hR(u)?i(u):i()}catch(u){a(u)}else if(c!==null){const u=nR();u.serverResponse=c.getErrorText(),this.errorCallback_?a(this.errorCallback_(c,u)):a(u)}else if(s.canceled){const u=this.appDelete_?L1():iR();a(u)}else{const u=sR();a(u)}};this.canceled_?r(!1,new Bl(!1,null,!0)):this.backoffId_=uR(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&dR(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Bl{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function gR(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function yR(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function vR(t,e){e&&(t["X-Firebase-GMPID"]=e)}function xR(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function _R(t,e,r,n,s,i,a=!0,c=!1){const u=fR(t.urlParams),d=t.url+u,f=Object.assign({},t.headers);return vR(f,e),gR(f,r),yR(f,i),xR(f,n),new pR(d,t.method,f,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,a,c)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wR(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function kR(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nu{constructor(e,r){this._service=e,r instanceof dr?this._location=r:this._location=dr.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new nu(e,r)}get root(){const e=new dr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return kR(this._location.path)}get storage(){return this._service}get parent(){const e=wR(this._location.path);if(e===null)return null;const r=new dr(this._location.bucket,e);return new nu(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw lR(e)}}function qy(t,e){const r=e==null?void 0:e[eR];return r==null?null:dr.makeFromBucketSpec(r,t)}function ER(t,e,r,n={}){t.host=`${e}:${r}`;const s=Fs(e);s&&(vm(`https://${t.host}/b`),xm("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=n;i&&(t._overrideAuthToken=typeof i=="string"?i:v_(i,t.app.options.projectId))}class bR{constructor(e,r,n,s,i,a=!1){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=a,this._bucket=null,this._host=M1,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=tR,this._maxUploadRetryTime=rR,this._requests=new Set,s!=null?this._bucket=dr.makeFromBucketSpec(s,this._host):this._bucket=qy(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=dr.makeFromBucketSpec(this._url,e):this._bucket=qy(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){$y("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){$y("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){if(Dt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new nu(this,e)}_makeRequest(e,r,n,s,i=!0){if(this._deleted)return new cR(L1());{const a=_R(e,this._appId,n,s,r,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,r){const[n,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,s).getPromise()}}const Hy="@firebase/storage",Wy="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F1="storage";function TR(t=km(),e){t=Ae(t);const n=Eu(t,F1).getImmediate({identifier:e}),s=p_("storage");return s&&IR(n,...s),n}function IR(t,e,r,n={}){ER(t,e,r,n)}function SR(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new bR(r,n,s,e,Us)}function NR(){As(new Un(F1,SR,"PUBLIC").setMultipleInstances(!0)),br(Hy,Wy,""),br(Hy,Wy,"esm2020")}NR();const AR={apiKey:"AIzaSyABIO6LGK1pUPB-zh0jIM-0XunBlq2GvI0",authDomain:"kefir-627a0.firebaseapp.com",projectId:"kefir-627a0",storageBucket:"kefir-627a0.firebasestorage.app",messagingSenderId:"661808265565",appId:"1:661808265565:web:cc47b6445aa701a45690b4"},fp=w_(AR),ne=zC(fp),wa=zS(fp);TR(fp);const U1=L.createContext(void 0),Wo=()=>{const t=L.useContext(U1);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},CR=({children:t})=>{const[e,r]=L.useState(null),[n,s]=L.useState(!0),i=async(p,g)=>{try{await bI(wa,p,g)}catch(w){throw new Error(d(w.code))}},a=async(p,g,w)=>{try{const{user:N}=await EI(wa,p,g);await II(N,{displayName:w})}catch(N){throw new Error(d(N.code))}},c=async()=>{try{await CI(wa)}catch{throw new Error("Erreur lors de la déconnexion")}},u=async p=>{try{await kI(wa,p)}catch(g){throw new Error(d(g.code))}},d=p=>{switch(p){case"auth/user-not-found":return"Aucun compte trouvé avec cette adresse email";case"auth/wrong-password":return"Mot de passe incorrect";case"auth/email-already-in-use":return"Cette adresse email est déjà utilisée";case"auth/weak-password":return"Le mot de passe doit contenir au moins 6 caractères";case"auth/invalid-email":return"Adresse email invalide";case"auth/too-many-requests":return"Trop de tentatives. Veuillez réessayer plus tard";default:return"Une erreur est survenue. Veuillez réessayer"}};L.useEffect(()=>AI(wa,g=>{r(g),s(!1)}),[]);const f={currentUser:e,loading:n,login:i,register:a,logout:c,resetPassword:u};return l.jsx(U1.Provider,{value:f,children:!n&&t})};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var RR={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PR=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),X=(t,e)=>{const r=L.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:a,className:c="",children:u,...d},f)=>L.createElement("svg",{ref:f,...RR,width:s,height:s,stroke:n,strokeWidth:a?Number(i)*24/Number(s):i,className:["lucide",`lucide-${PR(t)}`,c].join(" "),...d},[...e.map(([p,g])=>L.createElement(p,g)),...Array.isArray(u)?u:[u]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eo=X("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bo=X("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jR=X("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DR=X("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mp=X("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OR=X("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VR=X("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MR=X("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z1=X("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LR=X("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B1=X("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FR=X("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UR=X("Euro",[["path",{d:"M4 10h12",key:"1y6xl8"}],["path",{d:"M4 14h9",key:"1loblj"}],["path",{d:"M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2",key:"1j6lzo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ky=X("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wf=X("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $1=X("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q1=X("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pp=X("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H1=X("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zR=X("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gy=X("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BR=X("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $R=X("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=X("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gu=X("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qR=X("Meh",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"8",x2:"16",y1:"15",y2:"15",key:"1xb1d9"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kf=X("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HR=X("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WR=X("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=X("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ko=X("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qu=X("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KR=X("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qi=X("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const su=X("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GR=X("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QR=X("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YR=X("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W1=X("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K1=X("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XR=X("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gp=X("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JR=X("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZR=X("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iu=X("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eP=X("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tP=X("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yu=X("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yp=X("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=X("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Ef=({className:t="w-8 h-8"})=>l.jsx("div",{className:t,children:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 48 48",children:l.jsxs("g",{fill:"none",stroke:"currentColor",strokeWidth:"4",children:[l.jsx("path",{d:"M13.5 39.37A16.93 16.93 0 0 0 24 43c3.963 0 7.61-1.356 10.5-3.63M19 9.747C12.051 11.882 7 18.351 7 26c0 1.925.32 3.775.91 5.5M29 9.747C35.949 11.882 41 18.351 41 26c0 1.925-.32 3.775-.91 5.5"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M43 36c0 1.342-.528 2.56-1.388 3.458A5 5 0 1 1 43 36m-28 0c0 1.342-.528 2.56-1.388 3.458A5 5 0 1 1 15 36M29 9c0 1.342-.528 2.56-1.388 3.458A5 5 0 1 1 29 9"})]})})}),rP=({onToggleMode:t,isRegisterMode:e})=>{const{login:r,register:n,resetPassword:s}=Wo(),[i,a]=L.useState({email:"",password:"",confirmPassword:"",displayName:""}),[c,u]=L.useState(!1),[d,f]=L.useState(!1),[p,g]=L.useState(!1),[w,N]=L.useState(""),[S,C]=L.useState(!1),[T,_]=L.useState(""),[k,j]=L.useState(""),F=async y=>{y.preventDefault(),N(""),g(!0);try{if(e){if(i.password!==i.confirmPassword)throw new Error("Les mots de passe ne correspondent pas");if(i.password.length<6)throw new Error("Le mot de passe doit contenir au moins 6 caractères");if(!i.displayName.trim())throw new Error("Le nom est requis");await n(i.email,i.password,i.displayName)}else await r(i.email,i.password)}catch(E){N(E.message)}finally{g(!1)}},D=async y=>{y.preventDefault(),N(""),j("");try{await s(T),j("Un email de réinitialisation a été envoyé à votre adresse"),_("")}catch(E){N(E.message)}},v=(y,E)=>{a(b=>({...b,[y]:E}))};return S?l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-sage-50 to-sage-100 dark:from-gray-900 dark:to-gray-800 flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl shadow-2xl p-8 w-full max-w-md border border-gray-200 dark:border-gray-800",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx(Ef,{className:"w-16 h-16 mx-auto mb-4"}),l.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Réinitialiser le mot de passe"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Entrez votre adresse email pour recevoir un lien de réinitialisation"})]}),l.jsxs("form",{onSubmit:D,className:"space-y-6",children:[w&&l.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Eo,{className:"w-5 h-5 text-red-600 dark:text-red-400"}),l.jsx("p",{className:"text-red-700 dark:text-red-400 text-sm",children:w})]})}),k&&l.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-xl p-4",children:l.jsx("p",{className:"text-green-700 dark:text-green-400 text-sm",children:k})}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Adresse email"}),l.jsxs("div",{className:"relative",children:[l.jsx(Vs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),l.jsx("input",{type:"email",value:T,onChange:y=>_(y.target.value),className:"w-full pl-10 pr-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent",placeholder:"votre@email.com",required:!0})]})]}),l.jsx("button",{type:"submit",className:"w-full bg-sage-600 hover:bg-sage-700 text-white py-3 px-4 rounded-xl font-medium transition-all duration-200 hover:scale-105 hover:shadow-lg hover:shadow-sage-600/25",children:"Envoyer le lien de réinitialisation"}),l.jsx("button",{type:"button",onClick:()=>C(!1),className:"w-full text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors",children:"Retour à la connexion"})]})]})}):l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-sage-50 to-sage-100 dark:from-gray-900 dark:to-gray-800 flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl shadow-2xl p-8 w-full max-w-md border border-gray-200 dark:border-gray-800",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx(Ef,{className:"w-16 h-16 mx-auto mb-4"}),l.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:e?"Créer un compte":"Connexion"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:e?"Rejoignez votre équipe CRM Kéfir":"Accédez à votre CRM Kéfir"})]}),l.jsxs("form",{onSubmit:F,className:"space-y-6",children:[w&&l.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Eo,{className:"w-5 h-5 text-red-600 dark:text-red-400"}),l.jsx("p",{className:"text-red-700 dark:text-red-400 text-sm",children:w})]})}),e&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Nom complet"}),l.jsx("input",{type:"text",value:i.displayName,onChange:y=>v("displayName",y.target.value),className:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent",placeholder:"Jean Dupont",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Adresse email"}),l.jsxs("div",{className:"relative",children:[l.jsx(Vs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),l.jsx("input",{type:"email",value:i.email,onChange:y=>v("email",y.target.value),className:"w-full pl-10 pr-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent",placeholder:"votre@email.com",required:!0})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Mot de passe"}),l.jsxs("div",{className:"relative",children:[l.jsx(Gy,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),l.jsx("input",{type:c?"text":"password",value:i.password,onChange:y=>v("password",y.target.value),className:"w-full pl-10 pr-12 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent",placeholder:"••••••••",required:!0}),l.jsx("button",{type:"button",onClick:()=>u(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:c?l.jsx(Ky,{className:"w-5 h-5"}):l.jsx(wf,{className:"w-5 h-5"})})]})]}),e&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Confirmer le mot de passe"}),l.jsxs("div",{className:"relative",children:[l.jsx(Gy,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),l.jsx("input",{type:d?"text":"password",value:i.confirmPassword,onChange:y=>v("confirmPassword",y.target.value),className:"w-full pl-10 pr-12 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent",placeholder:"••••••••",required:!0}),l.jsx("button",{type:"button",onClick:()=>f(!d),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:d?l.jsx(Ky,{className:"w-5 h-5"}):l.jsx(wf,{className:"w-5 h-5"})})]})]}),l.jsx("button",{type:"submit",disabled:p,className:`w-full flex items-center justify-center space-x-2 py-3 px-4 rounded-xl font-medium transition-all duration-200 ${p?"bg-gray-400 cursor-not-allowed":"bg-sage-600 hover:bg-sage-700 hover:scale-105 hover:shadow-lg hover:shadow-sage-600/25"} text-white`,children:p?l.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):l.jsxs(l.Fragment,{children:[e?l.jsx(tP,{className:"w-5 h-5"}):l.jsx(BR,{className:"w-5 h-5"}),l.jsx("span",{children:e?"Créer le compte":"Se connecter"})]})}),!e&&l.jsx("button",{type:"button",onClick:()=>C(!0),className:"w-full text-sage-600 dark:text-sage-400 hover:text-sage-700 dark:hover:text-sage-300 text-sm transition-colors",children:"Mot de passe oublié ?"}),l.jsx("div",{className:"text-center",children:l.jsx("button",{type:"button",onClick:t,className:"text-sage-600 dark:text-sage-400 hover:text-sage-700 dark:hover:text-sage-300 font-medium transition-colors",children:e?"Déjà un compte ? Se connecter":"Pas de compte ? Créer un compte"})})]})]})})},nP=({children:t})=>{const{currentUser:e}=Wo(),[r,n]=av.useState(!1);return e?l.jsx(l.Fragment,{children:t}):l.jsx(rP,{onToggleMode:()=>n(!r),isRegisterMode:r})},le={CONTACTS:"contacts",PRODUCTS:"products",ORDERS:"orders",NOTES:"notes",REMINDERS:"reminders",VENDOR_INFO:"vendorInfo"},Xt=t=>{if(!t)return t;const e={...t};return Object.keys(e).forEach(r=>{e[r]instanceof ye?e[r]=e[r].toDate():e[r]&&typeof e[r]=="object"&&(e[r]=Xt(e[r]))}),e},Mt=t=>{if(!t)return t;const e={...t};return Object.keys(e).forEach(r=>{e[r]instanceof Date?e[r]=ye.fromDate(e[r]):e[r]&&typeof e[r]=="object"&&!Array.isArray(e[r])&&(e[r]=Mt(e[r]))}),e},ka={async getAll(t){const e=[];return t&&e.push(rr("userId","==",t)),(await Os(tr(Te(ne,le.CONTACTS),...e))).docs.map(n=>({id:n.id,...Xt(n.data())}))},async getById(t){const e=Be(ne,le.CONTACTS,t),r=await XC(e);return r.exists()?{id:r.id,...Xt(r.data())}:null},async add(t,e){const r=Mt(t);return(await Gi(Te(ne,le.CONTACTS),{...r,userId:e,createdAt:Ee(),updatedAt:Ee()})).id},async update(t,e){const r=Be(ne,le.CONTACTS,t),n=Mt(e);await Ki(r,{...n,updatedAt:Ee()})},async delete(t){await qo(Be(ne,le.CONTACTS,t))},onSnapshot(t,e,r){const n=[];return e&&n.push(rr("userId","==",e)),Ho(tr(Te(ne,le.CONTACTS),...n),s=>{const i=s.docs.map(a=>({id:a.id,...Xt(a.data())}));t(i)},r)}},Ea={async getAll(t){const e=[];return t&&e.push(rr("userId","==",t)),(await Os(tr(Te(ne,le.PRODUCTS),...e))).docs.map(n=>({id:n.id,...Xt(n.data())}))},async add(t,e){return(await Gi(Te(ne,le.PRODUCTS),{...t,userId:e,createdAt:Ee(),updatedAt:Ee()})).id},async update(t,e){const r=Be(ne,le.PRODUCTS,t);await Ki(r,{...e,updatedAt:Ee()})},async delete(t){await qo(Be(ne,le.PRODUCTS,t))},onSnapshot(t,e,r){const n=[Ds("createdAt","desc")];return e&&n.unshift(rr("userId","==",e)),Ho(tr(Te(ne,le.PRODUCTS),...n),s=>{const i=s.docs.map(a=>({id:a.id,...Xt(a.data())}));t(i)},r)}},$l={async getAll(t){const e=[Ds("orderDate","desc")];return t&&e.unshift(rr("userId","==",t)),(await Os(tr(Te(ne,le.ORDERS),...e))).docs.map(n=>({id:n.id,...Xt(n.data())}))},async add(t,e){const r=Mt(t);return(await Gi(Te(ne,le.ORDERS),{...r,userId:e,createdAt:Ee(),updatedAt:Ee()})).id},async update(t,e){const r=Be(ne,le.ORDERS,t),n=Mt(e);await Ki(r,{...n,updatedAt:Ee()})},async delete(t){await qo(Be(ne,le.ORDERS,t))},onSnapshot(t,e,r){const n=[Ds("orderDate","desc")];return e&&n.unshift(rr("userId","==",e)),Ho(tr(Te(ne,le.ORDERS),...n),s=>{const i=s.docs.map(a=>({id:a.id,...Xt(a.data())}));t(i)},r)}},Zd={async getAll(t){const e=[Ds("date","desc")];return t&&e.unshift(rr("userId","==",t)),(await Os(tr(Te(ne,le.NOTES),...e))).docs.map(n=>({id:n.id,...Xt(n.data())}))},async add(t,e){const r=Mt(t);return(await Gi(Te(ne,le.NOTES),{...r,userId:e,createdAt:Ee()})).id},async update(t,e){const r=Be(ne,le.NOTES,t),n=Mt(e);await Ki(r,n)},async delete(t){await qo(Be(ne,le.NOTES,t))},onSnapshot(t,e,r){const n=[Ds("date","desc")];return e&&n.unshift(rr("userId","==",e)),Ho(tr(Te(ne,le.NOTES),...n),s=>{const i=s.docs.map(a=>({id:a.id,...Xt(a.data())}));t(i)},r)}},eh={async getAll(t){const e=[Ds("date","asc")];return t&&e.unshift(rr("userId","==",t)),(await Os(tr(Te(ne,le.REMINDERS),...e))).docs.map(n=>({id:n.id,...Xt(n.data())}))},async add(t,e){const r=Mt(t);return(await Gi(Te(ne,le.REMINDERS),{...r,userId:e,createdAt:Ee()})).id},async update(t,e){const r=Be(ne,le.REMINDERS,t),n=Mt(e);await Ki(r,n)},async delete(t){await qo(Be(ne,le.REMINDERS,t))},onSnapshot(t,e,r){const n=[Ds("date","asc")];return e&&n.unshift(rr("userId","==",e)),Ho(tr(Te(ne,le.REMINDERS),...n),s=>{const i=s.docs.map(a=>({id:a.id,...Xt(a.data())}));t(i)},r)}},Qy={async get(t){const e=[];t&&e.push(rr("userId","==",t));const r=await Os(tr(Te(ne,le.VENDOR_INFO),...e));if(!r.empty){const n=r.docs[0];return{id:n.id,...n.data()}}return null},async set(t,e){const r=await Os(tr(Te(ne,le.VENDOR_INFO),rr("userId","==",e)));if(r.empty)await Gi(Te(ne,le.VENDOR_INFO),{...t,userId:e,createdAt:Ee(),updatedAt:Ee()});else{const n=Be(ne,le.VENDOR_INFO,r.docs[0].id);await Ki(n,{...t,userId:e,updatedAt:Ee()})}}},sP={async migrateAllData(t,e){const r=ZC(ne);try{for(const n of t.contacts){const{id:s,...i}=n,a=Be(Te(ne,le.CONTACTS)),c=Mt(i);r.set(a,{...c,userId:e,createdAt:Ee(),updatedAt:Ee()})}for(const n of t.products){const{id:s,...i}=n,a=Be(Te(ne,le.PRODUCTS));r.set(a,{...i,userId:e,createdAt:Ee(),updatedAt:Ee()})}for(const n of t.orders){const{id:s,...i}=n,a=Be(Te(ne,le.ORDERS)),c=Mt(i);r.set(a,{...c,userId:e,createdAt:Ee(),updatedAt:Ee()})}for(const n of t.notes){const{id:s,...i}=n,a=Be(Te(ne,le.NOTES)),c=Mt(i);r.set(a,{...c,userId:e,createdAt:Ee()})}for(const n of t.reminders){const{id:s,...i}=n,a=Be(Te(ne,le.REMINDERS)),c=Mt(i);r.set(a,{...c,userId:e,createdAt:Ee()})}if(t.vendorInfo){const n=Be(Te(ne,le.VENDOR_INFO));r.set(n,{...t.vendorInfo,userId:e,createdAt:Ee(),updatedAt:Ee()})}await r.commit(),console.log("Migration completed successfully!")}catch(n){throw console.error("Migration failed:",n),n}}},iP=()=>{const[t,e]=L.useState([]),[r,n]=L.useState([]),[s,i]=L.useState([]),[a,c]=L.useState([]),[u,d]=L.useState([]),[f,p]=L.useState(null),[g,w]=L.useState(!0),[N,S]=L.useState(null),[C,T]=L.useState(!1),[_,k]=L.useState(!1),[j,F]=L.useState(!0),{currentUser:D}=Wo(),v=L.useCallback(async()=>{if(!D||!j){w(!1);return}try{w(!0),S(null),T(!1),k(!1);const[z,q,re,ue,pe,pt]=await Promise.all([ka.getAll(D.uid),Ea.getAll(D.uid),$l.getAll(D.uid),Zd.getAll(D.uid),eh.getAll(D.uid),Qy.get(D.uid)]);e(z),n(q),i(re),c(ue),d(pe),p(pt)}catch(z){console.error("Error initializing Firebase data:",z),z instanceof er?z.code==="permission-denied"?(T(!0),F(!1),S("Permission denied. Please check Firebase Security Rules.")):z.code==="failed-precondition"?(k(!0),F(!1),S("Database indexes are missing. Please create required indexes in Firebase Console.")):(F(!1),S(`Firebase error: ${z.message}`)):(F(!1),S(z instanceof Error?z.message:"Failed to load data"))}finally{w(!1)}},[D,j]);return L.useEffect(()=>{if(!D||!j){w(!1);return}const z=Ge=>{console.error("Snapshot listener error:",Ge),Ge instanceof er&&(Ge.code==="permission-denied"?(T(!0),F(!1),S("Permission denied. Please check Firebase Security Rules.")):Ge.code==="failed-precondition"&&(k(!0),F(!1),S("Database indexes are missing. Please create required indexes in Firebase Console.")))},q=ka.onSnapshot(e,D.uid,z),re=Ea.onSnapshot(n,D.uid,z),ue=$l.onSnapshot(i,D.uid,z),pe=Zd.onSnapshot(c,D.uid,z),pt=eh.onSnapshot(d,D.uid,z);return()=>{q(),re(),ue(),pe(),pt()}},[D,j]),L.useEffect(()=>{v()},[v]),{contacts:t,products:r,orders:s,notes:a,reminders:u,vendorInfo:f,loading:g,error:N,permissionError:C,indexError:_,firebaseAvailable:j,addContact:async z=>{if(!D)throw new Error("User not authenticated");try{await ka.add(z,D.uid)}catch(q){throw console.error("Error adding contact:",q),q}},updateContact:async(z,q)=>{try{await ka.update(z,q)}catch(re){throw console.error("Error updating contact:",re),re}},deleteContact:async z=>{try{await ka.delete(z)}catch(q){throw console.error("Error deleting contact:",q),q}},addProduct:async z=>{if(!D)throw new Error("User not authenticated");try{await Ea.add(z,D.uid)}catch(q){throw console.error("Error adding product:",q),q}},updateProduct:async(z,q)=>{try{await Ea.update(z,q)}catch(re){throw console.error("Error updating product:",re),re}},deleteProduct:async z=>{try{await Ea.delete(z)}catch(q){throw console.error("Error deleting product:",q),q}},addOrder:async z=>{if(!D)throw new Error("User not authenticated");try{await $l.add(z,D.uid)}catch(q){throw console.error("Error adding order:",q),q}},updateOrder:async(z,q)=>{try{await $l.update(z,q)}catch(re){throw console.error("Error updating order:",re),re}},addNote:async z=>{if(!D)throw new Error("User not authenticated");try{await Zd.add(z,D.uid)}catch(q){throw console.error("Error adding note:",q),q}},updateReminder:async(z,q)=>{try{await eh.update(z,q)}catch(re){throw console.error("Error updating reminder:",re),re}},saveVendorInfo:async z=>{if(!D)throw new Error("User not authenticated");try{await Qy.set(z,D.uid),p(z)}catch(q){throw console.error("Error saving vendor info:",q),q}}}},aP=({isOpen:t,onClose:e,localData:r,onMigrationComplete:n})=>{const[s,i]=L.useState("idle"),[a,c]=L.useState(null),{currentUser:u}=Wo(),d=async()=>{if(!u){c("Utilisateur non authentifié"),i("error");return}try{i("migrating"),c(null),await sP.migrateAllData(r,u.uid),i("success"),setTimeout(()=>{n(),e()},2e3)}catch(f){console.error("Migration error:",f),c(f instanceof Error?f.message:"Erreur inconnue lors de la migration"),i("error")}};return t?l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 dark:bg-black/80 backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-2xl w-full max-w-2xl mx-4",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-800",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(LR,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Migration vers Firebase"})]}),s==="idle"&&l.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors",children:l.jsx(Ct,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),l.jsxs("div",{className:"p-6",children:[s==="idle"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:"Cette opération va migrer toutes vos données locales vers Firebase. Voici un résumé de ce qui sera migré :"}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-xl p-4 space-y-2",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Clients :"}),l.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:r.contacts.length})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Produits :"}),l.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:r.products.length})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Commandes :"}),l.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:r.orders.length})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Notes :"}),l.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:r.notes.length})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Rappels :"}),l.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:r.reminders.length})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Informations vendeur :"}),l.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:r.vendorInfo?"✓":"✗"})]})]})]}),l.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4 mb-6",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx(Eo,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5"}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-blue-800 dark:text-blue-300 mb-1",children:"Important"}),l.jsx("p",{className:"text-blue-700 dark:text-blue-400 text-sm",children:"Cette opération est irréversible. Assurez-vous d'avoir une sauvegarde de vos données si nécessaire. Après la migration, l'application utilisera exclusivement Firebase pour le stockage des données."})]})]})}),l.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[l.jsx("button",{onClick:e,className:"px-6 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-300 transition-colors",children:"Annuler"}),l.jsxs("button",{onClick:d,className:"flex items-center space-x-2 px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-all hover:scale-105 hover:shadow-lg hover:shadow-blue-600/25",children:[l.jsx(eP,{className:"w-4 h-4"}),l.jsx("span",{children:"Commencer la migration"})]})]})]}),s==="migrating"&&l.jsxs("div",{className:"text-center py-8",children:[l.jsx(zR,{className:"w-12 h-12 text-blue-600 dark:text-blue-400 animate-spin mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Migration en cours..."}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Veuillez patienter pendant que nous transférons vos données vers Firebase."})]}),s==="success"&&l.jsxs("div",{className:"text-center py-8",children:[l.jsx(OR,{className:"w-12 h-12 text-emerald-600 dark:text-emerald-400 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Migration réussie !"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Toutes vos données ont été transférées avec succès vers Firebase. L'application va maintenant utiliser le cloud pour le stockage."})]}),s==="error"&&l.jsxs("div",{className:"text-center py-8",children:[l.jsx(Eo,{className:"w-12 h-12 text-red-600 dark:text-red-400 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Erreur de migration"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Une erreur s'est produite lors de la migration :"}),l.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3 mb-4",children:l.jsx("p",{className:"text-red-700 dark:text-red-400 text-sm font-mono",children:a})}),l.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[l.jsx("button",{onClick:e,className:"px-6 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-300 transition-colors",children:"Fermer"}),l.jsx("button",{onClick:()=>{i("idle"),c(null)},className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"Réessayer"})]})]})]})]})}):null},oP=()=>{const{theme:t,setTheme:e}=Ub(),r=[{id:"light",icon:XR,label:"Clair"},{id:"dark",icon:WR,label:"Sombre"},{id:"system",icon:HR,label:"Système"}];return l.jsx("div",{className:"flex items-center bg-gray-100 dark:bg-gray-800 rounded-lg p-1",children:r.map(n=>{const s=n.icon,i=t===n.id;return l.jsxs("button",{onClick:()=>e(n.id),className:`flex items-center space-x-1 px-3 py-1.5 rounded-md text-sm font-medium transition-all duration-200 ${i?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"}`,title:`Basculer vers le thème ${n.label.toLowerCase()}`,children:[l.jsx(s,{className:"w-4 h-4"}),l.jsx("span",{className:"hidden sm:inline",children:n.label})]},n.id)})})},lP=()=>{var i,a;const{currentUser:t,logout:e}=Wo(),[r,n]=L.useState(!1),s=async()=>{try{await e()}catch(c){console.error("Erreur lors de la déconnexion:",c)}};return t?l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>n(!r),className:"flex items-center space-x-2 bg-white/10 hover:bg-white/20 dark:bg-gray-800/50 dark:hover:bg-gray-800/70 backdrop-blur-sm border border-white/20 dark:border-gray-700 rounded-xl px-3 py-2 transition-all duration-200",children:[l.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-sage-600 to-sage-700 rounded-full flex items-center justify-center text-white font-semibold text-sm",children:((i=t.displayName)==null?void 0:i.charAt(0))||((a=t.email)==null?void 0:a.charAt(0))||"U"}),l.jsxs("div",{className:"hidden sm:block text-left",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.displayName||"Utilisateur"}),l.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:t.email})]}),l.jsx(VR,{className:`w-4 h-4 text-gray-600 dark:text-gray-400 transition-transform ${r?"rotate-180":""}`})]}),r&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>n(!1)}),l.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-xl shadow-lg z-20 overflow-hidden",children:[l.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-800",children:[l.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:t.displayName||"Utilisateur"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t.email})]}),l.jsxs("div",{className:"py-2",children:[l.jsxs("button",{onClick:()=>{n(!1)},className:"flex items-center space-x-2 w-full px-4 py-2 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:[l.jsx(GR,{className:"w-4 h-4"}),l.jsx("span",{children:"Paramètres du compte"})]}),l.jsxs("button",{onClick:s,className:"flex items-center space-x-2 w-full px-4 py-2 text-left text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:[l.jsx($R,{className:"w-4 h-4"}),l.jsx("span",{children:"Se déconnecter"})]})]})]})]})]}):null},cP=({children:t,activeTab:e,onTabChange:r,onNewNote:n,onVendorSettings:s,onMigrateToFirebase:i})=>{const a=[{id:"dashboard",label:"Tableau de bord",icon:jR},{id:"contacts",label:"Clients",icon:yp},{id:"orders",label:"Commandes",icon:QR},{id:"products",label:"Produits",icon:At},{id:"timeline",label:"Mémoire",icon:MR}];return l.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 text-gray-900 dark:text-white transition-colors",children:[l.jsx("header",{className:"sticky top-0 z-50 bg-white/80 dark:bg-gray-950/80 backdrop-blur-xl border-b border-gray-200 dark:border-gray-800",children:l.jsx("div",{className:"max-w-6xl mx-auto px-6 py-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(Ef,{className:"w-10 h-10"}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Connections"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Your personal relationship journal"})]})]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx(oP,{}),l.jsx(lP,{}),l.jsxs("button",{onClick:i,className:"flex items-center space-x-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-xl transition-all duration-200 hover:scale-105 text-sm",children:[l.jsx(At,{className:"w-4 h-4"}),l.jsx("span",{className:"hidden sm:inline",children:"Migrer vers Firebase"})]}),l.jsxs("button",{onClick:s,className:"flex items-center space-x-2 bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-xl transition-all duration-200 hover:scale-105",children:[l.jsx(At,{className:"w-4 h-4"}),l.jsx("span",{className:"hidden sm:inline",children:"Paramètres"})]}),l.jsxs("button",{onClick:n,className:"flex items-center space-x-2 bg-sage-600 hover:bg-sage-700 text-white px-4 py-2 rounded-xl transition-all duration-200 hover:scale-105 hover:shadow-lg hover:shadow-sage-600/25",children:[l.jsx(Qu,{className:"w-4 h-4"}),l.jsx("span",{className:"hidden sm:inline",children:"Ajouter une note"})]})]})]})})}),l.jsx("nav",{className:"sticky top-20 z-40 bg-white/80 dark:bg-gray-950/80 backdrop-blur-xl border-b border-gray-200 dark:border-gray-800",children:l.jsx("div",{className:"max-w-6xl mx-auto px-6",children:l.jsx("div",{className:"flex space-x-1",children:a.map(c=>{const u=c.icon,d=e===c.id;return l.jsxs("button",{onClick:()=>r(c.id),className:`flex items-center space-x-2 px-4 py-3 transition-all duration-200 border-b-2 ${d?"bg-sage-600/20 text-sage-600 dark:text-sage-400 border-sage-600 dark:border-sage-400":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800/50 border-transparent"}`,children:[l.jsx(u,{className:"w-4 h-4"}),l.jsx("span",{className:"hidden sm:inline font-medium",children:c.label})]},c.id)})})})}),l.jsx("main",{className:"max-w-6xl mx-auto px-6 py-8",children:t})]})},uP=({customers:t,orders:e,deliveries:r,analytics:n})=>{const s=r.filter(d=>{const f=new Date;return d.scheduledDate.toDateString()===f.toDateString()}),i=e.filter(d=>d.status==="pending"),a=e.filter(d=>d.paymentStatus==="overdue"),c=d=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"MGA",minimumFractionDigits:0,maximumFractionDigits:0}).format(d),u=d=>new Intl.DateTimeFormat("fr-FR",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"}).format(d);return l.jsxs("div",{className:"space-y-8",children:[l.jsxs("div",{className:"text-center py-6",children:[l.jsx("h2",{className:"text-3xl font-light text-gray-900 dark:text-white mb-2",children:"Tableau de Bord Kéfir"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-lg",children:"Vue d'ensemble de votre activité commerciale"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[l.jsx("div",{className:"bg-gradient-to-br from-emerald-100 to-emerald-200 dark:from-emerald-600/20 dark:to-emerald-700/20 border border-emerald-200 dark:border-emerald-600/30 rounded-2xl p-6",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(UR,{className:"w-8 h-8 text-emerald-600 dark:text-emerald-400"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:c(n.monthlyRevenue)}),l.jsx("p",{className:"text-emerald-700 dark:text-emerald-300 text-sm",children:"CA ce mois"})]})]})}),l.jsx("div",{className:"bg-gradient-to-br from-blue-100 to-blue-200 dark:from-blue-600/20 dark:to-blue-700/20 border border-blue-200 dark:border-blue-600/30 rounded-2xl p-6",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(yp,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:n.activeCustomers}),l.jsx("p",{className:"text-blue-700 dark:text-blue-300 text-sm",children:"Clients actifs"})]})]})}),l.jsx("div",{className:"bg-gradient-to-br from-purple-100 to-purple-200 dark:from-purple-600/20 dark:to-purple-700/20 border border-purple-200 dark:border-purple-600/30 rounded-2xl p-6",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(At,{className:"w-8 h-8 text-purple-600 dark:text-purple-400"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:i.length}),l.jsx("p",{className:"text-purple-700 dark:text-purple-300 text-sm",children:"Commandes en attente"})]})]})}),l.jsx("div",{className:"bg-gradient-to-br from-orange-100 to-orange-200 dark:from-orange-600/20 dark:to-orange-700/20 border border-orange-200 dark:border-orange-600/30 rounded-2xl p-6",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(iu,{className:"w-8 h-8 text-orange-600 dark:text-orange-400"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:s.length}),l.jsx("p",{className:"text-orange-700 dark:text-orange-300 text-sm",children:"Livraisons aujourd'hui"})]})]})})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[l.jsxs("div",{className:"bg-white/50 dark:bg-gray-900/50 backdrop-blur-sm border border-gray-200 dark:border-gray-800 rounded-2xl p-6",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[l.jsx(iu,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"}),l.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Livraisons du jour"})]}),l.jsx("div",{className:"space-y-4",children:s.length===0?l.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-center py-8",children:"Aucune livraison prévue aujourd'hui"}):s.map(d=>l.jsxs("div",{className:"flex items-start space-x-3 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-xl border border-gray-200 dark:border-gray-700",children:[l.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded-full mt-2"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-gray-900 dark:text-white font-medium",children:d.customerName}),l.jsxs("p",{className:"text-gray-700 dark:text-gray-300 text-sm",children:[d.address.street,", ",d.address.city]}),l.jsxs("p",{className:"text-gray-500 dark:text-gray-500 text-xs mt-1",children:[u(d.scheduledDate)," • Route: ",d.route]}),l.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:d.items.map((f,p)=>l.jsxs("span",{className:"px-2 py-1 bg-orange-100 text-orange-700 dark:bg-orange-600/20 dark:text-orange-300 text-xs rounded-full",children:[f.quantity,"x ",f.productName]},p))})]})]},d.id))})]}),l.jsxs("div",{className:"bg-white/50 dark:bg-gray-900/50 backdrop-blur-sm border border-gray-200 dark:border-gray-800 rounded-2xl p-6",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[l.jsx(Eo,{className:"w-5 h-5 text-red-600 dark:text-red-400"}),l.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Alertes"})]}),l.jsxs("div",{className:"space-y-4",children:[a.length>0&&l.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl",children:[l.jsxs("h4",{className:"font-medium text-red-800 dark:text-red-300 mb-2",children:["Paiements en retard (",a.length,")"]}),a.slice(0,3).map(d=>l.jsxs("p",{className:"text-red-700 dark:text-red-400 text-sm",children:[d.customerName," - ",c(d.totalAmount)]},d.id))]}),i.length>0&&l.jsxs("div",{className:"p-4 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl",children:[l.jsxs("h4",{className:"font-medium text-amber-800 dark:text-amber-300 mb-2",children:["Commandes à traiter (",i.length,")"]}),i.slice(0,3).map(d=>l.jsxs("p",{className:"text-amber-700 dark:text-amber-400 text-sm",children:[d.customerName," - ",u(d.orderDate)]},d.id))]}),a.length===0&&i.length===0&&l.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-center py-8",children:"Aucune alerte pour le moment"})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[l.jsxs("div",{className:"bg-white/50 dark:bg-gray-900/50 backdrop-blur-sm border border-gray-200 dark:border-gray-800 rounded-2xl p-6",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[l.jsx(K1,{className:"w-5 h-5 text-amber-600 dark:text-amber-400"}),l.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Meilleurs clients"})]}),l.jsx("div",{className:"space-y-3",children:n.topCustomers.slice(0,5).map((d,f)=>l.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50/50 dark:bg-gray-800/30 rounded-xl",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-amber-600 to-amber-700 rounded-full flex items-center justify-center text-white text-sm font-semibold",children:f+1}),l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-900 dark:text-white font-medium",children:d.customerName}),l.jsxs("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:[d.orderCount," commandes"]})]})]}),l.jsx("div",{className:"text-right",children:l.jsx("p",{className:"text-gray-900 dark:text-white font-semibold",children:c(d.totalSpent)})})]},d.customerId))})]}),l.jsxs("div",{className:"bg-white/50 dark:bg-gray-900/50 backdrop-blur-sm border border-gray-200 dark:border-gray-800 rounded-2xl p-6",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[l.jsx(ZR,{className:"w-5 h-5 text-emerald-600 dark:text-emerald-400"}),l.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Produits populaires"})]}),l.jsx("div",{className:"space-y-3",children:n.topProducts.slice(0,5).map((d,f)=>l.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50/50 dark:bg-gray-800/30 rounded-xl",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-emerald-600 to-emerald-700 rounded-full flex items-center justify-center text-white text-sm font-semibold",children:f+1}),l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-900 dark:text-white font-medium",children:d.productName}),l.jsxs("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:[d.quantity," vendus"]})]})]}),l.jsx("div",{className:"text-right",children:l.jsx("p",{className:"text-gray-900 dark:text-white font-semibold",children:c(d.revenue)})})]},d.productId))})]})]})]})},dP=({contact:t,onClick:e,onToggleStar:r})=>{const n=i=>{switch(i){case"positive":return"bg-emerald-100 text-emerald-600 dark:bg-emerald-500/20 dark:text-emerald-400";case"needs-attention":return"bg-amber-100 text-amber-600 dark:bg-amber-500/20 dark:text-amber-400";default:return"bg-gray-100 text-gray-600 dark:bg-gray-500/20 dark:text-gray-400"}},s=i=>{if(!i)return"Aucun contact récent";const c=new Date().getTime()-i.getTime(),u=Math.floor(c/(1e3*60*60*24));return u===0?"Aujourd'hui":u===1?"Hier":u<7?`Il y a ${u} jour${u>1?"s":""}`:u<30?`Il y a ${Math.floor(u/7)} semaine${Math.floor(u/7)>1?"s":""}`:`Il y a ${Math.floor(u/30)} mois`};return l.jsxs("div",{onClick:e,className:"group bg-white/50 dark:bg-gray-900/50 backdrop-blur-sm border border-gray-200 dark:border-gray-800 rounded-2xl p-6 hover:bg-gray-50 dark:hover:bg-gray-800/50 hover:border-gray-300 dark:hover:border-gray-700 transition-all duration-300 hover:scale-[1.02] hover:shadow-lg hover:shadow-sage-600/10 cursor-pointer",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-sage-600 to-sage-700 rounded-full flex items-center justify-center text-white font-semibold text-lg",children:t.name.split(" ").map(i=>i[0]).join("")}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-lg text-gray-900 dark:text-white group-hover:text-sage-600 dark:group-hover:text-sage-300 transition-colors",children:t.name}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:t.relationship})]})]}),l.jsx("button",{onClick:i=>{i.stopPropagation(),r(t.id)},className:`p-2 rounded-full transition-all duration-200 hover:scale-110 ${t.starred?"text-amber-500 hover:text-amber-400":"text-gray-400 dark:text-gray-500 hover:text-amber-500"}`,children:l.jsx(K1,{className:`w-5 h-5 ${t.starred?"fill-current":""}`})})]}),l.jsxs("div",{className:"flex items-center space-x-4 mb-4 text-sm text-gray-600 dark:text-gray-400",children:[t.email&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(Vs,{className:"w-4 h-4"}),l.jsx("span",{className:"truncate max-w-32",children:t.email})]}),t.phone&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(Ko,{className:"w-4 h-4"}),l.jsx("span",{children:t.phone})]})]}),l.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[t.tags.slice(0,3).map(i=>l.jsx("span",{className:"px-2 py-1 bg-sage-100 text-sage-700 dark:bg-sage-600/20 dark:text-sage-300 text-xs rounded-full border border-sage-200 dark:border-sage-600/30",children:i},i)),t.tags.length>3&&l.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 dark:bg-gray-700/50 dark:text-gray-400 text-xs rounded-full",children:["+",t.tags.length-3," more"]})]}),l.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-800",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:`w-2 h-2 rounded-full ${n(t.sentiment).replace("text-","bg-").replace("/20","/60")}`}),l.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Dernier contact : ",s(t.lastContact)]})]}),l.jsxs("div",{className:"flex items-center space-x-1 text-gray-500 dark:text-gray-500",children:[l.jsx(kf,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm",children:t.notes.length})]})]})]})},hP=({contacts:t,onContactClick:e,onToggleStar:r,onAddContact:n})=>{const[s,i]=L.useState(""),[a,c]=L.useState("all"),u=t.filter(f=>{const p=f.name.toLowerCase().includes(s.toLowerCase())||f.tags.some(w=>w.toLowerCase().includes(s.toLowerCase())),g=a==="all"||a==="starred"&&f.starred||a==="needs-attention"&&f.sentiment==="needs-attention";return p&&g}),d=[{id:"all",label:"Toutes les personnes",count:t.length},{id:"starred",label:"Favoris",count:t.filter(f=>f.starred).length},{id:"needs-attention",label:"Nécessite attention",count:t.filter(f=>f.sentiment==="needs-attention").length}];return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"Vos Personnes"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Gérez votre réseau personnel"})]}),l.jsxs("button",{onClick:n,className:"flex items-center space-x-2 bg-sage-600 hover:bg-sage-700 text-white px-4 py-2 rounded-xl transition-all duration-200 hover:scale-105 hover:shadow-lg hover:shadow-sage-600/25",children:[l.jsx(Qu,{className:"w-4 h-4"}),l.jsx("span",{children:"Ajouter une personne"})]})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4",children:[l.jsxs("div",{className:"flex-1 relative",children:[l.jsx(su,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 dark:text-gray-400 w-5 h-5"}),l.jsx("input",{type:"text",placeholder:"Rechercher des personnes ou des tags...",value:s,onChange:f=>i(f.target.value),className:"w-full pl-10 pr-4 py-3 bg-white/50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent transition-all"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(q1,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"}),l.jsx("select",{value:a,onChange:f=>c(f.target.value),className:"bg-white/50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent",children:d.map(f=>l.jsxs("option",{value:f.id,children:[f.label," (",f.count,")"]},f.id))})]})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:u.map(f=>l.jsx(dP,{contact:f,onClick:()=>e(f),onToggleStar:r},f.id))}),u.length===0&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"w-16 h-16 bg-gray-200 dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(su,{className:"w-8 h-8 text-gray-500 dark:text-gray-500"})}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Aucune personne trouvée"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:s?"Essayez d'ajuster vos termes de recherche":"Commencez à ajouter des personnes à votre réseau"})]})]})},fP=({orders:t,customers:e,products:r,onCreateOrder:n,onViewOrder:s,onEditOrder:i,onShowReceipt:a})=>{const[c,u]=L.useState(""),[d,f]=L.useState("all"),p=t.filter(_=>{const k=_.customerName.toLowerCase().includes(c.toLowerCase())||_.id.toLowerCase().includes(c.toLowerCase()),j=d==="all"||_.status===d;return k&&j}),g=_=>{switch(_){case"pending":return"bg-amber-100 text-amber-800 dark:bg-amber-900/20 dark:text-amber-300";case"confirmed":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300";case"delivered":return"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/20 dark:text-emerald-300";case"cancelled":return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300"}},w=_=>{switch(_){case"paid":return"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/20 dark:text-emerald-300";case"pending":return"bg-amber-100 text-amber-800 dark:bg-amber-900/20 dark:text-amber-300";case"overdue":return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300"}},N=_=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"MGA",minimumFractionDigits:0,maximumFractionDigits:0}).format(_),S=_=>new Intl.DateTimeFormat("fr-FR",{day:"numeric",month:"short",year:"numeric"}).format(_),C={pending:"En attente",confirmed:"Confirmée",delivered:"Livrée",cancelled:"Annulée"},T={paid:"Payé",pending:"En attente",overdue:"En retard"};return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"Commandes"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Gérez toutes vos commandes de kéfir"})]}),l.jsxs("button",{onClick:n,className:"flex items-center space-x-2 bg-sage-600 hover:bg-sage-700 text-white px-4 py-2 rounded-xl transition-all duration-200 hover:scale-105 hover:shadow-lg hover:shadow-sage-600/25",children:[l.jsx(Qu,{className:"w-4 h-4"}),l.jsx("span",{children:"Nouvelle commande"})]})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4",children:[l.jsxs("div",{className:"flex-1 relative",children:[l.jsx(su,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),l.jsx("input",{type:"text",placeholder:"Rechercher par client ou numéro de commande...",value:c,onChange:_=>u(_.target.value),className:"w-full pl-10 pr-4 py-3 bg-white/50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(q1,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"}),l.jsxs("select",{value:d,onChange:_=>f(_.target.value),className:"bg-white/50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent",children:[l.jsx("option",{value:"all",children:"Tous les statuts"}),l.jsx("option",{value:"pending",children:"En attente"}),l.jsx("option",{value:"confirmed",children:"Confirmées"}),l.jsx("option",{value:"delivered",children:"Livrées"}),l.jsx("option",{value:"cancelled",children:"Annulées"})]})]})]}),l.jsx("div",{className:"space-y-4",children:p.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"w-16 h-16 bg-gray-200 dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(At,{className:"w-8 h-8 text-gray-500"})}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Aucune commande trouvée"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:c?"Essayez d'ajuster vos critères de recherche":"Créez votre première commande"})]}):p.map(_=>l.jsxs("div",{className:"bg-white/50 dark:bg-gray-900/50 backdrop-blur-sm border border-gray-200 dark:border-gray-800 rounded-2xl p-6 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-all duration-200",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-sage-600 to-sage-700 rounded-full flex items-center justify-center text-white font-semibold",children:l.jsx(At,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Commande #",_.id]}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:_.customerName}),l.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-500",children:[S(_.orderDate),_.deliveryDate&&` • Livraison: ${S(_.deliveryDate)}`]})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${g(_.status)}`,children:C[_.status]}),l.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${w(_.paymentStatus)}`,children:T[_.paymentStatus]})]})]}),l.jsx("div",{className:"mb-4",children:l.jsx("div",{className:"flex flex-wrap gap-2",children:_.items.map((k,j)=>l.jsxs("span",{className:"px-3 py-1 bg-sage-100 text-sage-700 dark:bg-sage-600/20 dark:text-sage-300 text-sm rounded-full border border-sage-200 dark:border-sage-600/30",children:[k.quantity,"x ",k.productName]},j))})}),l.jsx("div",{className:"mb-4 p-3 bg-gray-50 dark:bg-gray-800/50 rounded-xl",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx(iu,{className:"w-4 h-4 text-gray-500 mt-0.5"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:_.deliveryAddress.street}),l.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-500",children:[_.deliveryAddress.postalCode," ",_.deliveryAddress.city]})]})]})}),l.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-800",children:[l.jsxs("div",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Total: ",N(_.totalAmount)]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("button",{onClick:()=>s(_),className:"flex items-center space-x-1 px-3 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:[l.jsx(wf,{className:"w-4 h-4"}),l.jsx("span",{children:"Voir"})]}),l.jsxs("button",{onClick:()=>i(_),className:"flex items-center space-x-1 px-3 py-2 text-sage-600 dark:text-sage-400 hover:text-sage-700 dark:hover:text-sage-300 hover:bg-sage-100 dark:hover:bg-sage-600/20 rounded-lg transition-colors",children:[l.jsx(W1,{className:"w-4 h-4"}),l.jsx("span",{children:"Modifier"})]}),l.jsxs("button",{onClick:()=>a(_),className:"flex items-center space-x-1 px-3 py-2 text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 hover:bg-blue-100 dark:hover:bg-blue-600/20 rounded-lg transition-colors",children:[l.jsx(At,{className:"w-4 h-4"}),l.jsx("span",{children:"Reçu"})]})]})]}),_.notes&&l.jsx("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl",children:l.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-300",children:[l.jsx("strong",{children:"Note:"})," ",_.notes]})})]},_.id))})]})},mP=({products:t,onAddProduct:e,onEditProduct:r,onDeleteProduct:n})=>{const[s,i]=L.useState(""),[a,c]=L.useState("all"),u=t.filter(w=>{const N=w.name.toLowerCase().includes(s.toLowerCase())||w.description.toLowerCase().includes(s.toLowerCase()),S=a==="all"||w.type===a;return N&&S}),d=w=>{switch(w){case"milk-kefir":return"Kéfir de lait";case"water-kefir":return"Kéfir d'eau";case"kombucha":return"Kombucha";case"cheese":return"Fromages";case"fermented-vegetables":return"Légumes fermentés";case"accessories":return"Accessoires";default:return w.charAt(0).toUpperCase()+w.slice(1)}},f=w=>{switch(w){case"milk-kefir":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300";case"water-kefir":return"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/20 dark:text-emerald-300";case"kombucha":return"bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-300";case"cheese":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300";case"fermented-vegetables":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300";case"accessories":return"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300"}},p=w=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"MGA",minimumFractionDigits:0,maximumFractionDigits:0}).format(w),g=t.filter(w=>w.inStock<=w.minStock);return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"Produits"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Gérez votre catalogue de kéfir"})]}),l.jsxs("button",{onClick:e,className:"flex items-center space-x-2 bg-sage-600 hover:bg-sage-700 text-white px-4 py-2 rounded-xl transition-all duration-200 hover:scale-105 hover:shadow-lg hover:shadow-sage-600/25",children:[l.jsx(Qu,{className:"w-4 h-4"}),l.jsx("span",{children:"Nouveau produit"})]})]}),g.length>0&&l.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-2xl p-4",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[l.jsx(bo,{className:"w-5 h-5 text-amber-600 dark:text-amber-400"}),l.jsxs("h3",{className:"font-medium text-amber-800 dark:text-amber-300",children:["Alerte stock faible (",g.length," produits)"]})]}),l.jsx("div",{className:"flex flex-wrap gap-2",children:g.map(w=>l.jsxs("span",{className:"px-2 py-1 bg-amber-100 text-amber-800 dark:bg-amber-800/30 dark:text-amber-300 text-sm rounded-full",children:[w.name," (",w.inStock," restants)"]},w.id))})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4",children:[l.jsxs("div",{className:"flex-1 relative",children:[l.jsx(su,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),l.jsx("input",{type:"text",placeholder:"Rechercher des produits...",value:s,onChange:w=>i(w.target.value),className:"w-full pl-10 pr-4 py-3 bg-white/50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),l.jsxs("select",{value:a,onChange:w=>c(w.target.value),className:"bg-white/50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent",children:[l.jsx("option",{value:"all",children:"Tous les types"}),l.jsx("option",{value:"milk-kefir",children:"Kéfir de lait"}),l.jsx("option",{value:"water-kefir",children:"Kéfir d'eau"}),l.jsx("option",{value:"kombucha",children:"Kombucha"}),l.jsx("option",{value:"cheese",children:"Fromages"}),l.jsx("option",{value:"fermented-vegetables",children:"Légumes fermentés"}),l.jsx("option",{value:"accessories",children:"Accessoires"})]})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:u.length===0?l.jsxs("div",{className:"col-span-full text-center py-12",children:[l.jsx("div",{className:"w-16 h-16 bg-gray-200 dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(At,{className:"w-8 h-8 text-gray-500"})}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Aucun produit trouvé"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:s?"Essayez d'ajuster vos critères de recherche":"Ajoutez votre premier produit"})]}):u.map(w=>l.jsxs("div",{className:"bg-white/50 dark:bg-gray-900/50 backdrop-blur-sm border border-gray-200 dark:border-gray-800 rounded-2xl p-6 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-all duration-200 hover:scale-[1.02] hover:shadow-lg",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-sage-600 to-sage-700 rounded-full flex items-center justify-center text-white font-semibold",children:l.jsx(At,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-lg text-gray-900 dark:text-white",children:w.name}),l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${f(w.type)}`,children:d(w.type)})]})]}),l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx("button",{onClick:()=>r(w),className:"p-2 text-gray-500 hover:text-sage-600 dark:hover:text-sage-400 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:l.jsx(W1,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>n(w.id),className:"p-2 text-gray-500 hover:text-red-600 dark:hover:text-red-400 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:l.jsx(JR,{className:"w-4 h-4"})})]})]}),l.jsxs("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4 line-clamp-2",children:[p(w.price)," / ",w.unit==="liter"?"litre":w.unit==="piece"?"pièce":w.unit]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Prix"}),l.jsxs("span",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[p(w.price)," / ",w.unit==="liter"?"litre":w.unit==="piece"?"pièce":w.unit]})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Stock"}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:`font-medium ${w.inStock<=w.minStock?"text-red-600 dark:text-red-400":"text-gray-900 dark:text-white"}`,children:w.inStock}),w.inStock<=w.minStock&&l.jsx(bo,{className:"w-4 h-4 text-red-500"})]})]}),l.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:l.jsx("div",{className:`h-2 rounded-full transition-all ${w.inStock<=w.minStock?"bg-red-500":w.inStock<=w.minStock*2?"bg-amber-500":"bg-emerald-500"}`,style:{width:`${Math.min(w.inStock/(w.minStock*3)*100,100)}%`}})}),l.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-500",children:["Stock minimum: ",w.minStock]})]})]},w.id))})]})},pP=({notes:t,contacts:e})=>{const r=u=>{const d=e.find(f=>f.id===u);return(d==null?void 0:d.name)||"Contact inconnu"},n=u=>{switch(u){case"appel":return Ko;case"email":return Vs;case"rencontre":return yp;default:return kf}},s=u=>{switch(u){case"appel":return"text-blue-600 bg-blue-100 dark:text-blue-400 dark:bg-blue-500/20";case"email":return"text-purple-600 bg-purple-100 dark:text-purple-400 dark:bg-purple-500/20";case"rencontre":return"text-green-600 bg-green-100 dark:text-green-400 dark:bg-green-500/20";default:return"text-sage-600 bg-sage-100 dark:text-sage-400 dark:bg-sage-500/20"}},i=u=>{switch(u){case"positive":return"border-l-emerald-500";case"needs-attention":return"border-l-amber-500";default:return"border-l-gray-400 dark:border-l-gray-500"}},a=u=>new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"}).format(u),c=[...t].sort((u,d)=>d.date.getTime()-u.date.getTime());return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"Fil de mémoire"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Votre historique d'interactions et notes"})]}),l.jsx("div",{className:"space-y-6",children:c.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"w-16 h-16 bg-gray-200 dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(kf,{className:"w-8 h-8 text-gray-500 dark:text-gray-500"})}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Aucune mémoire pour le moment"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Commencez à ajouter des notes sur vos interactions pour construire votre fil de mémoire"})]}):c.map((u,d)=>{const f=n(u.type),p=s(u.type),g=i(u.sentiment);return l.jsxs("div",{className:`relative bg-white/50 dark:bg-gray-900/50 backdrop-blur-sm border border-gray-200 dark:border-gray-800 rounded-2xl p-6 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-all duration-300 border-l-4 ${g}`,children:[d<c.length-1&&l.jsx("div",{className:"absolute left-8 -bottom-6 w-px h-6 bg-gray-300 dark:bg-gray-700"}),l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${p}`,children:l.jsx(f,{className:"w-5 h-5"})}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:r(u.contactId)}),l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400",children:[l.jsx("span",{className:"capitalize",children:u.type}),l.jsx("span",{children:"•"}),l.jsx("span",{children:a(u.date)})]})]}),l.jsx("div",{className:`w-3 h-3 rounded-full ${u.sentiment==="positive"?"bg-emerald-500":u.sentiment==="needs-attention"?"bg-amber-500":"bg-gray-400 dark:bg-gray-500"}`})]}),l.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed mb-4",children:u.content}),u.tags.length>0&&l.jsx("div",{className:"flex flex-wrap gap-2",children:u.tags.map(w=>l.jsx("span",{className:"px-2 py-1 bg-sage-100 text-sage-700 dark:bg-sage-600/20 dark:text-sage-300 text-xs rounded-full border border-sage-200 dark:border-sage-600/30",children:w},w))})]})]})]},u.id)})})]})},gP=({isOpen:t,onClose:e,contacts:r,onSave:n})=>{const[s,i]=L.useState(""),[a,c]=L.useState(""),[u,d]=L.useState("note"),[f,p]=L.useState("neutral"),[g,w]=L.useState([]),[N,S]=L.useState(""),[C,T]=L.useState(!1),_=async()=>{if(!s||!a.trim())return;T(!0);const D={contactId:s,content:a.trim(),date:new Date,tags:g,sentiment:f,type:u};await new Promise(v=>setTimeout(v,1e3)),n(D),i(""),c(""),d("note"),p("neutral"),w([]),S(""),T(!1),e()},k=()=>{N.trim()&&!g.includes(N.trim())&&(w([...g,N.trim()]),S(""))},j=D=>{w(g.filter(v=>v!==D))},F=[{value:"positive",icon:YR,color:"text-emerald-600 dark:text-emerald-400",bgColor:"bg-emerald-100 dark:bg-emerald-500/20"},{value:"neutral",icon:qR,color:"text-gray-600 dark:text-gray-400",bgColor:"bg-gray-100 dark:bg-gray-500/20"},{value:"needs-attention",icon:bo,color:"text-amber-600 dark:text-amber-400",bgColor:"bg-amber-100 dark:bg-amber-500/20"}];return t?l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 dark:bg-black/80 backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-2xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-800",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Ajouter une nouvelle note"}),l.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors",children:l.jsx(Ct,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),l.jsxs("div",{className:"p-6 space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Personne"}),l.jsxs("select",{value:s,onChange:D=>i(D.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Sélectionner une personne..."}),r.map(D=>l.jsx("option",{value:D.id,children:D.name},D.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Type d'interaction"}),l.jsx("div",{className:"grid grid-cols-4 gap-2",children:["note","appel","email","rencontre"].map(D=>l.jsx("button",{onClick:()=>d(D),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${u===D?"bg-sage-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"}`,children:D.charAt(0).toUpperCase()+D.slice(1)},D))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Contenu de la note"}),l.jsx("textarea",{value:a,onChange:D=>c(D.target.value),placeholder:"Que s'est-il passé ? Comment ça s'est déroulé ? Des détails importants à retenir...",rows:6,className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent resize-none"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Comment vous êtes-vous senti ?"}),l.jsx("div",{className:"flex space-x-2",children:F.map(D=>{const v=D.icon;return l.jsxs("button",{onClick:()=>p(D.value),className:`flex items-center space-x-2 px-4 py-3 rounded-xl transition-all ${f===D.value?`${D.bgColor} ${D.color} border border-current`:"bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-gray-700"}`,children:[l.jsx(v,{className:"w-5 h-5"}),l.jsx("span",{className:"capitalize",children:D.value==="positive"?"Positif":D.value==="needs-attention"?"Nécessite attention":"Neutre"})]},D.value)})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Tags"}),l.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:g.map(D=>l.jsxs("span",{className:"flex items-center space-x-1 px-3 py-1 bg-sage-100 text-sage-700 dark:bg-sage-600/20 dark:text-sage-300 text-sm rounded-full border border-sage-200 dark:border-sage-600/30",children:[l.jsx("span",{children:D}),l.jsx("button",{onClick:()=>j(D),className:"hover:text-sage-600 dark:hover:text-sage-200",children:l.jsx(Ct,{className:"w-3 h-3"})})]},D))}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("input",{type:"text",value:N,onChange:D=>S(D.target.value),onKeyPress:D=>D.key==="Enter"&&k(),placeholder:"Ajouter un tag...",className:"flex-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg px-3 py-2 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"}),l.jsxs("button",{onClick:k,className:"px-4 py-2 bg-sage-600 hover:bg-sage-700 text-white rounded-lg transition-colors flex items-center space-x-1",children:[l.jsx(gp,{className:"w-4 h-4"}),l.jsx("span",{children:"Ajouter"})]})]})]})]}),l.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-800",children:[l.jsx("button",{onClick:e,className:"px-6 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-300 transition-colors",children:"Annuler"}),l.jsxs("button",{onClick:_,disabled:!s||!a.trim()||C,className:`flex items-center space-x-2 px-6 py-2 rounded-lg font-medium transition-all ${!s||!a.trim()||C?"bg-gray-300 text-gray-500 cursor-not-allowed dark:bg-gray-700 dark:text-gray-500":"bg-sage-600 hover:bg-sage-700 text-white hover:scale-105 hover:shadow-lg hover:shadow-sage-600/25"}`,children:[l.jsx(Qi,{className:`w-4 h-4 ${C?"animate-pulse":""}`}),l.jsx("span",{children:C?"Enregistrement...":"Enregistrer la note"})]})]})]})}):null},yP=({isOpen:t,onClose:e,onSave:r})=>{const[n,s]=L.useState({name:"",email:"",phone:"",relationship:"",metAt:"",sentiment:"neutral"}),[i,a]=L.useState([]),[c,u]=L.useState(""),[d,f]=L.useState(!1),[p,g]=L.useState(!1),w=(k,j)=>{s(F=>({...F,[k]:j}))},N=()=>{c.trim()&&!i.includes(c.trim())&&(a([...i,c.trim()]),u(""))},S=k=>{a(i.filter(j=>j!==k))},C=async()=>{if(!n.name.trim())return;g(!0);const k={name:n.name.trim(),email:n.email.trim()||void 0,phone:n.phone.trim()||void 0,relationship:n.relationship.trim()||"Contact",metAt:n.metAt.trim()||void 0,sentiment:n.sentiment,tags:i,starred:d,lastContact:void 0,nextReminder:void 0};await new Promise(j=>setTimeout(j,1e3)),r(k),s({name:"",email:"",phone:"",relationship:"",metAt:"",sentiment:"neutral"}),a([]),u(""),f(!1),g(!1),e()},T=["Ami proche","Ami","Collègue","Ex-collègue","Client","Fournisseur","Mentor","Famille","Voisin","Contact professionnel","Partenaire"],_=["ami","famille","collègue","client","mentor","créatif","tech","startup","designer","développeur","manager","entrepreneur"];return t?l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 dark:bg-black/80 backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-2xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-800",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Ajouter une nouvelle personne"}),l.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors",children:l.jsx(Ct,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),l.jsxs("div",{className:"p-6 space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(Yu,{className:"w-4 h-4 inline mr-1"}),"Nom complet *"]}),l.jsx("input",{type:"text",value:n.name,onChange:k=>w("name",k.target.value),placeholder:"Jean Dupont",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(H1,{className:"w-4 h-4 inline mr-1"}),"Relation"]}),l.jsx("input",{type:"text",value:n.relationship,onChange:k=>w("relationship",k.target.value),placeholder:"Ami, Collègue, Client...",list:"relationship-suggestions",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"}),l.jsx("datalist",{id:"relationship-suggestions",children:T.map(k=>l.jsx("option",{value:k},k))})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(Vs,{className:"w-4 h-4 inline mr-1"}),"Email"]}),l.jsx("input",{type:"email",value:n.email,onChange:k=>w("email",k.target.value),placeholder:"jean@example.com",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(Ko,{className:"w-4 h-4 inline mr-1"}),"Téléphone"]}),l.jsx("input",{type:"tel",value:n.phone,onChange:k=>w("phone",k.target.value),placeholder:"+261 32 12 345 67",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(Gu,{className:"w-4 h-4 inline mr-1"}),"Où vous vous êtes rencontrés"]}),l.jsx("input",{type:"text",value:n.metAt,onChange:k=>w("metAt",k.target.value),placeholder:"Conférence, travail, ami commun...",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Première impression"}),l.jsx("div",{className:"flex space-x-2",children:[{value:"positive",label:"Positive",color:"text-emerald-600 bg-emerald-100 dark:text-emerald-400 dark:bg-emerald-500/20"},{value:"neutral",label:"Neutre",color:"text-gray-600 bg-gray-100 dark:text-gray-400 dark:bg-gray-500/20"},{value:"needs-attention",label:"À revoir",color:"text-amber-600 bg-amber-100 dark:text-amber-400 dark:bg-amber-500/20"}].map(k=>l.jsx("button",{onClick:()=>w("sentiment",k.value),className:`px-4 py-2 rounded-xl transition-all ${n.sentiment===k.value?`${k.color} border border-current`:"bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-gray-700"}`,children:k.label},k.value))})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(gp,{className:"w-4 h-4 inline mr-1"}),"Tags"]}),l.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:i.map(k=>l.jsxs("span",{className:"flex items-center space-x-1 px-3 py-1 bg-sage-100 text-sage-700 dark:bg-sage-600/20 dark:text-sage-300 text-sm rounded-full border border-sage-200 dark:border-sage-600/30",children:[l.jsx("span",{children:k}),l.jsx("button",{onClick:()=>S(k),className:"hover:text-sage-600 dark:hover:text-sage-200",children:l.jsx(Ct,{className:"w-3 h-3"})})]},k))}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("input",{type:"text",value:c,onChange:k=>u(k.target.value),onKeyPress:k=>k.key==="Enter"&&N(),placeholder:"Ajouter un tag...",list:"tag-suggestions",className:"flex-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg px-3 py-2 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"}),l.jsx("datalist",{id:"tag-suggestions",children:_.map(k=>l.jsx("option",{value:k},k))}),l.jsx("button",{onClick:N,className:"px-4 py-2 bg-sage-600 hover:bg-sage-700 text-white rounded-lg transition-colors",children:"Ajouter"})]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",id:"starred",checked:d,onChange:k=>f(k.target.checked),className:"w-4 h-4 text-sage-600 bg-gray-100 border-gray-300 rounded focus:ring-sage-500 dark:focus:ring-sage-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),l.jsx("label",{htmlFor:"starred",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Marquer comme favori"})]})]}),l.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-800",children:[l.jsx("button",{onClick:e,className:"px-6 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-300 transition-colors",children:"Annuler"}),l.jsxs("button",{onClick:C,disabled:!n.name.trim()||p,className:`flex items-center space-x-2 px-6 py-2 rounded-lg font-medium transition-all ${!n.name.trim()||p?"bg-gray-300 text-gray-500 cursor-not-allowed dark:bg-gray-700 dark:text-gray-500":"bg-sage-600 hover:bg-sage-700 text-white hover:scale-105 hover:shadow-lg hover:shadow-sage-600/25"}`,children:[l.jsx(Qi,{className:`w-4 h-4 ${p?"animate-pulse":""}`}),l.jsx("span",{children:p?"Enregistrement...":"Ajouter la personne"})]})]})]})}):null},vP=({isOpen:t,onClose:e,contact:r,onSave:n})=>{const[s,i]=L.useState({name:"",email:"",phone:"",relationship:"",metAt:"",sentiment:"neutral",customerStatus:"active",orderFrequency:"monthly",paymentMethod:"cash"}),[a,c]=L.useState({street:"",city:"",postalCode:"",country:"Madagascar",deliveryInstructions:""}),[u,d]=L.useState({preferredDay:"saturday",preferredTime:"morning",frequency:"weekly"}),[f,p]=L.useState([]),[g,w]=L.useState(""),[N,S]=L.useState(!1),[C,T]=L.useState(!1);L.useEffect(()=>{var v,y,E;r&&(i({name:r.name,email:r.email||"",phone:r.phone||"",relationship:r.relationship,metAt:r.metAt||"",sentiment:r.sentiment,customerStatus:r.customerStatus,orderFrequency:r.orderFrequency,paymentMethod:r.paymentMethod||"cash"}),c(r.address||{street:"",city:"",postalCode:"",country:"Madagascar",deliveryInstructions:""}),d({preferredDay:((v=r.deliveryPreferences)==null?void 0:v.preferredDay)||"saturday",preferredTime:((y=r.deliveryPreferences)==null?void 0:y.preferredTime)||"morning",frequency:((E=r.deliveryPreferences)==null?void 0:E.frequency)||"weekly"}),p(r.tags),S(r.starred))},[r]);const _=(v,y)=>{i(E=>({...E,[v]:y}))},k=(v,y)=>{c(E=>({...E,[v]:y}))},j=()=>{g.trim()&&!f.includes(g.trim())&&(p([...f,g.trim()]),w(""))},F=v=>{p(f.filter(y=>y!==v))},D=async()=>{var y;if(!r||!s.name.trim())return;T(!0);const v={...r,name:s.name.trim(),email:s.email.trim()||void 0,phone:s.phone.trim()||void 0,relationship:s.relationship.trim()||"Contact",metAt:s.metAt.trim()||void 0,sentiment:s.sentiment,customerStatus:s.customerStatus,orderFrequency:s.orderFrequency,paymentMethod:s.paymentMethod,address:a.street?a:void 0,deliveryPreferences:{...u,nextDelivery:(y=r.deliveryPreferences)==null?void 0:y.nextDelivery},tags:f,starred:N};await new Promise(E=>setTimeout(E,1e3)),n(v),T(!1),e()};return!t||!r?null:l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 dark:bg-black/80 backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-2xl w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-800",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Modifier le client"}),l.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors",children:l.jsx(Ct,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),l.jsxs("div",{className:"p-6 space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(Yu,{className:"w-4 h-4 inline mr-1"}),"Nom complet *"]}),l.jsx("input",{type:"text",value:s.name,onChange:v=>_("name",v.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(H1,{className:"w-4 h-4 inline mr-1"}),"Relation"]}),l.jsx("input",{type:"text",value:s.relationship,onChange:v=>_("relationship",v.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(Vs,{className:"w-4 h-4 inline mr-1"}),"Email"]}),l.jsx("input",{type:"email",value:s.email,onChange:v=>_("email",v.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(Ko,{className:"w-4 h-4 inline mr-1"}),"Téléphone"]}),l.jsx("input",{type:"tel",value:s.phone,onChange:v=>_("phone",v.target.value),placeholder:"+261 32 12 345 67",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Adresse de livraison"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"md:col-span-2",children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(Gu,{className:"w-4 h-4 inline mr-1"}),"Rue"]}),l.jsx("input",{type:"text",value:a.street,onChange:v=>k("street",v.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Ville"}),l.jsx("input",{type:"text",value:a.city,onChange:v=>k("city",v.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Code postal"}),l.jsx("input",{type:"text",value:a.postalCode,onChange:v=>k("postalCode",v.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),l.jsxs("div",{className:"md:col-span-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Instructions de livraison"}),l.jsx("textarea",{value:a.deliveryInstructions,onChange:v=>k("deliveryInstructions",v.target.value),rows:2,className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent resize-none"})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Statut client"}),l.jsxs("select",{value:s.customerStatus,onChange:v=>_("customerStatus",v.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500",children:[l.jsx("option",{value:"active",children:"Actif"}),l.jsx("option",{value:"inactive",children:"Inactif"}),l.jsx("option",{value:"prospect",children:"Prospect"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Fréquence de commande"}),l.jsxs("select",{value:s.orderFrequency,onChange:v=>_("orderFrequency",v.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500",children:[l.jsx("option",{value:"weekly",children:"Hebdomadaire"}),l.jsx("option",{value:"bi-weekly",children:"Bi-hebdomadaire"}),l.jsx("option",{value:"monthly",children:"Mensuelle"}),l.jsx("option",{value:"occasional",children:"Occasionnelle"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Méthode de paiement"}),l.jsxs("select",{value:s.paymentMethod,onChange:v=>_("paymentMethod",v.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500",children:[l.jsx("option",{value:"cash",children:"Espèces"}),l.jsx("option",{value:"mvola",children:"MVola"}),l.jsx("option",{value:"orange-money",children:"Orange Money"}),l.jsx("option",{value:"airtel-money",children:"Airtel Money"}),l.jsx("option",{value:"transfer",children:"Virement"}),l.jsx("option",{value:"check",children:"Chèque"})]})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(gp,{className:"w-4 h-4 inline mr-1"}),"Tags"]}),l.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:f.map(v=>l.jsxs("span",{className:"flex items-center space-x-1 px-3 py-1 bg-sage-100 text-sage-700 dark:bg-sage-600/20 dark:text-sage-300 text-sm rounded-full border border-sage-200 dark:border-sage-600/30",children:[l.jsx("span",{children:v}),l.jsx("button",{onClick:()=>F(v),className:"hover:text-sage-600 dark:hover:text-sage-200",children:l.jsx(Ct,{className:"w-3 h-3"})})]},v))}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("input",{type:"text",value:g,onChange:v=>w(v.target.value),onKeyPress:v=>v.key==="Enter"&&j(),placeholder:"Ajouter un tag...",className:"flex-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg px-3 py-2 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500"}),l.jsx("button",{onClick:j,className:"px-4 py-2 bg-sage-600 hover:bg-sage-700 text-white rounded-lg transition-colors",children:"Ajouter"})]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",id:"starred",checked:N,onChange:v=>S(v.target.checked),className:"w-4 h-4 text-sage-600 bg-gray-100 border-gray-300 rounded focus:ring-sage-500"}),l.jsx("label",{htmlFor:"starred",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Marquer comme favori"})]})]}),l.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-800",children:[l.jsx("button",{onClick:e,className:"px-6 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-300 transition-colors",children:"Annuler"}),l.jsxs("button",{onClick:D,disabled:!s.name.trim()||C,className:`flex items-center space-x-2 px-6 py-2 rounded-lg font-medium transition-all ${!s.name.trim()||C?"bg-gray-300 text-gray-500 cursor-not-allowed dark:bg-gray-700 dark:text-gray-500":"bg-sage-600 hover:bg-sage-700 text-white hover:scale-105 hover:shadow-lg hover:shadow-sage-600/25"}`,children:[l.jsx(Qi,{className:`w-4 h-4 ${C?"animate-pulse":""}`}),l.jsx("span",{children:C?"Enregistrement...":"Enregistrer les modifications"})]})]})]})})},xP=({isOpen:t,onClose:e,order:r})=>{if(!t||!r)return null;const n=d=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"MGA",minimumFractionDigits:0,maximumFractionDigits:0}).format(d),s=d=>new Intl.DateTimeFormat("fr-FR",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(d),i=d=>{switch(d){case"pending":return"bg-amber-100 text-amber-800 dark:bg-amber-900/20 dark:text-amber-300";case"confirmed":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300";case"delivered":return"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/20 dark:text-emerald-300";case"cancelled":return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300"}},a=d=>{switch(d){case"paid":return"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/20 dark:text-emerald-300";case"pending":return"bg-amber-100 text-amber-800 dark:bg-amber-900/20 dark:text-amber-300";case"overdue":return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300"}},c={pending:"En attente",confirmed:"Confirmée",delivered:"Livrée",cancelled:"Annulée"},u={paid:"Payé",pending:"En attente",overdue:"En retard"};return l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 dark:bg-black/80 backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-2xl w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-800",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-sage-600 to-sage-700 rounded-full flex items-center justify-center text-white",children:l.jsx(At,{className:"w-5 h-5"})}),l.jsxs("div",{children:[l.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Commande #",r.id]}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:r.customerName})]})]}),l.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors",children:l.jsx(Ct,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),l.jsxs("div",{className:"p-6 space-y-6",children:[l.jsxs("div",{className:"flex flex-wrap gap-3",children:[l.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${i(r.status)}`,children:c[r.status]}),l.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${a(r.paymentStatus)}`,children:u[r.paymentStatus]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(mp,{className:"w-5 h-5 text-gray-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Date de commande"}),l.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:s(r.orderDate)})]})]}),r.deliveryDate&&l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(iu,{className:"w-5 h-5 text-gray-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Date de livraison"}),l.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:s(r.deliveryDate)})]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(z1,{className:"w-5 h-5 text-gray-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Méthode de paiement"}),l.jsx("p",{className:"font-medium text-gray-900 dark:text-white capitalize",children:r.paymentMethod})]})]})]}),l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(Gu,{className:"w-5 h-5 text-gray-500 mt-1"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Adresse de livraison"}),l.jsxs("div",{className:"font-medium text-gray-900 dark:text-white",children:[l.jsx("p",{children:r.deliveryAddress.street}),l.jsxs("p",{children:[r.deliveryAddress.postalCode," ",r.deliveryAddress.city]}),l.jsx("p",{children:r.deliveryAddress.country}),r.deliveryAddress.deliveryInstructions&&l.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:["Instructions: ",r.deliveryAddress.deliveryInstructions]})]})]})]})})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Articles commandés"}),l.jsx("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-xl overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-100 dark:bg-gray-800",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 dark:text-gray-300",children:"Produit"}),l.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-700 dark:text-gray-300",children:"Quantité"}),l.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-700 dark:text-gray-300",children:"Prix unitaire"}),l.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-700 dark:text-gray-300",children:"Total"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:r.items.map((d,f)=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-4 py-3 text-gray-900 dark:text-white",children:d.productName}),l.jsx("td",{className:"px-4 py-3 text-center text-gray-900 dark:text-white",children:d.quantity}),l.jsx("td",{className:"px-4 py-3 text-right text-gray-900 dark:text-white",children:n(d.unitPrice)}),l.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-900 dark:text-white",children:n(d.totalPrice)})]},f))}),l.jsx("tfoot",{className:"bg-gray-100 dark:bg-gray-800",children:l.jsxs("tr",{children:[l.jsx("td",{colSpan:3,className:"px-4 py-3 text-right font-semibold text-gray-900 dark:text-white",children:"Total général"}),l.jsx("td",{className:"px-4 py-3 text-right font-bold text-lg text-sage-600 dark:text-sage-400",children:n(r.totalAmount)})]})})]})})})]}),r.notes&&l.jsx("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx($1,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5"}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-blue-800 dark:text-blue-300 mb-1",children:"Notes"}),l.jsx("p",{className:"text-blue-700 dark:text-blue-400",children:r.notes})]})]})})]})]})})},_P=({isOpen:t,onClose:e,vendorInfo:r,onSave:n})=>{const[s,i]=L.useState(r),a=u=>{u.preventDefault(),n(s),e()},c=(u,d)=>{i(f=>({...f,[u]:d}))};return t?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Paramètres de l'entreprise"}),l.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:l.jsx(Ct,{className:"w-6 h-6"})})]}),l.jsxs("form",{onSubmit:a,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[l.jsx(DR,{className:"w-4 h-4 inline mr-2"}),"Nom de l'entreprise"]}),l.jsx("input",{type:"text",value:s.name,onChange:u=>c("name",u.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[l.jsx(Gu,{className:"w-4 h-4 inline mr-2"}),"Adresse"]}),l.jsx("textarea",{value:s.address,onChange:u=>c("address",u.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[l.jsx(Ko,{className:"w-4 h-4 inline mr-2"}),"Téléphone"]}),l.jsx("input",{type:"tel",value:s.phone,onChange:u=>c("phone",u.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[l.jsx(Vs,{className:"w-4 h-4 inline mr-2"}),"Email"]}),l.jsx("input",{type:"email",value:s.email,onChange:u=>c("email",u.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[l.jsx(pp,{className:"w-4 h-4 inline mr-2"}),"NIF - Facultatif"]}),l.jsx("input",{type:"text",value:s.nif||"",onChange:u=>c("nif",u.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Numéro d'identification fiscale (optionnel)"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[l.jsx($1,{className:"w-4 h-4 inline mr-2"}),"STAT - Facultatif"]}),l.jsx("input",{type:"text",value:s.stat||"",onChange:u=>c("stat",u.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Numéro statistique (optionnel)"})]}),l.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200",children:"Annuler"}),l.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Enregistrer"})]})]})]})}):null},wP=({isOpen:t,onClose:e,order:r,vendorInfo:n})=>{if(!t||!r)return null;const s=u=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"MGA",minimumFractionDigits:0,maximumFractionDigits:0}).format(u),i=u=>new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(u),a=()=>{window.print()},c=()=>{console.log("Téléchargement du reçu pour la commande",r.id)};return l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 dark:bg-black/80 backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-2xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-800 print:hidden",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Reçu de vente"}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("button",{onClick:a,className:"p-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",title:"Imprimer",children:l.jsx(KR,{className:"w-5 h-5"})}),l.jsx("button",{onClick:c,className:"p-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",title:"Télécharger PDF",children:l.jsx(FR,{className:"w-5 h-5"})}),l.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors",children:l.jsx(Ct,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]})]}),l.jsxs("div",{className:"p-8 print:p-4",children:[l.jsxs("div",{className:"text-center mb-8 print:mb-6",children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white print:text-black",children:n.name}),l.jsxs("div",{className:"mt-2 text-gray-600 dark:text-gray-400 print:text-gray-700",children:[l.jsx("p",{children:n.address}),l.jsxs("p",{children:["Tél: ",n.phone," | Email: ",n.email]}),l.jsxs("p",{children:["NIF: ",n.nif," | STAT: ",n.stat]})]})]}),l.jsx("div",{className:"border-t border-b border-gray-200 dark:border-gray-700 print:border-gray-300 py-4 mb-6",children:l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-white print:text-black mb-2",children:[l.jsx(At,{className:"w-4 h-4 inline mr-1"}),"Reçu N°"]}),l.jsxs("p",{className:"text-gray-700 dark:text-gray-300 print:text-gray-700",children:["#",r.id]})]}),l.jsxs("div",{children:[l.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-white print:text-black mb-2",children:[l.jsx(mp,{className:"w-4 h-4 inline mr-1"}),"Date"]}),l.jsx("p",{className:"text-gray-700 dark:text-gray-300 print:text-gray-700",children:i(r.orderDate)})]})]})}),l.jsxs("div",{className:"mb-6",children:[l.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-white print:text-black mb-2",children:[l.jsx(Yu,{className:"w-4 h-4 inline mr-1"}),"Client"]}),l.jsxs("div",{className:"text-gray-700 dark:text-gray-300 print:text-gray-700",children:[l.jsx("p",{className:"font-medium",children:r.customerName}),l.jsxs("div",{className:"text-sm mt-1",children:[l.jsx("p",{children:r.deliveryAddress.street}),l.jsxs("p",{children:[r.deliveryAddress.postalCode," ",r.deliveryAddress.city]}),l.jsx("p",{children:r.deliveryAddress.country})]})]})]}),l.jsxs("div",{className:"mb-6",children:[l.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white print:text-black mb-4",children:"Détail de la commande"}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full border-collapse",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-700 print:border-gray-300",children:[l.jsx("th",{className:"text-left py-2 text-gray-900 dark:text-white print:text-black font-medium",children:"Article"}),l.jsx("th",{className:"text-center py-2 text-gray-900 dark:text-white print:text-black font-medium",children:"Qté"}),l.jsx("th",{className:"text-right py-2 text-gray-900 dark:text-white print:text-black font-medium",children:"Prix unit."}),l.jsx("th",{className:"text-right py-2 text-gray-900 dark:text-white print:text-black font-medium",children:"Total"})]})}),l.jsx("tbody",{children:r.items.map((u,d)=>l.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-800 print:border-gray-200",children:[l.jsx("td",{className:"py-3 text-gray-700 dark:text-gray-300 print:text-gray-700",children:u.productName}),l.jsx("td",{className:"py-3 text-center text-gray-700 dark:text-gray-300 print:text-gray-700",children:u.quantity}),l.jsx("td",{className:"py-3 text-right text-gray-700 dark:text-gray-300 print:text-gray-700",children:s(u.unitPrice)}),l.jsx("td",{className:"py-3 text-right font-medium text-gray-900 dark:text-white print:text-black",children:s(u.totalPrice)})]},d))}),l.jsx("tfoot",{children:l.jsxs("tr",{className:"border-t-2 border-gray-300 dark:border-gray-600 print:border-gray-400",children:[l.jsx("td",{colSpan:3,className:"py-4 text-right font-bold text-gray-900 dark:text-white print:text-black text-lg",children:"TOTAL GÉNÉRAL"}),l.jsx("td",{className:"py-4 text-right font-bold text-xl text-sage-600 dark:text-sage-400 print:text-black",children:s(r.totalAmount)})]})})]})})]}),l.jsx("div",{className:"mb-6",children:l.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-900 dark:text-white print:text-black",children:"Méthode de paiement:"}),l.jsx("span",{className:"ml-2 text-gray-700 dark:text-gray-300 print:text-gray-700",children:r.paymentMethod==="mvola"?"MVola":r.paymentMethod==="orange-money"?"Orange Money":r.paymentMethod==="airtel-money"?"Airtel Money":r.paymentMethod==="cash"?"Espèces":r.paymentMethod==="transfer"?"Virement":r.paymentMethod==="check"?"Chèque":r.paymentMethod})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-900 dark:text-white print:text-black",children:"Statut:"}),l.jsx("span",{className:"ml-2 text-gray-700 dark:text-gray-300 print:text-gray-700",children:r.paymentStatus==="paid"?"Payé":r.paymentStatus==="pending"?"En attente":"En retard"})]})]})}),r.notes&&l.jsxs("div",{className:"mb-6",children:[l.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white print:text-black mb-2",children:"Notes"}),l.jsx("p",{className:"text-gray-700 dark:text-gray-300 print:text-gray-700 text-sm bg-gray-50 dark:bg-gray-800 print:bg-gray-100 p-3 rounded-lg",children:r.notes})]}),l.jsxs("div",{className:"text-center text-sm text-gray-600 dark:text-gray-400 print:text-gray-600 border-t border-gray-200 dark:border-gray-700 print:border-gray-300 pt-4",children:[l.jsx("p",{children:"Merci pour votre confiance !"}),l.jsx("p",{className:"mt-1",children:"Ce reçu fait foi de votre achat"})]})]})]})})},kP=({isOpen:t,onClose:e,customers:r,products:n,onSave:s})=>{const[i,a]=L.useState(""),[c,u]=L.useState(""),[d,f]=L.useState("cash"),[p,g]=L.useState(""),[w,N]=L.useState([]),[S,C]=L.useState(!1),T=()=>{N([...w,{productId:"",quantity:1}])},_=(v,y,E)=>{const b=[...w];b[v]={...b[v],[y]:E},N(b)},k=v=>{N(w.filter((y,E)=>E!==v))},j=()=>w.reduce((v,y)=>{const E=n.find(b=>b.id===y.productId);return v+(E?E.price*y.quantity:0)},0),F=async()=>{if(!i||w.length===0||!c)return;C(!0);const v=r.find(b=>b.id===i);if(!v)return;const y=w.map(b=>{const A=n.find(R=>R.id===b.productId);if(!A)throw new Error("Produit non trouvé");return{productId:b.productId,productName:A.name,quantity:b.quantity,unitPrice:A.price,totalPrice:A.price*b.quantity}}),E={customerId:i,customerName:v.name,orderDate:new Date,deliveryDate:new Date(c),status:"pending",items:y,totalAmount:j(),paymentStatus:"pending",paymentMethod:d,deliveryAddress:v.address||{street:"",city:"Antananarivo",postalCode:"101",country:"Madagascar"},notes:p.trim()||void 0};await new Promise(b=>setTimeout(b,1e3)),s(E),a(""),u(""),f("cash"),g(""),N([]),C(!1),e()},D=v=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"MGA",minimumFractionDigits:0,maximumFractionDigits:0}).format(v);return t?l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 dark:bg-black/80 backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-2xl w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-800",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Nouvelle commande"}),l.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors",children:l.jsx(Ct,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),l.jsxs("div",{className:"p-6 space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(Yu,{className:"w-4 h-4 inline mr-1"}),"Client *"]}),l.jsxs("select",{value:i,onChange:v=>a(v.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Sélectionner un client..."}),r.map(v=>l.jsx("option",{value:v.id,children:v.name},v.id))]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(mp,{className:"w-4 h-4 inline mr-1"}),"Date de livraison *"]}),l.jsx("input",{type:"date",value:c,onChange:v=>u(v.target.value),min:new Date().toISOString().split("T")[0],className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(z1,{className:"w-4 h-4 inline mr-1"}),"Méthode de paiement"]}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[{value:"cash",label:"Espèces"},{value:"mvola",label:"MVola"},{value:"orange-money",label:"Orange Money"},{value:"airtel-money",label:"Airtel Money"},{value:"transfer",label:"Virement"},{value:"check",label:"Chèque"}].map(v=>l.jsx("button",{onClick:()=>f(v.value),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${d===v.value?"bg-sage-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"}`,children:v.label},v.value))})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[l.jsx(At,{className:"w-4 h-4 inline mr-1"}),"Articles de la commande *"]}),l.jsx("button",{onClick:T,className:"px-3 py-1 bg-sage-600 hover:bg-sage-700 text-white text-sm rounded-lg transition-colors",children:"Ajouter un article"})]}),l.jsxs("div",{className:"space-y-3",children:[w.map((v,y)=>{var E;return l.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-xl",children:[l.jsxs("select",{value:v.productId,onChange:b=>_(y,"productId",b.target.value),className:"flex-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg px-3 py-2 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500",children:[l.jsx("option",{value:"",children:"Sélectionner un produit..."}),n.map(b=>l.jsxs("option",{value:b.id,children:[b.name," - ",D(b.price)]},b.id))]}),l.jsx("input",{type:"number",min:"1",value:v.quantity,onChange:b=>_(y,"quantity",parseInt(b.target.value)||1),className:"w-20 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg px-3 py-2 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500"}),l.jsx("div",{className:"w-24 text-right text-gray-900 dark:text-white font-medium",children:v.productId?D((((E=n.find(b=>b.id===v.productId))==null?void 0:E.price)||0)*v.quantity):"-"}),l.jsx("button",{onClick:()=>k(y),className:"p-2 text-red-500 hover:bg-red-100 dark:hover:bg-red-900/20 rounded-lg transition-colors",children:l.jsx(Ct,{className:"w-4 h-4"})})]},y)}),w.length===0&&l.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:'Aucun article ajouté. Cliquez sur "Ajouter un article" pour commencer.'})]}),w.length>0&&l.jsx("div",{className:"mt-4 p-4 bg-sage-50 dark:bg-sage-900/20 rounded-xl",children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Total"}),l.jsx("span",{className:"text-xl font-bold text-sage-600 dark:text-sage-400",children:D(j())})]})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Notes (optionnel)"}),l.jsx("textarea",{value:p,onChange:v=>g(v.target.value),placeholder:"Instructions spéciales, remarques...",rows:3,className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent resize-none"})]})]}),l.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-800",children:[l.jsx("button",{onClick:e,className:"px-6 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-300 transition-colors",children:"Annuler"}),l.jsxs("button",{onClick:F,disabled:!i||w.length===0||!c||S,className:`flex items-center space-x-2 px-6 py-2 rounded-lg font-medium transition-all ${!i||w.length===0||!c||S?"bg-gray-300 text-gray-500 cursor-not-allowed dark:bg-gray-700 dark:text-gray-500":"bg-sage-600 hover:bg-sage-700 text-white hover:scale-105 hover:shadow-lg hover:shadow-sage-600/25"}`,children:[l.jsx(Qi,{className:`w-4 h-4 ${S?"animate-pulse":""}`}),l.jsx("span",{children:S?"Création...":"Créer la commande"})]})]})]})}):null},EP=({isOpen:t,onClose:e,onSave:r})=>{const[n,s]=L.useState({name:"",type:"milk-kefir",customType:"",description:"",price:"",unit:"liter",customUnit:"",inStock:"",minStock:""}),[i,a]=L.useState(!1),[c,u]=L.useState(!1),[d,f]=L.useState(!1),p=(S,C)=>{s(T=>({...T,[S]:C}))},g=async()=>{if(!n.name.trim()||!n.price||!n.inStock||!n.minStock)return;f(!0);const S=i&&n.customType.trim()?n.customType.trim():n.type,C=c&&n.customUnit.trim()?n.customUnit.trim():n.unit,T={name:n.name.trim(),type:S,description:n.description.trim(),price:parseInt(n.price),unit:C,inStock:parseInt(n.inStock),minStock:parseInt(n.minStock)};await new Promise(_=>setTimeout(_,1e3)),r(T),s({name:"",type:"milk-kefir",customType:"",description:"",price:"",unit:"liter",customUnit:"",inStock:"",minStock:""}),a(!1),u(!1),f(!1),e()},w=[{value:"milk-kefir",label:"Kéfir de lait"},{value:"water-kefir",label:"Kéfir d'eau"},{value:"kombucha",label:"Kombucha"},{value:"cheese",label:"Fromages"},{value:"fermented-vegetables",label:"Légumes fermentés"},{value:"accessories",label:"Accessoires"}],N=[{value:"liter",label:"Litre"},{value:"piece",label:"Pièce"}];return t?l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 dark:bg-black/80 backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-2xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-800",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Nouveau produit"}),l.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors",children:l.jsx(Ct,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),l.jsxs("div",{className:"p-6 space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"md:col-span-2",children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(At,{className:"w-4 h-4 inline mr-1"}),"Nom du produit *"]}),l.jsx("input",{type:"text",value:n.name,onChange:S=>p("name",S.target.value),placeholder:"Ex: Kéfir de lait traditionnel",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Type de produit *"}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("button",{type:"button",onClick:()=>a(!1),className:`px-3 py-1 text-sm rounded-lg transition-colors ${i?"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600":"bg-sage-600 text-white"}`,children:"Prédéfini"}),l.jsx("button",{type:"button",onClick:()=>a(!0),className:`px-3 py-1 text-sm rounded-lg transition-colors ${i?"bg-sage-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"}`,children:"Personnalisé"})]}),i?l.jsx("input",{type:"text",value:n.customType,onChange:S=>p("customType",S.target.value),placeholder:"Ex: Yaourt fermenté, Boisson probiotique...",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"}):l.jsx("select",{value:n.type,onChange:S=>p("type",S.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent",children:w.map(S=>l.jsx("option",{value:S.value,children:S.label},S.value))})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Unité de vente *"}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("button",{type:"button",onClick:()=>u(!1),className:`px-3 py-1 text-sm rounded-lg transition-colors ${c?"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600":"bg-sage-600 text-white"}`,children:"Prédéfini"}),l.jsx("button",{type:"button",onClick:()=>u(!0),className:`px-3 py-1 text-sm rounded-lg transition-colors ${c?"bg-sage-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"}`,children:"Personnalisé"})]}),c?l.jsx("input",{type:"text",value:n.customUnit,onChange:S=>p("customUnit",S.target.value),placeholder:"Ex: bouteille, pot, sachet, kg...",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"}):l.jsx("select",{value:n.unit,onChange:S=>p("unit",S.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent",children:N.map(S=>l.jsx("option",{value:S.value,children:S.label},S.value))})]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Description"}),l.jsx("textarea",{value:n.description,onChange:S=>p("description",S.target.value),placeholder:"Description du produit, ingrédients, bienfaits...",rows:3,className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent resize-none"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(B1,{className:"w-4 h-4 inline mr-1"}),"Prix (Ariary) *"]}),l.jsx("input",{type:"number",min:"0",step:"1000",value:n.price,onChange:S=>p("price",S.target.value),placeholder:"9000",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(pp,{className:"w-4 h-4 inline mr-1"}),"Stock actuel *"]}),l.jsx("input",{type:"number",min:"0",value:n.inStock,onChange:S=>p("inStock",S.target.value),placeholder:"50",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(bo,{className:"w-4 h-4 inline mr-1"}),"Stock minimum *"]}),l.jsx("input",{type:"number",min:"0",value:n.minStock,onChange:S=>p("minStock",S.target.value),placeholder:"10",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]})]}),n.price&&l.jsx("div",{className:"p-4 bg-sage-50 dark:bg-sage-900/20 rounded-xl",children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Prix de vente"}),l.jsxs("span",{className:"text-lg font-bold text-sage-600 dark:text-sage-400",children:[new Intl.NumberFormat("fr-FR",{style:"currency",currency:"MGA",minimumFractionDigits:0,maximumFractionDigits:0}).format(parseInt(n.price)||0)," / ",c&&n.customUnit.trim()?n.customUnit.trim():n.unit==="liter"?"litre":"pièce"]})]})})]}),l.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-800",children:[l.jsx("button",{onClick:e,className:"px-6 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-300 transition-colors",children:"Annuler"}),l.jsxs("button",{onClick:g,disabled:!n.name.trim()||!n.price||!n.inStock||!n.minStock||i&&!n.customType.trim()||c&&!n.customUnit.trim()||d,className:`flex items-center space-x-2 px-6 py-2 rounded-lg font-medium transition-all ${!n.name.trim()||!n.price||!n.inStock||!n.minStock||i&&!n.customType.trim()||c&&!n.customUnit.trim()||d?"bg-gray-300 text-gray-500 cursor-not-allowed dark:bg-gray-700 dark:text-gray-500":"bg-sage-600 hover:bg-sage-700 text-white hover:scale-105 hover:shadow-lg hover:shadow-sage-600/25"}`,children:[l.jsx(Qi,{className:`w-4 h-4 ${d?"animate-pulse":""}`}),l.jsx("span",{children:d?"Création...":"Créer le produit"})]})]})]})}):null},bP=({isOpen:t,onClose:e,product:r,onSave:n})=>{const[s,i]=L.useState({name:"",type:"milk-kefir",customType:"",description:"",price:"",unit:"liter",customUnit:"",inStock:"",minStock:""}),[a,c]=L.useState(!1),[u,d]=L.useState(!1),[f,p]=L.useState(!1);L.useEffect(()=>{if(r){const C=!N.some(_=>_.value===r.type),T=!S.some(_=>_.value===r.unit);i({name:r.name,type:C?"milk-kefir":r.type,customType:C?r.type:"",description:r.description,price:r.price.toString(),unit:T?"liter":r.unit,customUnit:T?r.unit:"",inStock:r.inStock.toString(),minStock:r.minStock.toString()}),c(C),d(T)}},[r]);const g=(C,T)=>{i(_=>({..._,[C]:T}))},w=async()=>{if(!r||!s.name.trim()||!s.price||!s.inStock||!s.minStock)return;p(!0);const C=a&&s.customType.trim()?s.customType.trim():s.type,T=u&&s.customUnit.trim()?s.customUnit.trim():s.unit,_={...r,name:s.name.trim(),type:C,description:s.description.trim(),price:parseInt(s.price),unit:T,inStock:parseInt(s.inStock),minStock:parseInt(s.minStock)};await new Promise(k=>setTimeout(k,1e3)),n(_),p(!1),e()},N=[{value:"milk-kefir",label:"Kéfir de lait"},{value:"water-kefir",label:"Kéfir d'eau"},{value:"kombucha",label:"Kombucha"},{value:"cheese",label:"Fromages"},{value:"fermented-vegetables",label:"Légumes fermentés"},{value:"accessories",label:"Accessoires"}],S=[{value:"liter",label:"Litre"},{value:"piece",label:"Pièce"}];return!t||!r?null:l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 dark:bg-black/80 backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-2xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-800",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Modifier le produit"}),l.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors",children:l.jsx(Ct,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),l.jsxs("div",{className:"p-6 space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"md:col-span-2",children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(At,{className:"w-4 h-4 inline mr-1"}),"Nom du produit *"]}),l.jsx("input",{type:"text",value:s.name,onChange:C=>g("name",C.target.value),placeholder:"Ex: Kéfir de lait traditionnel",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Type de produit *"}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("button",{type:"button",onClick:()=>c(!1),className:`px-3 py-1 text-sm rounded-lg transition-colors ${a?"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600":"bg-sage-600 text-white"}`,children:"Prédéfini"}),l.jsx("button",{type:"button",onClick:()=>c(!0),className:`px-3 py-1 text-sm rounded-lg transition-colors ${a?"bg-sage-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"}`,children:"Personnalisé"})]}),a?l.jsx("input",{type:"text",value:s.customType,onChange:C=>g("customType",C.target.value),placeholder:"Ex: Yaourt fermenté, Boisson probiotique...",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"}):l.jsx("select",{value:s.type,onChange:C=>g("type",C.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent",children:N.map(C=>l.jsx("option",{value:C.value,children:C.label},C.value))})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Unité de vente *"}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("button",{type:"button",onClick:()=>d(!1),className:`px-3 py-1 text-sm rounded-lg transition-colors ${u?"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600":"bg-sage-600 text-white"}`,children:"Prédéfini"}),l.jsx("button",{type:"button",onClick:()=>d(!0),className:`px-3 py-1 text-sm rounded-lg transition-colors ${u?"bg-sage-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"}`,children:"Personnalisé"})]}),u?l.jsx("input",{type:"text",value:s.customUnit,onChange:C=>g("customUnit",C.target.value),placeholder:"Ex: bouteille, pot, sachet, kg...",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"}):l.jsx("select",{value:s.unit,onChange:C=>g("unit",C.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent",children:S.map(C=>l.jsx("option",{value:C.value,children:C.label},C.value))})]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Description"}),l.jsx("textarea",{value:s.description,onChange:C=>g("description",C.target.value),placeholder:"Description du produit, ingrédients, bienfaits...",rows:3,className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent resize-none"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(B1,{className:"w-4 h-4 inline mr-1"}),"Prix (Ariary) *"]}),l.jsx("input",{type:"number",min:"0",step:"1000",value:s.price,onChange:C=>g("price",C.target.value),placeholder:"9000",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(pp,{className:"w-4 h-4 inline mr-1"}),"Stock actuel *"]}),l.jsx("input",{type:"number",min:"0",value:s.inStock,onChange:C=>g("inStock",C.target.value),placeholder:"50",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(bo,{className:"w-4 h-4 inline mr-1"}),"Stock minimum *"]}),l.jsx("input",{type:"number",min:"0",value:s.minStock,onChange:C=>g("minStock",C.target.value),placeholder:"10",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]})]}),s.price&&l.jsx("div",{className:"p-4 bg-sage-50 dark:bg-sage-900/20 rounded-xl",children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Prix de vente"}),l.jsxs("span",{className:"text-lg font-bold text-sage-600 dark:text-sage-400",children:[new Intl.NumberFormat("fr-FR",{style:"currency",currency:"MGA",minimumFractionDigits:0,maximumFractionDigits:0}).format(parseInt(s.price)||0)," / ",u&&s.customUnit.trim()?s.customUnit.trim():s.unit==="liter"?"litre":"pièce"]})]})})]}),l.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-800",children:[l.jsx("button",{onClick:e,className:"px-6 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-300 transition-colors",children:"Annuler"}),l.jsxs("button",{onClick:w,disabled:!s.name.trim()||!s.price||!s.inStock||!s.minStock||a&&!s.customType.trim()||u&&!s.customUnit.trim()||f,className:`flex items-center space-x-2 px-6 py-2 rounded-lg font-medium transition-all ${!s.name.trim()||!s.price||!s.inStock||!s.minStock||a&&!s.customType.trim()||u&&!s.customUnit.trim()||f?"bg-gray-300 text-gray-500 cursor-not-allowed dark:bg-gray-700 dark:text-gray-500":"bg-sage-600 hover:bg-sage-700 text-white hover:scale-105 hover:shadow-lg hover:shadow-sage-600/25"}`,children:[l.jsx(Qi,{className:`w-4 h-4 ${f?"animate-pulse":""}`}),l.jsx("span",{children:f?"Enregistrement...":"Enregistrer les modifications"})]})]})]})})},TP=[{id:"1",name:"Kéfir de lait traditionnel",type:"milk-kefir",description:"Kéfir de lait traditionnel, riche en probiotiques naturels",price:9e3,unit:"liter",inStock:50,minStock:10},{id:"2",name:"Kéfir de lait au chia",type:"milk-kefir",description:"Kéfir de lait enrichi aux graines de chia",price:11e3,unit:"liter",inStock:30,minStock:10},{id:"3",name:"Kombucha nature",type:"kombucha",description:"Kombucha traditionnel non aromatisé",price:6e3,unit:"liter",inStock:40,minStock:15},{id:"4",name:"Kombucha aromatisé - Pomme",type:"kombucha",description:"Kombucha saveur pomme",price:9e3,unit:"liter",inStock:25,minStock:10},{id:"5",name:"Kombucha aromatisé - Prune",type:"kombucha",description:"Kombucha saveur prune",price:9e3,unit:"liter",inStock:20,minStock:8},{id:"6",name:"Kombucha aromatisé - Raketa",type:"kombucha",description:"Kombucha saveur raketa (fruit local)",price:9e3,unit:"liter",inStock:18,minStock:8},{id:"7",name:"Kombucha aromatisé - Pokpok",type:"kombucha",description:"Kombucha saveur pokpok (fruit local)",price:9e3,unit:"liter",inStock:22,minStock:8},{id:"8",name:"Kombucha aromatisé - Fraise",type:"kombucha",description:"Kombucha saveur fraise",price:9e3,unit:"liter",inStock:28,minStock:10},{id:"9",name:"Kombucha aromatisé - Letchis",type:"kombucha",description:"Kombucha saveur letchis",price:9e3,unit:"liter",inStock:15,minStock:8},{id:"10",name:"Kombucha aromatisé - Hibiscus",type:"kombucha",description:"Kombucha aux fleurs d'hibiscus",price:9e3,unit:"liter",inStock:20,minStock:8},{id:"11",name:"Kombucha aromatisé - Kaki",type:"kombucha",description:"Kombucha saveur kaki",price:9e3,unit:"liter",inStock:16,minStock:8},{id:"12",name:"Kéfir de fruits",type:"water-kefir",description:"Kéfir de fruits rafraîchissant",price:6e3,unit:"liter",inStock:35,minStock:12},{id:"13",name:"Fromage de kéfir 100g",type:"cheese",description:"Fromage frais à base de kéfir - format 100g",price:6e3,unit:"piece",inStock:40,minStock:15},{id:"14",name:"Fromage de kéfir 200g",type:"cheese",description:"Fromage frais à base de kéfir - format 200g",price:12e3,unit:"piece",inStock:25,minStock:10},{id:"15",name:"Graines de chia 250g",type:"accessories",description:"Graines de chia premium - sachet de 250g",price:2e4,unit:"piece",inStock:20,minStock:5},{id:"16",name:"Légumes lactofermentés",type:"fermented-vegetables",description:"Légumes fermentés traditionnels en pot",price:1e4,unit:"piece",inStock:30,minStock:8}],IP=[{id:"1",name:"Marie Dubois",email:"marie.dubois@email.com",phone:"+261 32 12 345 67",address:{street:"15 rue des Lilas",city:"Antananarivo",postalCode:"101",country:"Madagascar",deliveryInstructions:"Laisser devant la porte si absent"},tags:["client-fidèle","kéfir-lait","livraison-hebdomadaire"],notes:[],starred:!0,relationship:"Cliente fidèle",sentiment:"positive",customerSince:new Date("2023-03-15"),totalSpent:47e4,averageOrderValue:37e3,lastOrderDate:new Date("2024-01-08"),orderFrequency:"weekly",preferredProducts:["1","2"],deliveryPreferences:{preferredDay:"saturday",preferredTime:"morning",frequency:"weekly",nextDelivery:new Date("2024-01-13")},paymentMethod:"card",customerStatus:"active"},{id:"2",name:"Pierre Martin",email:"p.martin@gmail.com",phone:"+261 33 98 765 43",address:{street:"42 avenue de la République",city:"Fianarantsoa",postalCode:"301",country:"Madagascar"},tags:["nouveau-client","kéfir-eau","bio"],notes:[],starred:!1,relationship:"Nouveau client",sentiment:"positive",customerSince:new Date("2024-01-05"),totalSpent:64e3,averageOrderValue:32e3,lastOrderDate:new Date("2024-01-05"),orderFrequency:"bi-weekly",preferredProducts:["3","4"],deliveryPreferences:{preferredDay:"wednesday",preferredTime:"evening",frequency:"bi-weekly",nextDelivery:new Date("2024-01-17")},paymentMethod:"transfer",customerStatus:"active"},{id:"3",name:"Sophie Leroy",email:"sophie.leroy@outlook.fr",phone:"+261 34 11 223 34",address:{street:"8 place Bellecour",city:"Toamasina",postalCode:"501",country:"Madagascar",deliveryInstructions:"Sonner à l'interphone - Apt 3B"},tags:["client-premium","commandes-importantes","événements"],notes:[],starred:!0,relationship:"Cliente premium",sentiment:"positive",customerSince:new Date("2023-06-20"),totalSpent:913500,averageOrderValue:76125,lastOrderDate:new Date("2024-01-06"),orderFrequency:"weekly",preferredProducts:["1","2","3","5"],deliveryPreferences:{preferredDay:"friday",preferredTime:"afternoon",frequency:"weekly",nextDelivery:new Date("2024-01-12")},paymentMethod:"orange-money",customerStatus:"active"}],SP=[{id:"1",customerId:"1",customerName:"Marie Dubois",orderDate:new Date("2024-01-08"),deliveryDate:new Date("2024-01-13"),status:"confirmed",items:[{productId:"1",productName:"Kéfir de lait traditionnel",quantity:2,unitPrice:9e3,totalPrice:18e3},{productId:"3",productName:"Kombucha nature",quantity:2,unitPrice:6e3,totalPrice:12e3}],totalAmount:3e4,paymentStatus:"paid",paymentMethod:"card",deliveryAddress:{street:"15 rue des Lilas",city:"Antananarivo",postalCode:"101",country:"Madagascar"}},{id:"2",customerId:"3",customerName:"Sophie Leroy",orderDate:new Date("2024-01-06"),deliveryDate:new Date("2024-01-12"),status:"pending",items:[{productId:"1",productName:"Kéfir de lait traditionnel",quantity:4,unitPrice:9e3,totalPrice:36e3},{productId:"4",productName:"Kombucha aromatisé - Pomme",quantity:3,unitPrice:9e3,totalPrice:27e3},{productId:"15",productName:"Graines de chia 250g",quantity:1,unitPrice:2e4,totalPrice:2e4}],totalAmount:83e3,paymentStatus:"pending",paymentMethod:"card",deliveryAddress:{street:"8 place Bellecour",city:"Toamasina",postalCode:"501",country:"Madagascar"},notes:"Commande pour événement familial"}],th=[{id:"1",orderId:"2",customerId:"3",customerName:"Sophie Leroy",scheduledDate:new Date("2024-01-12"),status:"scheduled",address:{street:"8 place Bellecour",city:"Toamasina",postalCode:"501",country:"Madagascar",deliveryInstructions:"Sonner à l'interphone - Apt 3B"},items:[{productId:"1",productName:"Kéfir de lait traditionnel",quantity:4,unitPrice:9e3,totalPrice:36e3},{productId:"4",productName:"Kombucha aromatisé - Pomme",quantity:3,unitPrice:9e3,totalPrice:27e3}],route:"Centre Antananarivo"},{id:"2",orderId:"1",customerId:"1",customerName:"Marie Dubois",scheduledDate:new Date("2024-01-13"),status:"scheduled",address:{street:"15 rue des Lilas",city:"Antananarivo",postalCode:"101",country:"Madagascar",deliveryInstructions:"Laisser devant la porte si absent"},items:[{productId:"1",productName:"Kéfir de lait traditionnel",quantity:2,unitPrice:9e3,totalPrice:18e3}],route:"Nord Antananarivo"}],NP=[{id:"1",contactId:"2",contactName:"Pierre Martin",message:"Relancer pour nouvelle commande - client potentiel régulier",date:new Date("2024-01-15"),completed:!1,type:"reorder"},{id:"2",contactId:"1",contactName:"Marie Dubois",message:"Vérifier satisfaction après livraison",date:new Date("2024-01-14"),completed:!1,type:"follow-up"},{id:"3",contactId:"3",contactName:"Sophie Leroy",message:"Confirmer paiement commande #2",date:new Date("2024-01-11"),completed:!1,type:"payment"}],AP=()=>{const{contacts:t,products:e,orders:r,notes:n,reminders:s,vendorInfo:i,loading:a,error:c,permissionError:u,indexError:d,firebaseAvailable:f,addContact:p,updateContact:g,deleteContact:w,addProduct:N,updateProduct:S,deleteProduct:C,addOrder:T,updateOrder:_,addNote:k,updateReminder:j,saveVendorInfo:F}=iP(),[D,v]=L.useState(!1),[y,E]=L.useState(!1),[b,A]=L.useState(!1),[R,I]=L.useState("dashboard"),[mt,nr]=L.useState(!1),[sn,Rt]=L.useState(!1),[W,z]=L.useState(!1),[q,re]=L.useState(!1),[ue,pe]=L.useState(!1),[pt,Ge]=L.useState(!1),[sr,$t]=L.useState(!1),[Xu,Go]=L.useState(!1),[$s,es]=L.useState(!1),[yr,an]=L.useState(IP),[ts,Yi]=L.useState(SP),[on,Xi]=L.useState(TP),[Ji,Qo]=L.useState([]),[rs,Yo]=L.useState(NP),[Xo,Zi]=L.useState({name:"Kéfir Madagascar SARL",address:"Lot II M 15 Bis Antanimena, 101 Antananarivo, Madagascar",phone:"+261 32 12 345 67",email:"contact@kefir-madagascar.mg",nif:"1234567890123",stat:"12345 12 2023 0 12345"}),gt=y&&b?t:yr,qt=y&&b?r:ts,je=y&&b?e:on,Qe=y&&b?n:Ji,qs=y&&b?s:rs,ea=y&&b?i:Xo,[Jo,Zo]=L.useState(null),[ln,ns]=L.useState(null),[el,Hs]=L.useState(null);av.useEffect(()=>{!localStorage.getItem("firebase-migration-shown")&&!a&&f&&t.length===0?(v(!0),localStorage.setItem("firebase-migration-shown","true")):f&&t.length>0?(E(!0),A(!0)):f||(E(!1),A(!1))},[a,t.length,f]);const Ju={totalRevenue:gt.reduce(($,Y)=>$+Y.totalSpent,0),monthlyRevenue:qt.filter($=>$.orderDate.getMonth()===new Date().getMonth()).reduce(($,Y)=>$+Y.totalAmount,0),totalCustomers:gt.length,activeCustomers:gt.filter($=>$.customerStatus==="active").length,averageOrderValue:qt.length>0?qt.reduce(($,Y)=>$+Y.totalAmount,0)/qt.length:0,topProducts:je.map($=>({productId:$.id,productName:$.name,quantity:qt.reduce((Y,Ht)=>{var ls;return Y+(((ls=(Ht.items||[]).find(cn=>cn.productId===$.id))==null?void 0:ls.quantity)||0)},0),revenue:qt.reduce((Y,Ht)=>{var ls;return Y+(((ls=(Ht.items||[]).find(cn=>cn.productId===$.id))==null?void 0:ls.totalPrice)||0)},0)})).sort(($,Y)=>Y.revenue-$.revenue),topCustomers:gt.map($=>({customerId:$.id,customerName:$.name,totalSpent:$.totalSpent,orderCount:qt.filter(Y=>Y.customerId===$.id).length})).sort(($,Y)=>Y.totalSpent-$.totalSpent),deliveryStats:{onTime:th.filter($=>$.status==="delivered").length,delayed:0,failed:th.filter($=>$.status==="failed").length}},Zu=$=>{if(y&&b){const Y=gt.find(Ht=>Ht.id===$);Y&&g($,{starred:!Y.starred})}else an(yr.map(Y=>Y.id===$?{...Y,starred:!Y.starred}:Y))},ta=$=>{y&&b?j($,{completed:!0}):Yo(rs.map(Y=>Y.id===$?{...Y,completed:!0}:Y))},ra=$=>{Zo($),z(!0)},tl=$=>{if(y&&b)k($),g($.contactId,{lastContact:new Date});else{const Y={...$,id:Math.random().toString(36).substr(2,9)};Qo([...Ji,Y]),an(yr.map(Ht=>Ht.id===$.contactId?{...Ht,lastContact:new Date,notes:[...Ht.notes,Y]}:Ht))}},ss=$=>{if(y&&b){const Y={...$,notes:[],totalSpent:0,averageOrderValue:0,preferredProducts:[],deliveryPreferences:{preferredDay:"saturday",preferredTime:"morning",frequency:"weekly"}};p(Y)}else{const Y={...$,id:Math.random().toString(36).substr(2,9),notes:[],totalSpent:0,averageOrderValue:0,preferredProducts:[],deliveryPreferences:{preferredDay:"saturday",preferredTime:"morning",frequency:"weekly"}};an([...yr,Y])}},na=$=>{y&&b?g($.id,$):an(yr.map(Y=>Y.id===$.id?$:Y))},sa=$=>{if(y&&b)T($);else{const Y={...$,id:Math.random().toString(36).substr(2,9)};Yi([...ts,Y])}},Or=$=>{if(y&&b)N($);else{const Y={...$,id:Math.random().toString(36).substr(2,9)};Xi([...on,Y])}},rl=$=>{ns($),re(!0)},Ws=$=>{console.log("Modifier commande",$)},nl=$=>{confirm("Êtes-vous sûr de vouloir supprimer ce produit ?")&&(y&&b?C($):Xi(on.filter(Y=>Y.id!==$)))},is=$=>{Hs($),es(!0)},sl=$=>{y&&b?S($.id,$):Xi(on.map(Y=>Y.id===$.id?$:Y))},Ye=$=>{ns($),Ge(!0)},il=()=>{E(!0),A(!0)},as=$=>{y&&b?F($):Zi($)},os=()=>{confirm("Voulez-vous migrer vos données vers Firebase ? Cette opération est irréversible.")&&(localStorage.removeItem("firebase-migration-shown"),window.location.reload())};if(a&&f)return l.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sage-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Chargement de l'application..."})]})});if(c&&f)return l.jsx("div",{className:"min-h-screen flex items-center justify-center",children:l.jsxs("div",{className:"text-center max-w-md mx-auto p-6",children:[l.jsx("div",{className:"text-red-500 text-6xl mb-4",children:u?"🔒":d?"📊":"⚠️"}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:u?"Permission Denied":d?"Database Setup Required":"Error Loading Data"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:c}),u&&l.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4 mb-4",children:l.jsxs("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:[l.jsx("strong",{children:"To fix this:"})," Go to your Firebase Console → Firestore Database → Rules and update the security rules to allow authenticated users access to their data."]})}),d&&l.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4 mb-4",children:l.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:[l.jsx("strong",{children:"To fix this:"})," Check the browser console for specific index creation URLs and click them to create the required composite indexes in Firebase Console."]})}),l.jsxs("div",{className:"flex space-x-3 justify-center",children:[l.jsx("button",{onClick:()=>{E(!1),A(!1)},className:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition-colors",children:"Utiliser en mode local"}),l.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",children:"Réessayer"})]})]})});const ed=()=>{switch(R){case"dashboard":return l.jsx(uP,{customers:gt,orders:qt,deliveries:th,analytics:Ju,reminders:qs,onContactClick:ra,onReminderComplete:ta});case"contacts":return l.jsx(hP,{contacts:gt,onContactClick:ra,onToggleStar:Zu,onAddContact:()=>Rt(!0)});case"orders":return l.jsx(fP,{orders:qt,customers:gt,products:je,onCreateOrder:()=>$t(!0),onViewOrder:rl,onEditOrder:Ws,onShowReceipt:Ye});case"products":return l.jsx(mP,{products:je,onAddProduct:()=>Go(!0),onEditProduct:is,onDeleteProduct:nl});case"timeline":return l.jsx(pP,{notes:Qe,contacts:gt});default:return null}};return l.jsxs(l.Fragment,{children:[l.jsx(cP,{activeTab:R,onTabChange:I,onNewNote:()=>nr(!0),onVendorSettings:()=>pe(!0),onMigrateToFirebase:os,children:ed()}),l.jsx(gP,{isOpen:mt,onClose:()=>nr(!1),contacts:gt,onSave:tl}),l.jsx(yP,{isOpen:sn,onClose:()=>Rt(!1),onSave:ss}),l.jsx(vP,{isOpen:W,onClose:()=>{z(!1),Zo(null)},contact:Jo,onSave:na}),l.jsx(xP,{isOpen:q,onClose:()=>{re(!1),ns(null)},order:ln}),l.jsx(_P,{isOpen:ue,onClose:()=>pe(!1),vendorInfo:ea,onSave:as}),l.jsx(wP,{isOpen:pt,onClose:()=>{Ge(!1),ns(null)},order:ln,vendorInfo:ea}),l.jsx(kP,{isOpen:sr,onClose:()=>$t(!1),customers:gt,products:je,onSave:sa}),l.jsx(EP,{isOpen:Xu,onClose:()=>Go(!1),onSave:Or}),l.jsx(bP,{isOpen:$s,onClose:()=>{es(!1),Hs(null)},product:el,onSave:sl}),l.jsx(aP,{isOpen:D,onClose:()=>v(!1),localData:{contacts:yr,products:on,orders:ts,notes:Ji,reminders:rs,vendorInfo:Xo},onMigrationComplete:il})]})};function CP(){return l.jsx(zb,{children:l.jsx(CR,{children:l.jsx(nP,{children:l.jsx(AP,{})})})})}c_(document.getElementById("root")).render(l.jsx(L.StrictMode,{children:l.jsx(CP,{})}));
